/*! For license information please see main.7c31990c.js.LICENSE.txt */
(()=>{"use strict";var e={43(e,t,n){e.exports=n(202)},153(e,t,n){var a=n(43),r=Symbol.for("react.element"),o=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var a,o={},c=null,d=null;for(a in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,a)&&!s.hasOwnProperty(a)&&(o[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===o[a]&&(o[a]=t[a]);return{$$typeof:r,type:e,key:c,ref:d,props:o,_owner:l.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},202(e,t){var n=Symbol.for("react.element"),a=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,f={};function v(e,t,n){this.props=e,this.context=t,this.refs=f,this.updater=n||h}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=f,this.updater=n||h}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,g(x,v.prototype),x.isPureReactComponent=!0;var k=Array.isArray,j=Object.prototype.hasOwnProperty,w={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function N(e,t,a){var r,o={},i=null,l=null;if(null!=t)for(r in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(i=""+t.key),t)j.call(t,r)&&!S.hasOwnProperty(r)&&(o[r]=t[r]);var s=arguments.length-2;if(1===s)o.children=a;else if(1<s){for(var c=Array(s),d=0;d<s;d++)c[d]=arguments[d+2];o.children=c}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===o[r]&&(o[r]=s[r]);return{$$typeof:n,type:e,key:i,ref:l,props:o,_owner:w.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function D(e,t,r,o,i){var l=typeof e;"undefined"!==l&&"boolean"!==l||(e=null);var s=!1;if(null===e)s=!0;else switch(l){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case n:case a:s=!0}}if(s)return i=i(s=e),e=""===o?"."+I(s,0):o,k(i)?(r="",null!=e&&(r=e.replace(E,"$&/")+"/"),D(i,t,r,"",function(e){return e})):null!=i&&(C(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(E,"$&/")+"/")+e)),t.push(i)),1;if(s=0,o=""===o?".":o+":",k(e))for(var c=0;c<e.length;c++){var d=o+I(l=e[c],c);s+=D(l,t,r,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(l=e.next()).done;)s+=D(l=l.value,t,r,d=o+I(l,c++),i);else if("object"===l)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function T(e,t,n){if(null==e)return e;var a=[],r=0;return D(e,a,"","",function(e){return t.call(n,e,r++)}),a}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},O={transition:null},L={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:O,ReactCurrentOwner:w};function R(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,n){T(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return T(e,function(){t++}),t},toArray:function(e){return T(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=i,t.PureComponent=b,t.StrictMode=o,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.act=R,t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=g({},e.props),o=e.key,i=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,l=w.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(c in t)j.call(t,c)&&!S.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==s?s[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=a;else if(1<c){s=Array(c);for(var d=0;d<c;d++)s[d]=arguments[d+2];r.children=s}return{$$typeof:n,type:e.type,key:o,ref:i,props:r,_owner:l}},t.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},t.createElement=N,t.createFactory=function(e){var t=N.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=R,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},234(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,r=e[a];if(!(0<o(r,t)))break e;e[a]=t,e[n]=r,n=a}}function a(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,r=e.length,i=r>>>1;a<i;){var l=2*(a+1)-1,s=e[l],c=l+1,d=e[c];if(0>o(s,n))c<r&&0>o(d,s)?(e[a]=d,e[c]=n,a=c):(e[a]=s,e[l]=n,a=l);else{if(!(c<r&&0>o(d,n)))break e;e[a]=d,e[c]=n,a=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,s=l.now();t.unstable_now=function(){return l.now()-s}}var c=[],d=[],u=1,p=null,m=3,h=!1,g=!1,f=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=a(d);null!==t;){if(null===t.callback)r(d);else{if(!(t.startTime<=e))break;r(d),t.sortIndex=t.expirationTime,n(c,t)}t=a(d)}}function k(e){if(f=!1,x(e),!g)if(null!==a(c))g=!0,O(j);else{var t=a(d);null!==t&&L(k,t.startTime-e)}}function j(e,n){g=!1,f&&(f=!1,y(C),C=-1),h=!0;var o=m;try{for(x(n),p=a(c);null!==p&&(!(p.expirationTime>n)||e&&!D());){var i=p.callback;if("function"===typeof i){p.callback=null,m=p.priorityLevel;var l=i(p.expirationTime<=n);n=t.unstable_now(),"function"===typeof l?p.callback=l:p===a(c)&&r(c),x(n)}else r(c);p=a(c)}if(null!==p)var s=!0;else{var u=a(d);null!==u&&L(k,u.startTime-n),s=!1}return s}finally{p=null,m=o,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,S=!1,N=null,C=-1,E=5,I=-1;function D(){return!(t.unstable_now()-I<E)}function T(){if(null!==N){var e=t.unstable_now();I=e;var n=!0;try{n=N(!0,e)}finally{n?w():(S=!1,N=null)}}else S=!1}if("function"===typeof b)w=function(){b(T)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,P=A.port2;A.port1.onmessage=T,w=function(){P.postMessage(null)}}else w=function(){v(T,0)};function O(e){N=e,S||(S=!0,w())}function L(e,n){C=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||h||(g=!0,O(j))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var n=m;m=t;try{return e()}finally{m=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=m;m=e;try{return t()}finally{m=n}},t.unstable_scheduleCallback=function(e,r,o){var i=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?i+o:i:o=i,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:o,expirationTime:l=o+l,sortIndex:-1},o>i?(e.sortIndex=o,n(d,e),null===a(c)&&e===a(d)&&(f?(y(C),C=-1):f=!0,L(k,o-i))):(e.sortIndex=l,n(c,e),g||h||(g=!0,O(j))),e},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(e){var t=m;return function(){var n=m;m=t;try{return e.apply(this,arguments)}finally{m=n}}}},391(e,t,n){var a=n(950);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},579(e,t,n){e.exports=n(153)},730(e,t,n){var a=n(43),r=n(853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,l={};function s(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(l[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},h={};function g(e,t,n,a,r,o,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var f={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){f[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];f[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){f[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){f[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){f[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){f[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){f[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){f[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){f[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,a){var r=f.hasOwnProperty(t)?f[t]:null;(null!==r?0!==r.type:a||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,a){if(null===t||"undefined"===typeof t||function(e,t,n,a){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,a))return!0;if(a)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,a)&&(n=null),a||null===r?function(e){return!!u.call(h,e)||!u.call(m,e)&&(p.test(e)?h[e]=!0:(m[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,a=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,a?e.setAttributeNS(a,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);f[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);f[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);f[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){f[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),f.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){f[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),j=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),E=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var M,F=Object.assign;function U(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var _=!1;function z(e,t){if(!e||_)return"";_=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var a=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){a=c}e.call(t.prototype)}else{try{throw Error()}catch(c){a=c}e()}}catch(c){if(c&&a&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),o=a.stack.split("\n"),i=r.length-1,l=o.length-1;1<=i&&0<=l&&r[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(r[i]!==o[l]){if(1!==i||1!==l)do{if(i--,0>--l||r[i]!==o[l]){var s="\n"+r[i].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}}while(1<=i&&0<=l);break}}}finally{_=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function B(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function G(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case w:return"Fragment";case j:return"Portal";case N:return"Profiler";case S:return"StrictMode";case D:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:G(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return G(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return G(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){a=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=q(e)?e.checked?"true":"false":e.value),(e=a)!==n&&(t.setValue(e),!0)}function H(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:a,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=V(t.value),a=t.type;if(null!=n)"number"===a?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&H(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,a){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&a&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(a&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function oe(e,t){var n=V(t.value),a=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=a&&(e.defaultValue=""+a)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function le(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function se(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?le(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,a){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function pe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function fe(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var a=0===n.indexOf("--"),r=ge(n,t[n],a);"float"===n&&(n="cssFloat"),a?e.setProperty(n,r):e[n]=r}}Object.keys(me).forEach(function(e){he.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]})});var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function ke(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var je=null,we=null,Se=null;function Ne(e){if(e=br(e)){if("function"!==typeof je)throw Error(o(280));var t=e.stateNode;t&&(t=kr(t),je(e.stateNode,e.type,t))}}function Ce(e){we?Se?Se.push(e):Se=[e]:we=e}function Ee(){if(we){var e=we,t=Se;if(Se=we=null,Ne(e),t)for(e=0;e<t.length;e++)Ne(t[e])}}function Ie(e,t){return e(t)}function De(){}var Te=!1;function Ae(e,t,n){if(Te)return e(t,n);Te=!0;try{return Ie(e,t,n)}finally{Te=!1,(null!==we||null!==Se)&&(De(),Ee())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var a=kr(n);if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Oe=!1;if(d)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(de){Oe=!1}function Re(e,t,n,a,r,o,i,l,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Me=!1,Fe=null,Ue=!1,_e=null,ze={onError:function(e){Me=!0,Fe=e}};function Be(e,t,n,a,r,o,i,l,s){Me=!1,Fe=null,Re.apply(ze,arguments)}function Ge(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(Ge(e)!==e)throw Error(o(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ge(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,a=t;;){var r=n.return;if(null===r)break;var i=r.alternate;if(null===i){if(null!==(a=r.return)){n=a;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return Ve(r),e;if(i===a)return Ve(r),t;i=i.sibling}throw Error(o(188))}if(n.return!==a.return)n=r,a=i;else{for(var l=!1,s=r.child;s;){if(s===n){l=!0,n=r,a=i;break}if(s===a){l=!0,a=r,n=i;break}s=s.sibling}if(!l){for(s=i.child;s;){if(s===n){l=!0,n=i,a=r;break}if(s===a){l=!0,a=i,n=r;break}s=s.sibling}if(!l)throw Error(o(189))}}if(n.alternate!==a)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var Je=r.unstable_scheduleCallback,He=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,$e=r.unstable_requestPaint,Ye=r.unstable_now,Xe=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,at=r.unstable_IdlePriority,rt=null,ot=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(lt(e)/st|0)|0},lt=Math.log,st=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var a=0,r=e.suspendedLanes,o=e.pingedLanes,i=268435455&n;if(0!==i){var l=i&~r;0!==l?a=ut(l):0!==(o&=i)&&(a=ut(o))}else 0!==(i=n&~r)?a=ut(i):0!==o&&(a=ut(o));if(0===a)return 0;if(0!==t&&t!==a&&0===(t&r)&&((r=a&-a)>=(o=t&-t)||16===r&&0!==(4194240&o)))return t;if(0!==(4&a)&&(a|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=a;0<t;)r=1<<(n=31-it(t)),a|=e[n],t&=~r;return a}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function ft(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-it(n),r=1<<a;r&t|e[a]&t&&(e[a]|=t),n&=~r}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var kt,jt,wt,St,Nt,Ct=!1,Et=[],It=null,Dt=null,Tt=null,At=new Map,Pt=new Map,Ot=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Dt=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Mt(e,t,n,a,r,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:o,targetContainers:[r]},null!==t&&(null!==(t=br(t))&&jt(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ft(e){var t=yr(e.target);if(null!==t){var n=Ge(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void Nt(e.priority,function(){wt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=br(n))&&jt(t),e.blockedOn=n,!1;var a=new(n=e.nativeEvent).constructor(n.type,n);xe=a,n.target.dispatchEvent(a),xe=null,t.shift()}return!0}function _t(e,t,n){Ut(e)&&n.delete(t)}function zt(){Ct=!1,null!==It&&Ut(It)&&(It=null),null!==Dt&&Ut(Dt)&&(Dt=null),null!==Tt&&Ut(Tt)&&(Tt=null),At.forEach(_t),Pt.forEach(_t)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,zt)))}function Gt(e){function t(t){return Bt(t,e)}if(0<Et.length){Bt(Et[0],e);for(var n=1;n<Et.length;n++){var a=Et[n];a.blockedOn===e&&(a.blockedOn=null)}}for(null!==It&&Bt(It,e),null!==Dt&&Bt(Dt,e),null!==Tt&&Bt(Tt,e),At.forEach(t),Pt.forEach(t),n=0;n<Ot.length;n++)(a=Ot[n]).blockedOn===e&&(a.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Ft(n),null===n.blockedOn&&Ot.shift()}var Wt=x.ReactCurrentBatchConfig,Vt=!0;function qt(e,t,n,a){var r=bt,o=Wt.transition;Wt.transition=null;try{bt=1,Jt(e,t,n,a)}finally{bt=r,Wt.transition=o}}function Kt(e,t,n,a){var r=bt,o=Wt.transition;Wt.transition=null;try{bt=4,Jt(e,t,n,a)}finally{bt=r,Wt.transition=o}}function Jt(e,t,n,a){if(Vt){var r=Qt(e,t,n,a);if(null===r)Va(e,t,a,Ht,n),Rt(e,a);else if(function(e,t,n,a,r){switch(t){case"focusin":return It=Mt(It,e,t,n,a,r),!0;case"dragenter":return Dt=Mt(Dt,e,t,n,a,r),!0;case"mouseover":return Tt=Mt(Tt,e,t,n,a,r),!0;case"pointerover":var o=r.pointerId;return At.set(o,Mt(At.get(o)||null,e,t,n,a,r)),!0;case"gotpointercapture":return o=r.pointerId,Pt.set(o,Mt(Pt.get(o)||null,e,t,n,a,r)),!0}return!1}(r,e,t,n,a))a.stopPropagation();else if(Rt(e,a),4&t&&-1<Lt.indexOf(e)){for(;null!==r;){var o=br(r);if(null!==o&&kt(o),null===(o=Qt(e,t,n,a))&&Va(e,t,a,Ht,n),o===r)break;r=o}null!==r&&a.stopPropagation()}else Va(e,t,a,null,n)}}var Ht=null;function Qt(e,t,n,a){if(Ht=null,null!==(e=yr(e=ke(a))))if(null===(t=Ge(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ht=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case at:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,a=n.length,r="value"in Yt?Yt.value:Yt.textContent,o=r.length;for(e=0;e<a&&n[e]===r[e];e++);var i=a-e;for(t=1;t<=i&&n[a-t]===r[o-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function an(){return!1}function rn(e){function t(t,n,a,r,o){for(var i in this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(r):r[i]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:an,this.isPropagationStopped=an,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,ln,sn,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=rn(cn),un=F({},cn,{view:0,detail:0}),pn=rn(un),mn=F({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(on=e.screenX-sn.screenX,ln=e.screenY-sn.screenY):ln=on=0,sn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),hn=rn(mn),gn=rn(F({},mn,{dataTransfer:0})),fn=rn(F({},un,{relatedTarget:0})),vn=rn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=rn(yn),xn=rn(F({},cn,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wn[e])&&!!t[e]}function Nn(){return Sn}var Cn=F({},un,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?jn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=rn(Cn),In=rn(F({},mn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Dn=rn(F({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nn})),Tn=rn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=F({},mn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=rn(An),On=[9,13,27,32],Ln=d&&"CompositionEvent"in window,Rn=null;d&&"documentMode"in document&&(Rn=document.documentMode);var Mn=d&&"TextEvent"in window&&!Rn,Fn=d&&(!Ln||Rn&&8<Rn&&11>=Rn),Un=String.fromCharCode(32),_n=!1;function zn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Gn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function qn(e,t,n,a){Ce(a),0<(t=Ka(t,"onChange")).length&&(n=new dn("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var Kn=null,Jn=null;function Hn(e){Ua(e,0)}function Qn(e){if(J(xr(e)))return e}function $n(e,t){if("change"===e)return t}var Yn=!1;if(d){var Xn;if(d){var Zn="oninput"in document;if(!Zn){var ea=document.createElement("div");ea.setAttribute("oninput","return;"),Zn="function"===typeof ea.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function ta(){Kn&&(Kn.detachEvent("onpropertychange",na),Jn=Kn=null)}function na(e){if("value"===e.propertyName&&Qn(Jn)){var t=[];qn(t,Jn,e,ke(e)),Ae(Hn,t)}}function aa(e,t,n){"focusin"===e?(ta(),Jn=n,(Kn=t).attachEvent("onpropertychange",na)):"focusout"===e&&ta()}function ra(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Jn)}function oa(e,t){if("click"===e)return Qn(t)}function ia(e,t){if("input"===e||"change"===e)return Qn(t)}var la="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function sa(e,t){if(la(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var r=n[a];if(!u.call(t,r)||!la(e[r],t[r]))return!1}return!0}function ca(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function da(e,t){var n,a=ca(e);for(e=0;a;){if(3===a.nodeType){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=ca(a)}}function ua(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ua(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pa(){for(var e=window,t=H();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(a){n=!1}if(!n)break;t=H((e=t.contentWindow).document)}return t}function ma(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ha(e){var t=pa(),n=e.focusedElem,a=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ua(n.ownerDocument.documentElement,n)){if(null!==a&&ma(n))if(t=a.start,void 0===(e=a.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,o=Math.min(a.start,r);a=void 0===a.end?o:Math.min(a.end,r),!e.extend&&o>a&&(r=a,a=o,o=r),r=da(n,o);var i=da(n,a);r&&i&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),o>a?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ga=d&&"documentMode"in document&&11>=document.documentMode,fa=null,va=null,ya=null,ba=!1;function xa(e,t,n){var a=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ba||null==fa||fa!==H(a)||("selectionStart"in(a=fa)&&ma(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},ya&&sa(ya,a)||(ya=a,0<(a=Ka(va,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=fa)))}function ka(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ja={animationend:ka("Animation","AnimationEnd"),animationiteration:ka("Animation","AnimationIteration"),animationstart:ka("Animation","AnimationStart"),transitionend:ka("Transition","TransitionEnd")},wa={},Sa={};function Na(e){if(wa[e])return wa[e];if(!ja[e])return e;var t,n=ja[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sa)return wa[e]=n[t];return e}d&&(Sa=document.createElement("div").style,"AnimationEvent"in window||(delete ja.animationend.animation,delete ja.animationiteration.animation,delete ja.animationstart.animation),"TransitionEvent"in window||delete ja.transitionend.transition);var Ca=Na("animationend"),Ea=Na("animationiteration"),Ia=Na("animationstart"),Da=Na("transitionend"),Ta=new Map,Aa="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pa(e,t){Ta.set(e,t),s(t,[e])}for(var Oa=0;Oa<Aa.length;Oa++){var La=Aa[Oa];Pa(La.toLowerCase(),"on"+(La[0].toUpperCase()+La.slice(1)))}Pa(Ca,"onAnimationEnd"),Pa(Ea,"onAnimationIteration"),Pa(Ia,"onAnimationStart"),Pa("dblclick","onDoubleClick"),Pa("focusin","onFocus"),Pa("focusout","onBlur"),Pa(Da,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ra="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ma=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ra));function Fa(e,t,n){var a=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,a,r,i,l,s,c){if(Be.apply(this,arguments),Me){if(!Me)throw Error(o(198));var d=Fe;Me=!1,Fe=null,Ue||(Ue=!0,_e=d)}}(a,t,void 0,e),e.currentTarget=null}function Ua(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var a=e[n],r=a.event;a=a.listeners;e:{var o=void 0;if(t)for(var i=a.length-1;0<=i;i--){var l=a[i],s=l.instance,c=l.currentTarget;if(l=l.listener,s!==o&&r.isPropagationStopped())break e;Fa(r,l,c),o=s}else for(i=0;i<a.length;i++){if(s=(l=a[i]).instance,c=l.currentTarget,l=l.listener,s!==o&&r.isPropagationStopped())break e;Fa(r,l,c),o=s}}}if(Ue)throw e=_e,Ue=!1,_e=null,e}function _a(e,t){var n=t[gr];void 0===n&&(n=t[gr]=new Set);var a=e+"__bubble";n.has(a)||(Wa(t,e,2,!1),n.add(a))}function za(e,t,n){var a=0;t&&(a|=4),Wa(n,e,a,t)}var Ba="_reactListening"+Math.random().toString(36).slice(2);function Ga(e){if(!e[Ba]){e[Ba]=!0,i.forEach(function(t){"selectionchange"!==t&&(Ma.has(t)||za(t,!1,e),za(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ba]||(t[Ba]=!0,za("selectionchange",!1,t))}}function Wa(e,t,n,a){switch($t(t)){case 1:var r=qt;break;case 4:r=Kt;break;default:r=Jt}n=r.bind(null,t,n,e),r=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),a?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Va(e,t,n,a,r){var o=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var l=a.stateNode.containerInfo;if(l===r||8===l.nodeType&&l.parentNode===r)break;if(4===i)for(i=a.return;null!==i;){var s=i.tag;if((3===s||4===s)&&((s=i.stateNode.containerInfo)===r||8===s.nodeType&&s.parentNode===r))return;i=i.return}for(;null!==l;){if(null===(i=yr(l)))return;if(5===(s=i.tag)||6===s){a=o=i;continue e}l=l.parentNode}}a=a.return}Ae(function(){var a=o,r=ke(n),i=[];e:{var l=Ta.get(e);if(void 0!==l){var s=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":s=En;break;case"focusin":c="focus",s=fn;break;case"focusout":c="blur",s=fn;break;case"beforeblur":case"afterblur":s=fn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=Dn;break;case Ca:case Ea:case Ia:s=vn;break;case Da:s=Tn;break;case"scroll":s=pn;break;case"wheel":s=Pn;break;case"copy":case"cut":case"paste":s=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=In}var d=0!==(4&t),u=!d&&"scroll"===e,p=d?null!==l?l+"Capture":null:l;d=[];for(var m,h=a;null!==h;){var g=(m=h).stateNode;if(5===m.tag&&null!==g&&(m=g,null!==p&&(null!=(g=Pe(h,p))&&d.push(qa(h,g,m)))),u)break;h=h.return}0<d.length&&(l=new s(l,c,null,n,r),i.push({event:l,listeners:d}))}}if(0===(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!yr(c)&&!c[hr])&&(s||l)&&(l=r.window===r?r:(l=r.ownerDocument)?l.defaultView||l.parentWindow:window,s?(s=a,null!==(c=(c=n.relatedTarget||n.toElement)?yr(c):null)&&(c!==(u=Ge(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(s=null,c=a),s!==c)){if(d=hn,g="onMouseLeave",p="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(d=In,g="onPointerLeave",p="onPointerEnter",h="pointer"),u=null==s?l:xr(s),m=null==c?l:xr(c),(l=new d(g,h+"leave",s,n,r)).target=u,l.relatedTarget=m,g=null,yr(r)===a&&((d=new d(p,h+"enter",c,n,r)).target=m,d.relatedTarget=u,g=d),u=g,s&&c)e:{for(p=c,h=0,m=d=s;m;m=Ja(m))h++;for(m=0,g=p;g;g=Ja(g))m++;for(;0<h-m;)d=Ja(d),h--;for(;0<m-h;)p=Ja(p),m--;for(;h--;){if(d===p||null!==p&&d===p.alternate)break e;d=Ja(d),p=Ja(p)}d=null}else d=null;null!==s&&Ha(i,l,s,d,!1),null!==c&&null!==u&&Ha(i,u,c,d,!0)}if("select"===(s=(l=a?xr(a):window).nodeName&&l.nodeName.toLowerCase())||"input"===s&&"file"===l.type)var f=$n;else if(Vn(l))if(Yn)f=ia;else{f=ra;var v=aa}else(s=l.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(f=oa);switch(f&&(f=f(e,a))?qn(i,f,n,r):(v&&v(e,l,a),"focusout"===e&&(v=l._wrapperState)&&v.controlled&&"number"===l.type&&ee(l,"number",l.value)),v=a?xr(a):window,e){case"focusin":(Vn(v)||"true"===v.contentEditable)&&(fa=v,va=a,ya=null);break;case"focusout":ya=va=fa=null;break;case"mousedown":ba=!0;break;case"contextmenu":case"mouseup":case"dragend":ba=!1,xa(i,n,r);break;case"selectionchange":if(ga)break;case"keydown":case"keyup":xa(i,n,r)}var y;if(Ln)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Gn?zn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Gn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Gn&&(y=en()):(Xt="value"in(Yt=r)?Yt.value:Yt.textContent,Gn=!0)),0<(v=Ka(a,b)).length&&(b=new xn(b,e,null,n,r),i.push({event:b,listeners:v}),y?b.data=y:null!==(y=Bn(n))&&(b.data=y))),(y=Mn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(_n=!0,Un);case"textInput":return(e=t.data)===Un&&_n?null:e;default:return null}}(e,n):function(e,t){if(Gn)return"compositionend"===e||!Ln&&zn(e,t)?(e=en(),Zt=Xt=Yt=null,Gn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(a=Ka(a,"onBeforeInput")).length&&(r=new xn("onBeforeInput","beforeinput",null,n,r),i.push({event:r,listeners:a}),r.data=y))}Ua(i,t)})}function qa(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ka(e,t){for(var n=t+"Capture",a=[];null!==e;){var r=e,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=Pe(e,n))&&a.unshift(qa(e,o,r)),null!=(o=Pe(e,t))&&a.push(qa(e,o,r))),e=e.return}return a}function Ja(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ha(e,t,n,a,r){for(var o=t._reactName,i=[];null!==n&&n!==a;){var l=n,s=l.alternate,c=l.stateNode;if(null!==s&&s===a)break;5===l.tag&&null!==c&&(l=c,r?null!=(s=Pe(n,o))&&i.unshift(qa(n,s,l)):r||null!=(s=Pe(n,o))&&i.push(qa(n,s,l))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Qa=/\r\n?/g,$a=/\u0000|\uFFFD/g;function Ya(e){return("string"===typeof e?e:""+e).replace(Qa,"\n").replace($a,"")}function Xa(e,t,n){if(t=Ya(t),Ya(e)!==t&&n)throw Error(o(425))}function Za(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ar="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,or="function"===typeof Promise?Promise:void 0,ir="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof or?function(e){return or.resolve(null).then(e).catch(lr)}:ar;function lr(e){setTimeout(function(){throw e})}function sr(e,t){var n=t,a=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===a)return e.removeChild(r),void Gt(t);a--}else"$"!==n&&"$?"!==n&&"$!"!==n||a++;n=r}while(n);Gt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function dr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ur=Math.random().toString(36).slice(2),pr="__reactFiber$"+ur,mr="__reactProps$"+ur,hr="__reactContainer$"+ur,gr="__reactEvents$"+ur,fr="__reactListeners$"+ur,vr="__reactHandles$"+ur;function yr(e){var t=e[pr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[hr]||n[pr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=dr(e);null!==e;){if(n=e[pr])return n;e=dr(e)}return t}n=(e=n).parentNode}return null}function br(e){return!(e=e[pr]||e[hr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function kr(e){return e[mr]||null}var jr=[],wr=-1;function Sr(e){return{current:e}}function Nr(e){0>wr||(e.current=jr[wr],jr[wr]=null,wr--)}function Cr(e,t){wr++,jr[wr]=e.current,e.current=t}var Er={},Ir=Sr(Er),Dr=Sr(!1),Tr=Er;function Ar(e,t){var n=e.type.contextTypes;if(!n)return Er;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=t[r];return a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Pr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Or(){Nr(Dr),Nr(Ir)}function Lr(e,t,n){if(Ir.current!==Er)throw Error(o(168));Cr(Ir,t),Cr(Dr,n)}function Rr(e,t,n){var a=e.stateNode;if(t=t.childContextTypes,"function"!==typeof a.getChildContext)return n;for(var r in a=a.getChildContext())if(!(r in t))throw Error(o(108,W(e)||"Unknown",r));return F({},n,a)}function Mr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Er,Tr=Ir.current,Cr(Ir,e),Cr(Dr,Dr.current),!0}function Fr(e,t,n){var a=e.stateNode;if(!a)throw Error(o(169));n?(e=Rr(e,t,Tr),a.__reactInternalMemoizedMergedChildContext=e,Nr(Dr),Nr(Ir),Cr(Ir,e)):Nr(Dr),Cr(Dr,n)}var Ur=null,_r=!1,zr=!1;function Br(e){null===Ur?Ur=[e]:Ur.push(e)}function Gr(){if(!zr&&null!==Ur){zr=!0;var e=0,t=bt;try{var n=Ur;for(bt=1;e<n.length;e++){var a=n[e];do{a=a(!0)}while(null!==a)}Ur=null,_r=!1}catch(r){throw null!==Ur&&(Ur=Ur.slice(e+1)),Je(Ze,Gr),r}finally{bt=t,zr=!1}}return null}var Wr=[],Vr=0,qr=null,Kr=0,Jr=[],Hr=0,Qr=null,$r=1,Yr="";function Xr(e,t){Wr[Vr++]=Kr,Wr[Vr++]=qr,qr=e,Kr=t}function Zr(e,t,n){Jr[Hr++]=$r,Jr[Hr++]=Yr,Jr[Hr++]=Qr,Qr=e;var a=$r;e=Yr;var r=32-it(a)-1;a&=~(1<<r),n+=1;var o=32-it(t)+r;if(30<o){var i=r-r%5;o=(a&(1<<i)-1).toString(32),a>>=i,r-=i,$r=1<<32-it(t)+r|n<<r|a,Yr=o+e}else $r=1<<o|n<<r|a,Yr=e}function eo(e){null!==e.return&&(Xr(e,1),Zr(e,1,0))}function to(e){for(;e===qr;)qr=Wr[--Vr],Wr[Vr]=null,Kr=Wr[--Vr],Wr[Vr]=null;for(;e===Qr;)Qr=Jr[--Hr],Jr[Hr]=null,Yr=Jr[--Hr],Jr[Hr]=null,$r=Jr[--Hr],Jr[Hr]=null}var no=null,ao=null,ro=!1,oo=null;function io(e,t){var n=Tc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function lo(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ao=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ao=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qr?{id:$r,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Tc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ao=null,!0);default:return!1}}function so(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function co(e){if(ro){var t=ao;if(t){var n=t;if(!lo(e,t)){if(so(e))throw Error(o(418));t=cr(n.nextSibling);var a=no;t&&lo(e,t)?io(a,n):(e.flags=-4097&e.flags|2,ro=!1,no=e)}}else{if(so(e))throw Error(o(418));e.flags=-4097&e.flags|2,ro=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function po(e){if(e!==no)return!1;if(!ro)return uo(e),ro=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=ao)){if(so(e))throw mo(),Error(o(418));for(;t;)io(e,t),t=cr(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ao=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ao=null}}else ao=no?cr(e.stateNode.nextSibling):null;return!0}function mo(){for(var e=ao;e;)e=cr(e.nextSibling)}function ho(){ao=no=null,ro=!1}function go(e){null===oo?oo=[e]:oo.push(e)}var fo=x.ReactCurrentBatchConfig;function vo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var a=n.stateNode}if(!a)throw Error(o(147,e));var r=a,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function yo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bo(e){return(0,e._init)(e._payload)}function xo(e){function t(t,n){if(e){var a=t.deletions;null===a?(t.deletions=[n],t.flags|=16):a.push(n)}}function n(n,a){if(!e)return null;for(;null!==a;)t(n,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function i(t,n,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<n?(t.flags|=2,n):a:(t.flags|=2,n):(t.flags|=1048576,n)}function l(t){return e&&null===t.alternate&&(t.flags|=2),t}function s(e,t,n,a){return null===t||6!==t.tag?((t=Mc(n,e.mode,a)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,a){var o=n.type;return o===w?u(e,t,n.props.children,a,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===P&&bo(o)===t.type)?((a=r(t,n.props)).ref=vo(e,t,n),a.return=e,a):((a=Oc(n.type,n.key,n.props,null,e.mode,a)).ref=vo(e,t,n),a.return=e,a)}function d(e,t,n,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,a)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function u(e,t,n,a,o){return null===t||7!==t.tag?((t=Lc(n,e.mode,a,o)).return=e,t):((t=r(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Mc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=vo(e,null,t),n.return=e,n;case j:return(t=Fc(t,e.mode,n)).return=e,t;case P:return p(e,(0,t._init)(t._payload),n)}if(te(t)||R(t))return(t=Lc(t,e.mode,n,null)).return=e,t;yo(e,t)}return null}function m(e,t,n,a){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:s(e,t,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===r?c(e,t,n,a):null;case j:return n.key===r?d(e,t,n,a):null;case P:return m(e,t,(r=n._init)(n._payload),a)}if(te(n)||R(n))return null!==r?null:u(e,t,n,a,null);yo(e,n)}return null}function h(e,t,n,a,r){if("string"===typeof a&&""!==a||"number"===typeof a)return s(t,e=e.get(n)||null,""+a,r);if("object"===typeof a&&null!==a){switch(a.$$typeof){case k:return c(t,e=e.get(null===a.key?n:a.key)||null,a,r);case j:return d(t,e=e.get(null===a.key?n:a.key)||null,a,r);case P:return h(e,t,n,(0,a._init)(a._payload),r)}if(te(a)||R(a))return u(t,e=e.get(n)||null,a,r,null);yo(t,a)}return null}function g(r,o,l,s){for(var c=null,d=null,u=o,g=o=0,f=null;null!==u&&g<l.length;g++){u.index>g?(f=u,u=null):f=u.sibling;var v=m(r,u,l[g],s);if(null===v){null===u&&(u=f);break}e&&u&&null===v.alternate&&t(r,u),o=i(v,o,g),null===d?c=v:d.sibling=v,d=v,u=f}if(g===l.length)return n(r,u),ro&&Xr(r,g),c;if(null===u){for(;g<l.length;g++)null!==(u=p(r,l[g],s))&&(o=i(u,o,g),null===d?c=u:d.sibling=u,d=u);return ro&&Xr(r,g),c}for(u=a(r,u);g<l.length;g++)null!==(f=h(u,r,g,l[g],s))&&(e&&null!==f.alternate&&u.delete(null===f.key?g:f.key),o=i(f,o,g),null===d?c=f:d.sibling=f,d=f);return e&&u.forEach(function(e){return t(r,e)}),ro&&Xr(r,g),c}function f(r,l,s,c){var d=R(s);if("function"!==typeof d)throw Error(o(150));if(null==(s=d.call(s)))throw Error(o(151));for(var u=d=null,g=l,f=l=0,v=null,y=s.next();null!==g&&!y.done;f++,y=s.next()){g.index>f?(v=g,g=null):v=g.sibling;var b=m(r,g,y.value,c);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(r,g),l=i(b,l,f),null===u?d=b:u.sibling=b,u=b,g=v}if(y.done)return n(r,g),ro&&Xr(r,f),d;if(null===g){for(;!y.done;f++,y=s.next())null!==(y=p(r,y.value,c))&&(l=i(y,l,f),null===u?d=y:u.sibling=y,u=y);return ro&&Xr(r,f),d}for(g=a(r,g);!y.done;f++,y=s.next())null!==(y=h(g,r,f,y.value,c))&&(e&&null!==y.alternate&&g.delete(null===y.key?f:y.key),l=i(y,l,f),null===u?d=y:u.sibling=y,u=y);return e&&g.forEach(function(e){return t(r,e)}),ro&&Xr(r,f),d}return function e(a,o,i,s){if("object"===typeof i&&null!==i&&i.type===w&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case k:e:{for(var c=i.key,d=o;null!==d;){if(d.key===c){if((c=i.type)===w){if(7===d.tag){n(a,d.sibling),(o=r(d,i.props.children)).return=a,a=o;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&bo(c)===d.type){n(a,d.sibling),(o=r(d,i.props)).ref=vo(a,d,i),o.return=a,a=o;break e}n(a,d);break}t(a,d),d=d.sibling}i.type===w?((o=Lc(i.props.children,a.mode,s,i.key)).return=a,a=o):((s=Oc(i.type,i.key,i.props,null,a.mode,s)).ref=vo(a,o,i),s.return=a,a=s)}return l(a);case j:e:{for(d=i.key;null!==o;){if(o.key===d){if(4===o.tag&&o.stateNode.containerInfo===i.containerInfo&&o.stateNode.implementation===i.implementation){n(a,o.sibling),(o=r(o,i.children||[])).return=a,a=o;break e}n(a,o);break}t(a,o),o=o.sibling}(o=Fc(i,a.mode,s)).return=a,a=o}return l(a);case P:return e(a,o,(d=i._init)(i._payload),s)}if(te(i))return g(a,o,i,s);if(R(i))return f(a,o,i,s);yo(a,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==o&&6===o.tag?(n(a,o.sibling),(o=r(o,i)).return=a,a=o):(n(a,o),(o=Mc(i,a.mode,s)).return=a,a=o),l(a)):n(a,o)}}var ko=xo(!0),jo=xo(!1),wo=Sr(null),So=null,No=null,Co=null;function Eo(){Co=No=So=null}function Io(e){var t=wo.current;Nr(wo),e._currentValue=t}function Do(e,t,n){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function To(e,t){So=e,Co=No=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bl=!0),e.firstContext=null)}function Ao(e){var t=e._currentValue;if(Co!==e)if(e={context:e,memoizedValue:t,next:null},null===No){if(null===So)throw Error(o(308));No=e,So.dependencies={lanes:0,firstContext:e}}else No=No.next=e;return t}var Po=null;function Oo(e){null===Po?Po=[e]:Po.push(e)}function Lo(e,t,n,a){var r=t.interleaved;return null===r?(n.next=n,Oo(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ro(e,a)}function Ro(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Mo=!1;function Fo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Uo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function _o(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zo(e,t,n){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&Es)){var r=a.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),a.pending=t,Ro(e,n)}return null===(r=a.interleaved)?(t.next=t,Oo(a)):(t.next=r.next,r.next=t),a.interleaved=t,Ro(e,n)}function Bo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Go(e,t){var n=e.updateQueue,a=e.alternate;if(null!==a&&n===(a=a.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=i:o=o.next=i,n=n.next}while(null!==n);null===o?r=o=t:o=o.next=t}else r=o=t;return n={baseState:a.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:a.shared,effects:a.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wo(e,t,n,a){var r=e.updateQueue;Mo=!1;var o=r.firstBaseUpdate,i=r.lastBaseUpdate,l=r.shared.pending;if(null!==l){r.shared.pending=null;var s=l,c=s.next;s.next=null,null===i?o=c:i.next=c,i=s;var d=e.alternate;null!==d&&((l=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===l?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=s))}if(null!==o){var u=r.baseState;for(i=0,d=c=s=null,l=o;;){var p=l.lane,m=l.eventTime;if((a&p)===p){null!==d&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var h=e,g=l;switch(p=t,m=n,g.tag){case 1:if("function"===typeof(h=g.payload)){u=h.call(m,u,p);break e}u=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(p="function"===typeof(h=g.payload)?h.call(m,u,p):h)||void 0===p)break e;u=F({},u,p);break e;case 2:Mo=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(p=r.effects)?r.effects=[l]:p.push(l))}else m={eventTime:m,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(c=d=m,s=u):d=d.next=m,i|=p;if(null===(l=l.next)){if(null===(l=r.shared.pending))break;l=(p=l).next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}if(null===d&&(s=u),r.baseState=s,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null!==(t=r.shared.interleaved)){r=t;do{i|=r.lane,r=r.next}while(r!==t)}else null===o&&(r.shared.lanes=0);Rs|=i,e.lanes=i,e.memoizedState=u}}function Vo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var a=e[t],r=a.callback;if(null!==r){if(a.callback=null,a=n,"function"!==typeof r)throw Error(o(191,r));r.call(a)}}}var qo={},Ko=Sr(qo),Jo=Sr(qo),Ho=Sr(qo);function Qo(e){if(e===qo)throw Error(o(174));return e}function $o(e,t){switch(Cr(Ho,t),Cr(Jo,e),Cr(Ko,qo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:se(null,"");break;default:t=se(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Nr(Ko),Cr(Ko,t)}function Yo(){Nr(Ko),Nr(Jo),Nr(Ho)}function Xo(e){Qo(Ho.current);var t=Qo(Ko.current),n=se(t,e.type);t!==n&&(Cr(Jo,e),Cr(Ko,n))}function Zo(e){Jo.current===e&&(Nr(Ko),Nr(Jo))}var ei=Sr(0);function ti(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ni=[];function ai(){for(var e=0;e<ni.length;e++)ni[e]._workInProgressVersionPrimary=null;ni.length=0}var ri=x.ReactCurrentDispatcher,oi=x.ReactCurrentBatchConfig,ii=0,li=null,si=null,ci=null,di=!1,ui=!1,pi=0,mi=0;function hi(){throw Error(o(321))}function gi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!la(e[n],t[n]))return!1;return!0}function fi(e,t,n,a,r,i){if(ii=i,li=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ri.current=null===e||null===e.memoizedState?Zi:el,e=n(a,r),ui){i=0;do{if(ui=!1,pi=0,25<=i)throw Error(o(301));i+=1,ci=si=null,t.updateQueue=null,ri.current=tl,e=n(a,r)}while(ui)}if(ri.current=Xi,t=null!==si&&null!==si.next,ii=0,ci=si=li=null,di=!1,t)throw Error(o(300));return e}function vi(){var e=0!==pi;return pi=0,e}function yi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ci?li.memoizedState=ci=e:ci=ci.next=e,ci}function bi(){if(null===si){var e=li.alternate;e=null!==e?e.memoizedState:null}else e=si.next;var t=null===ci?li.memoizedState:ci.next;if(null!==t)ci=t,si=e;else{if(null===e)throw Error(o(310));e={memoizedState:(si=e).memoizedState,baseState:si.baseState,baseQueue:si.baseQueue,queue:si.queue,next:null},null===ci?li.memoizedState=ci=e:ci=ci.next=e}return ci}function xi(e,t){return"function"===typeof t?t(e):t}function ki(e){var t=bi(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var a=si,r=a.baseQueue,i=n.pending;if(null!==i){if(null!==r){var l=r.next;r.next=i.next,i.next=l}a.baseQueue=r=i,n.pending=null}if(null!==r){i=r.next,a=a.baseState;var s=l=null,c=null,d=i;do{var u=d.lane;if((ii&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),a=d.hasEagerState?d.eagerState:e(a,d.action);else{var p={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(s=c=p,l=a):c=c.next=p,li.lanes|=u,Rs|=u}d=d.next}while(null!==d&&d!==i);null===c?l=a:c.next=s,la(a,t.memoizedState)||(bl=!0),t.memoizedState=a,t.baseState=l,t.baseQueue=c,n.lastRenderedState=a}if(null!==(e=n.interleaved)){r=e;do{i=r.lane,li.lanes|=i,Rs|=i,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ji(e){var t=bi(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var a=n.dispatch,r=n.pending,i=t.memoizedState;if(null!==r){n.pending=null;var l=r=r.next;do{i=e(i,l.action),l=l.next}while(l!==r);la(i,t.memoizedState)||(bl=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,a]}function wi(){}function Si(e,t){var n=li,a=bi(),r=t(),i=!la(a.memoizedState,r);if(i&&(a.memoizedState=r,bl=!0),a=a.queue,Mi(Ei.bind(null,n,a,e),[e]),a.getSnapshot!==t||i||null!==ci&&1&ci.memoizedState.tag){if(n.flags|=2048,Ai(9,Ci.bind(null,n,a,r,t),void 0,null),null===Is)throw Error(o(349));0!==(30&ii)||Ni(n,t,r)}return r}function Ni(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=li.updateQueue)?(t={lastEffect:null,stores:null},li.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ci(e,t,n,a){t.value=n,t.getSnapshot=a,Ii(t)&&Di(e)}function Ei(e,t,n){return n(function(){Ii(t)&&Di(e)})}function Ii(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!la(e,n)}catch(a){return!0}}function Di(e){var t=Ro(e,1);null!==t&&tc(t,e,1,-1)}function Ti(e){var t=yi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xi,lastRenderedState:e},t.queue=e,e=e.dispatch=Hi.bind(null,li,e),[t.memoizedState,e]}function Ai(e,t,n,a){return e={tag:e,create:t,destroy:n,deps:a,next:null},null===(t=li.updateQueue)?(t={lastEffect:null,stores:null},li.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function Pi(){return bi().memoizedState}function Oi(e,t,n,a){var r=yi();li.flags|=e,r.memoizedState=Ai(1|t,n,void 0,void 0===a?null:a)}function Li(e,t,n,a){var r=bi();a=void 0===a?null:a;var o=void 0;if(null!==si){var i=si.memoizedState;if(o=i.destroy,null!==a&&gi(a,i.deps))return void(r.memoizedState=Ai(t,n,o,a))}li.flags|=e,r.memoizedState=Ai(1|t,n,o,a)}function Ri(e,t){return Oi(8390656,8,e,t)}function Mi(e,t){return Li(2048,8,e,t)}function Fi(e,t){return Li(4,2,e,t)}function Ui(e,t){return Li(4,4,e,t)}function _i(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zi(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Li(4,4,_i.bind(null,t,e),n)}function Bi(){}function Gi(e,t){var n=bi();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&gi(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function Wi(e,t){var n=bi();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&gi(t,a[1])?a[0]:(e=e(),n.memoizedState=[e,t],e)}function Vi(e,t,n){return 0===(21&ii)?(e.baseState&&(e.baseState=!1,bl=!0),e.memoizedState=n):(la(n,t)||(n=gt(),li.lanes|=n,Rs|=n,e.baseState=!0),t)}function qi(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var a=oi.transition;oi.transition={};try{e(!1),t()}finally{bt=n,oi.transition=a}}function Ki(){return bi().memoizedState}function Ji(e,t,n){var a=ec(e);if(n={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null},Qi(e))$i(t,n);else if(null!==(n=Lo(e,t,n,a))){tc(n,e,a,Zs()),Yi(n,t,a)}}function Hi(e,t,n){var a=ec(e),r={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qi(e))$i(t,r);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var i=t.lastRenderedState,l=o(i,n);if(r.hasEagerState=!0,r.eagerState=l,la(l,i)){var s=t.interleaved;return null===s?(r.next=r,Oo(t)):(r.next=s.next,s.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Lo(e,t,r,a))&&(tc(n,e,a,r=Zs()),Yi(n,t,a))}}function Qi(e){var t=e.alternate;return e===li||null!==t&&t===li}function $i(e,t){ui=di=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yi(e,t,n){if(0!==(4194240&n)){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Xi={readContext:Ao,useCallback:hi,useContext:hi,useEffect:hi,useImperativeHandle:hi,useInsertionEffect:hi,useLayoutEffect:hi,useMemo:hi,useReducer:hi,useRef:hi,useState:hi,useDebugValue:hi,useDeferredValue:hi,useTransition:hi,useMutableSource:hi,useSyncExternalStore:hi,useId:hi,unstable_isNewReconciler:!1},Zi={readContext:Ao,useCallback:function(e,t){return yi().memoizedState=[e,void 0===t?null:t],e},useContext:Ao,useEffect:Ri,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oi(4194308,4,_i.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Oi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oi(4,2,e,t)},useMemo:function(e,t){var n=yi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var a=yi();return t=void 0!==n?n(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=Ji.bind(null,li,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},yi().memoizedState=e},useState:Ti,useDebugValue:Bi,useDeferredValue:function(e){return yi().memoizedState=e},useTransition:function(){var e=Ti(!1),t=e[0];return e=qi.bind(null,e[1]),yi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var a=li,r=yi();if(ro){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Is)throw Error(o(349));0!==(30&ii)||Ni(a,t,n)}r.memoizedState=n;var i={value:n,getSnapshot:t};return r.queue=i,Ri(Ei.bind(null,a,i,e),[e]),a.flags|=2048,Ai(9,Ci.bind(null,a,i,n,t),void 0,null),n},useId:function(){var e=yi(),t=Is.identifierPrefix;if(ro){var n=Yr;t=":"+t+"R"+(n=($r&~(1<<32-it($r)-1)).toString(32)+n),0<(n=pi++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=mi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},el={readContext:Ao,useCallback:Gi,useContext:Ao,useEffect:Mi,useImperativeHandle:zi,useInsertionEffect:Fi,useLayoutEffect:Ui,useMemo:Wi,useReducer:ki,useRef:Pi,useState:function(){return ki(xi)},useDebugValue:Bi,useDeferredValue:function(e){return Vi(bi(),si.memoizedState,e)},useTransition:function(){return[ki(xi)[0],bi().memoizedState]},useMutableSource:wi,useSyncExternalStore:Si,useId:Ki,unstable_isNewReconciler:!1},tl={readContext:Ao,useCallback:Gi,useContext:Ao,useEffect:Mi,useImperativeHandle:zi,useInsertionEffect:Fi,useLayoutEffect:Ui,useMemo:Wi,useReducer:ji,useRef:Pi,useState:function(){return ji(xi)},useDebugValue:Bi,useDeferredValue:function(e){var t=bi();return null===si?t.memoizedState=e:Vi(t,si.memoizedState,e)},useTransition:function(){return[ji(xi)[0],bi().memoizedState]},useMutableSource:wi,useSyncExternalStore:Si,useId:Ki,unstable_isNewReconciler:!1};function nl(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function al(e,t,n,a){n=null===(n=n(a,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var rl={isMounted:function(e){return!!(e=e._reactInternals)&&Ge(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var a=Zs(),r=ec(e),o=_o(a,r);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,r))&&(tc(t,e,r,a),Bo(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=Zs(),r=ec(e),o=_o(a,r);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,r))&&(tc(t,e,r,a),Bo(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Zs(),a=ec(e),r=_o(n,a);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=zo(e,r,a))&&(tc(t,e,a,n),Bo(t,e,a))}};function ol(e,t,n,a,r,o,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,o,i):!t.prototype||!t.prototype.isPureReactComponent||(!sa(n,a)||!sa(r,o))}function il(e,t,n){var a=!1,r=Er,o=t.contextType;return"object"===typeof o&&null!==o?o=Ao(o):(r=Pr(t)?Tr:Ir.current,o=(a=null!==(a=t.contextTypes)&&void 0!==a)?Ar(e,r):Er),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=rl,e.stateNode=t,t._reactInternals=e,a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=o),t}function ll(e,t,n,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&rl.enqueueReplaceState(t,t.state,null)}function sl(e,t,n,a){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Fo(e);var o=t.contextType;"object"===typeof o&&null!==o?r.context=Ao(o):(o=Pr(t)?Tr:Ir.current,r.context=Ar(e,o)),r.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(al(e,t,o,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&rl.enqueueReplaceState(r,r.state,null),Wo(e,n,r,a),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function cl(e,t){try{var n="",a=t;do{n+=B(a),a=a.return}while(a);var r=n}catch(o){r="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:r,digest:null}}function dl(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ul(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var pl="function"===typeof WeakMap?WeakMap:Map;function ml(e,t,n){(n=_o(-1,n)).tag=3,n.payload={element:null};var a=t.value;return n.callback=function(){Ws||(Ws=!0,Vs=a),ul(0,t)},n}function hl(e,t,n){(n=_o(-1,n)).tag=3;var a=e.type.getDerivedStateFromError;if("function"===typeof a){var r=t.value;n.payload=function(){return a(r)},n.callback=function(){ul(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){ul(0,t),"function"!==typeof a&&(null===qs?qs=new Set([this]):qs.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function gl(e,t,n){var a=e.pingCache;if(null===a){a=e.pingCache=new pl;var r=new Set;a.set(t,r)}else void 0===(r=a.get(t))&&(r=new Set,a.set(t,r));r.has(n)||(r.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function fl(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vl(e,t,n,a,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=_o(-1,1)).tag=2,zo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var yl=x.ReactCurrentOwner,bl=!1;function xl(e,t,n,a){t.child=null===e?jo(t,null,n,a):ko(t,e.child,n,a)}function kl(e,t,n,a,r){n=n.render;var o=t.ref;return To(t,r),a=fi(e,t,n,a,o,r),n=vi(),null===e||bl?(ro&&n&&eo(t),t.flags|=1,xl(e,t,a,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wl(e,t,r))}function jl(e,t,n,a,r){if(null===e){var o=n.type;return"function"!==typeof o||Ac(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,a,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,wl(e,t,o,a,r))}if(o=e.child,0===(e.lanes&r)){var i=o.memoizedProps;if((n=null!==(n=n.compare)?n:sa)(i,a)&&e.ref===t.ref)return Wl(e,t,r)}return t.flags|=1,(e=Pc(o,a)).ref=t.ref,e.return=t,t.child=e}function wl(e,t,n,a,r){if(null!==e){var o=e.memoizedProps;if(sa(o,a)&&e.ref===t.ref){if(bl=!1,t.pendingProps=a=o,0===(e.lanes&r))return t.lanes=e.lanes,Wl(e,t,r);0!==(131072&e.flags)&&(bl=!0)}}return Cl(e,t,n,a,r)}function Sl(e,t,n){var a=t.pendingProps,r=a.children,o=null!==e?e.memoizedState:null;if("hidden"===a.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cr(Ps,As),As|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Cr(Ps,As),As|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=null!==o?o.baseLanes:n,Cr(Ps,As),As|=a}else null!==o?(a=o.baseLanes|n,t.memoizedState=null):a=n,Cr(Ps,As),As|=a;return xl(e,t,r,n),t.child}function Nl(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cl(e,t,n,a,r){var o=Pr(n)?Tr:Ir.current;return o=Ar(t,o),To(t,r),n=fi(e,t,n,a,o,r),a=vi(),null===e||bl?(ro&&a&&eo(t),t.flags|=1,xl(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wl(e,t,r))}function El(e,t,n,a,r){if(Pr(n)){var o=!0;Mr(t)}else o=!1;if(To(t,r),null===t.stateNode)Gl(e,t),il(t,n,a),sl(t,n,a,r),a=!0;else if(null===e){var i=t.stateNode,l=t.memoizedProps;i.props=l;var s=i.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ao(c):c=Ar(t,c=Pr(n)?Tr:Ir.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==a||s!==c)&&ll(t,i,a,c),Mo=!1;var p=t.memoizedState;i.state=p,Wo(t,a,i,r),s=t.memoizedState,l!==a||p!==s||Dr.current||Mo?("function"===typeof d&&(al(t,n,d,a),s=t.memoizedState),(l=Mo||ol(t,n,l,a,p,s,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=s),i.props=a,i.state=s,i.context=c,a=l):("function"===typeof i.componentDidMount&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,Uo(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:nl(t.type,l),i.props=c,u=t.pendingProps,p=i.context,"object"===typeof(s=n.contextType)&&null!==s?s=Ao(s):s=Ar(t,s=Pr(n)?Tr:Ir.current);var m=n.getDerivedStateFromProps;(d="function"===typeof m||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==u||p!==s)&&ll(t,i,a,s),Mo=!1,p=t.memoizedState,i.state=p,Wo(t,a,i,r);var h=t.memoizedState;l!==u||p!==h||Dr.current||Mo?("function"===typeof m&&(al(t,n,m,a),h=t.memoizedState),(c=Mo||ol(t,n,c,a,p,h,s)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(a,h,s),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(a,h,s)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=h),i.props=a,i.state=h,i.context=s,a=c):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),a=!1)}return Il(e,t,n,a,o,r)}function Il(e,t,n,a,r,o){Nl(e,t);var i=0!==(128&t.flags);if(!a&&!i)return r&&Fr(t,n,!1),Wl(e,t,o);a=t.stateNode,yl.current=t;var l=i&&"function"!==typeof n.getDerivedStateFromError?null:a.render();return t.flags|=1,null!==e&&i?(t.child=ko(t,e.child,null,o),t.child=ko(t,null,l,o)):xl(e,t,l,o),t.memoizedState=a.state,r&&Fr(t,n,!0),t.child}function Dl(e){var t=e.stateNode;t.pendingContext?Lr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Lr(0,t.context,!1),$o(e,t.containerInfo)}function Tl(e,t,n,a,r){return ho(),go(r),t.flags|=256,xl(e,t,n,a),t.child}var Al,Pl,Ol,Ll={dehydrated:null,treeContext:null,retryLane:0};function Rl(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ml(e,t,n){var a,r=t.pendingProps,i=ei.current,l=!1,s=0!==(128&t.flags);if((a=s)||(a=(null===e||null!==e.memoizedState)&&0!==(2&i)),a?(l=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Cr(ei,1&i),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(s=r.children,e=r.fallback,l?(r=t.mode,l=t.child,s={mode:"hidden",children:s},0===(1&r)&&null!==l?(l.childLanes=0,l.pendingProps=s):l=Rc(s,r,0,null),e=Lc(e,r,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=Rl(n),t.memoizedState=Ll,e):Fl(t,s));if(null!==(i=e.memoizedState)&&null!==(a=i.dehydrated))return function(e,t,n,a,r,i,l){if(n)return 256&t.flags?(t.flags&=-257,Ul(e,t,l,a=dl(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=a.fallback,r=t.mode,a=Rc({mode:"visible",children:a.children},r,0,null),(i=Lc(i,r,l,null)).flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,0!==(1&t.mode)&&ko(t,e.child,null,l),t.child.memoizedState=Rl(l),t.memoizedState=Ll,i);if(0===(1&t.mode))return Ul(e,t,l,null);if("$!"===r.data){if(a=r.nextSibling&&r.nextSibling.dataset)var s=a.dgst;return a=s,Ul(e,t,l,a=dl(i=Error(o(419)),a,void 0))}if(s=0!==(l&e.childLanes),bl||s){if(null!==(a=Is)){switch(l&-l){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(a.suspendedLanes|l))?0:r)&&r!==i.retryLane&&(i.retryLane=r,Ro(e,r),tc(a,e,r,-1))}return hc(),Ul(e,t,l,a=dl(Error(o(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),r._reactRetry=t,null):(e=i.treeContext,ao=cr(r.nextSibling),no=t,ro=!0,oo=null,null!==e&&(Jr[Hr++]=$r,Jr[Hr++]=Yr,Jr[Hr++]=Qr,$r=e.id,Yr=e.overflow,Qr=t),t=Fl(t,a.children),t.flags|=4096,t)}(e,t,s,r,a,i,n);if(l){l=r.fallback,s=t.mode,a=(i=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&s)&&t.child!==i?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Pc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==a?l=Pc(a,l):(l=Lc(l,s,n,null)).flags|=2,l.return=t,r.return=t,r.sibling=l,t.child=r,r=l,l=t.child,s=null===(s=e.child.memoizedState)?Rl(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},l.memoizedState=s,l.childLanes=e.childLanes&~n,t.memoizedState=Ll,r}return e=(l=e.child).sibling,r=Pc(l,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Fl(e,t){return(t=Rc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ul(e,t,n,a){return null!==a&&go(a),ko(t,e.child,null,n),(e=Fl(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function _l(e,t,n){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),Do(e.return,t,n)}function zl(e,t,n,a,r){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:r}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=a,o.tail=n,o.tailMode=r)}function Bl(e,t,n){var a=t.pendingProps,r=a.revealOrder,o=a.tail;if(xl(e,t,a.children,n),0!==(2&(a=ei.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&_l(e,n,t);else if(19===e.tag)_l(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Cr(ei,a),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ti(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),zl(t,!1,r,n,o);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ti(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}zl(t,!0,n,null,o);break;case"together":zl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Gl(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wl(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Rs|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Vl(e,t){if(!ro)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;null!==n;)null!==n.alternate&&(a=n),n=n.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function ql(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,a=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,a|=14680064&r.subtreeFlags,a|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,a|=r.subtreeFlags,a|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function Kl(e,t,n){var a=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ql(t),null;case 1:case 17:return Pr(t.type)&&Or(),ql(t),null;case 3:return a=t.stateNode,Yo(),Nr(Dr),Nr(Ir),ai(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(po(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(oc(oo),oo=null))),ql(t),null;case 5:Zo(t);var r=Qo(Ho.current);if(n=t.type,null!==e&&null!=t.stateNode)Pl(e,t,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(null===t.stateNode)throw Error(o(166));return ql(t),null}if(e=Qo(Ko.current),po(t)){a=t.stateNode,n=t.type;var i=t.memoizedProps;switch(a[pr]=t,a[mr]=i,e=0!==(1&t.mode),n){case"dialog":_a("cancel",a),_a("close",a);break;case"iframe":case"object":case"embed":_a("load",a);break;case"video":case"audio":for(r=0;r<Ra.length;r++)_a(Ra[r],a);break;case"source":_a("error",a);break;case"img":case"image":case"link":_a("error",a),_a("load",a);break;case"details":_a("toggle",a);break;case"input":$(a,i),_a("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!i.multiple},_a("invalid",a);break;case"textarea":re(a,i),_a("invalid",a)}for(var s in ye(n,i),r=null,i)if(i.hasOwnProperty(s)){var c=i[s];"children"===s?"string"===typeof c?a.textContent!==c&&(!0!==i.suppressHydrationWarning&&Xa(a.textContent,c,e),r=["children",c]):"number"===typeof c&&a.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Xa(a.textContent,c,e),r=["children",""+c]):l.hasOwnProperty(s)&&null!=c&&"onScroll"===s&&_a("scroll",a)}switch(n){case"input":K(a),Z(a,i,!0);break;case"textarea":K(a),ie(a);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(a.onclick=Za)}a=r,t.updateQueue=a,null!==a&&(t.flags|=4)}else{s=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=le(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof a.is?e=s.createElement(n,{is:a.is}):(e=s.createElement(n),"select"===n&&(s=e,a.multiple?s.multiple=!0:a.size&&(s.size=a.size))):e=s.createElementNS(e,n),e[pr]=t,e[mr]=a,Al(e,t),t.stateNode=e;e:{switch(s=be(n,a),n){case"dialog":_a("cancel",e),_a("close",e),r=a;break;case"iframe":case"object":case"embed":_a("load",e),r=a;break;case"video":case"audio":for(r=0;r<Ra.length;r++)_a(Ra[r],e);r=a;break;case"source":_a("error",e),r=a;break;case"img":case"image":case"link":_a("error",e),_a("load",e),r=a;break;case"details":_a("toggle",e),r=a;break;case"input":$(e,a),r=Q(e,a),_a("invalid",e);break;case"option":default:r=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},r=F({},a,{value:void 0}),_a("invalid",e);break;case"textarea":re(e,a),r=ae(e,a),_a("invalid",e)}for(i in ye(n,r),c=r)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?fe(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===i?"string"===typeof d?("textarea"!==n||""!==d)&&pe(e,d):"number"===typeof d&&pe(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(l.hasOwnProperty(i)?null!=d&&"onScroll"===i&&_a("scroll",e):null!=d&&b(e,i,d,s))}switch(n){case"input":K(e),Z(e,a,!1);break;case"textarea":K(e),ie(e);break;case"option":null!=a.value&&e.setAttribute("value",""+V(a.value));break;case"select":e.multiple=!!a.multiple,null!=(i=a.value)?ne(e,!!a.multiple,i,!1):null!=a.defaultValue&&ne(e,!!a.multiple,a.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Za)}switch(n){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return ql(t),null;case 6:if(e&&null!=t.stateNode)Ol(0,t,e.memoizedProps,a);else{if("string"!==typeof a&&null===t.stateNode)throw Error(o(166));if(n=Qo(Ho.current),Qo(Ko.current),po(t)){if(a=t.stateNode,n=t.memoizedProps,a[pr]=t,(i=a.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Xa(a.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xa(a.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(a=(9===n.nodeType?n:n.ownerDocument).createTextNode(a))[pr]=t,t.stateNode=a}return ql(t),null;case 13:if(Nr(ei),a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ro&&null!==ao&&0!==(1&t.mode)&&0===(128&t.flags))mo(),ho(),t.flags|=98560,i=!1;else if(i=po(t),null!==a&&null!==a.dehydrated){if(null===e){if(!i)throw Error(o(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(o(317));i[pr]=t}else ho(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ql(t),i=!1}else null!==oo&&(oc(oo),oo=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((a=null!==a)!==(null!==e&&null!==e.memoizedState)&&a&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ei.current)?0===Os&&(Os=3):hc())),null!==t.updateQueue&&(t.flags|=4),ql(t),null);case 4:return Yo(),null===e&&Ga(t.stateNode.containerInfo),ql(t),null;case 10:return Io(t.type._context),ql(t),null;case 19:if(Nr(ei),null===(i=t.memoizedState))return ql(t),null;if(a=0!==(128&t.flags),null===(s=i.rendering))if(a)Vl(i,!1);else{if(0!==Os||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=ti(e))){for(t.flags|=128,Vl(i,!1),null!==(a=s.updateQueue)&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=n,n=t.child;null!==n;)e=a,(i=n).flags&=14680066,null===(s=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Cr(ei,1&ei.current|2),t.child}e=e.sibling}null!==i.tail&&Ye()>Bs&&(t.flags|=128,a=!0,Vl(i,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=ti(s))){if(t.flags|=128,a=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Vl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!ro)return ql(t),null}else 2*Ye()-i.renderingStartTime>Bs&&1073741824!==n&&(t.flags|=128,a=!0,Vl(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=i.last)?n.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ye(),t.sibling=null,n=ei.current,Cr(ei,a?1&n|2:1&n),t):(ql(t),null);case 22:case 23:return dc(),a=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==a&&(t.flags|=8192),a&&0!==(1&t.mode)?0!==(1073741824&As)&&(ql(t),6&t.subtreeFlags&&(t.flags|=8192)):ql(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Jl(e,t){switch(to(t),t.tag){case 1:return Pr(t.type)&&Or(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Yo(),Nr(Dr),Nr(Ir),ai(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zo(t),null;case 13:if(Nr(ei),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));ho()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Nr(ei),null;case 4:return Yo(),null;case 10:return Io(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Al=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Pl=function(e,t,n,a){var r=e.memoizedProps;if(r!==a){e=t.stateNode,Qo(Ko.current);var o,i=null;switch(n){case"input":r=Q(e,r),a=Q(e,a),i=[];break;case"select":r=F({},r,{value:void 0}),a=F({},a,{value:void 0}),i=[];break;case"textarea":r=ae(e,r),a=ae(e,a),i=[];break;default:"function"!==typeof r.onClick&&"function"===typeof a.onClick&&(e.onclick=Za)}for(d in ye(n,a),n=null,r)if(!a.hasOwnProperty(d)&&r.hasOwnProperty(d)&&null!=r[d])if("style"===d){var s=r[d];for(o in s)s.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(l.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in a){var c=a[d];if(s=null!=r?r[d]:void 0,a.hasOwnProperty(d)&&c!==s&&(null!=c||null!=s))if("style"===d)if(s){for(o in s)!s.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&s[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,s=s?s.__html:void 0,null!=c&&s!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(l.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&_a("scroll",e),i||s===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Ol=function(e,t,n,a){n!==a&&(t.flags|=4)};var Hl=!1,Ql=!1,$l="function"===typeof WeakSet?WeakSet:Set,Yl=null;function Xl(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(a){wc(e,t,a)}else n.current=null}function Zl(e,t,n){try{n()}catch(a){wc(e,t,a)}}var es=!1;function ts(e,t,n){var a=t.updateQueue;if(null!==(a=null!==a?a.lastEffect:null)){var r=a=a.next;do{if((r.tag&e)===e){var o=r.destroy;r.destroy=void 0,void 0!==o&&Zl(t,n,o)}r=r.next}while(r!==a)}}function ns(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var a=n.create;n.destroy=a()}n=n.next}while(n!==t)}}function as(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function rs(e){var t=e.alternate;null!==t&&(e.alternate=null,rs(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pr],delete t[mr],delete t[gr],delete t[fr],delete t[vr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function os(e){return 5===e.tag||3===e.tag||4===e.tag}function is(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||os(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ls(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Za));else if(4!==a&&null!==(e=e.child))for(ls(e,t,n),e=e.sibling;null!==e;)ls(e,t,n),e=e.sibling}function ss(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==a&&null!==(e=e.child))for(ss(e,t,n),e=e.sibling;null!==e;)ss(e,t,n),e=e.sibling}var cs=null,ds=!1;function us(e,t,n){for(n=n.child;null!==n;)ps(e,t,n),n=n.sibling}function ps(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(rt,n)}catch(l){}switch(n.tag){case 5:Ql||Xl(n,t);case 6:var a=cs,r=ds;cs=null,us(e,t,n),ds=r,null!==(cs=a)&&(ds?(e=cs,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cs.removeChild(n.stateNode));break;case 18:null!==cs&&(ds?(e=cs,n=n.stateNode,8===e.nodeType?sr(e.parentNode,n):1===e.nodeType&&sr(e,n),Gt(e)):sr(cs,n.stateNode));break;case 4:a=cs,r=ds,cs=n.stateNode.containerInfo,ds=!0,us(e,t,n),cs=a,ds=r;break;case 0:case 11:case 14:case 15:if(!Ql&&(null!==(a=n.updateQueue)&&null!==(a=a.lastEffect))){r=a=a.next;do{var o=r,i=o.destroy;o=o.tag,void 0!==i&&(0!==(2&o)||0!==(4&o))&&Zl(n,t,i),r=r.next}while(r!==a)}us(e,t,n);break;case 1:if(!Ql&&(Xl(n,t),"function"===typeof(a=n.stateNode).componentWillUnmount))try{a.props=n.memoizedProps,a.state=n.memoizedState,a.componentWillUnmount()}catch(l){wc(n,t,l)}us(e,t,n);break;case 21:us(e,t,n);break;case 22:1&n.mode?(Ql=(a=Ql)||null!==n.memoizedState,us(e,t,n),Ql=a):us(e,t,n);break;default:us(e,t,n)}}function ms(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $l),t.forEach(function(t){var a=Ec.bind(null,e,t);n.has(t)||(n.add(t),t.then(a,a))})}}function hs(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var r=n[a];try{var i=e,l=t,s=l;e:for(;null!==s;){switch(s.tag){case 5:cs=s.stateNode,ds=!1;break e;case 3:case 4:cs=s.stateNode.containerInfo,ds=!0;break e}s=s.return}if(null===cs)throw Error(o(160));ps(i,l,r),cs=null,ds=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(d){wc(r,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gs(t,e),t=t.sibling}function gs(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(hs(t,e),fs(e),4&a){try{ts(3,e,e.return),ns(3,e)}catch(f){wc(e,e.return,f)}try{ts(5,e,e.return)}catch(f){wc(e,e.return,f)}}break;case 1:hs(t,e),fs(e),512&a&&null!==n&&Xl(n,n.return);break;case 5:if(hs(t,e),fs(e),512&a&&null!==n&&Xl(n,n.return),32&e.flags){var r=e.stateNode;try{pe(r,"")}catch(f){wc(e,e.return,f)}}if(4&a&&null!=(r=e.stateNode)){var i=e.memoizedProps,l=null!==n?n.memoizedProps:i,s=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===s&&"radio"===i.type&&null!=i.name&&Y(r,i),be(s,l);var d=be(s,i);for(l=0;l<c.length;l+=2){var u=c[l],p=c[l+1];"style"===u?fe(r,p):"dangerouslySetInnerHTML"===u?ue(r,p):"children"===u?pe(r,p):b(r,u,p,d)}switch(s){case"input":X(r,i);break;case"textarea":oe(r,i);break;case"select":var m=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var h=i.value;null!=h?ne(r,!!i.multiple,h,!1):m!==!!i.multiple&&(null!=i.defaultValue?ne(r,!!i.multiple,i.defaultValue,!0):ne(r,!!i.multiple,i.multiple?[]:"",!1))}r[mr]=i}catch(f){wc(e,e.return,f)}}break;case 6:if(hs(t,e),fs(e),4&a){if(null===e.stateNode)throw Error(o(162));r=e.stateNode,i=e.memoizedProps;try{r.nodeValue=i}catch(f){wc(e,e.return,f)}}break;case 3:if(hs(t,e),fs(e),4&a&&null!==n&&n.memoizedState.isDehydrated)try{Gt(t.containerInfo)}catch(f){wc(e,e.return,f)}break;case 4:default:hs(t,e),fs(e);break;case 13:hs(t,e),fs(e),8192&(r=e.child).flags&&(i=null!==r.memoizedState,r.stateNode.isHidden=i,!i||null!==r.alternate&&null!==r.alternate.memoizedState||(zs=Ye())),4&a&&ms(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Ql=(d=Ql)||u,hs(t,e),Ql=d):hs(t,e),fs(e),8192&a){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Yl=e,u=e.child;null!==u;){for(p=Yl=u;null!==Yl;){switch(h=(m=Yl).child,m.tag){case 0:case 11:case 14:case 15:ts(4,m,m.return);break;case 1:Xl(m,m.return);var g=m.stateNode;if("function"===typeof g.componentWillUnmount){a=m,n=m.return;try{t=a,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(f){wc(a,n,f)}}break;case 5:Xl(m,m.return);break;case 22:if(null!==m.memoizedState){xs(p);continue}}null!==h?(h.return=m,Yl=h):xs(p)}u=u.sibling}e:for(u=null,p=e;;){if(5===p.tag){if(null===u){u=p;try{r=p.stateNode,d?"function"===typeof(i=r.style).setProperty?i.setProperty("display","none","important"):i.display="none":(s=p.stateNode,l=void 0!==(c=p.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,s.style.display=ge("display",l))}catch(f){wc(e,e.return,f)}}}else if(6===p.tag){if(null===u)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(f){wc(e,e.return,f)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:hs(t,e),fs(e),4&a&&ms(e);case 21:}}function fs(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(os(n)){var a=n;break e}n=n.return}throw Error(o(160))}switch(a.tag){case 5:var r=a.stateNode;32&a.flags&&(pe(r,""),a.flags&=-33),ss(e,is(e),r);break;case 3:case 4:var i=a.stateNode.containerInfo;ls(e,is(e),i);break;default:throw Error(o(161))}}catch(l){wc(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vs(e,t,n){Yl=e,ys(e,t,n)}function ys(e,t,n){for(var a=0!==(1&e.mode);null!==Yl;){var r=Yl,o=r.child;if(22===r.tag&&a){var i=null!==r.memoizedState||Hl;if(!i){var l=r.alternate,s=null!==l&&null!==l.memoizedState||Ql;l=Hl;var c=Ql;if(Hl=i,(Ql=s)&&!c)for(Yl=r;null!==Yl;)s=(i=Yl).child,22===i.tag&&null!==i.memoizedState?ks(r):null!==s?(s.return=i,Yl=s):ks(r);for(;null!==o;)Yl=o,ys(o,t,n),o=o.sibling;Yl=r,Hl=l,Ql=c}bs(e)}else 0!==(8772&r.subtreeFlags)&&null!==o?(o.return=r,Yl=o):bs(e)}}function bs(e){for(;null!==Yl;){var t=Yl;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ql||ns(5,t);break;case 1:var a=t.stateNode;if(4&t.flags&&!Ql)if(null===n)a.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:nl(t.type,n.memoizedProps);a.componentDidUpdate(r,n.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Vo(t,i,a);break;case 3:var l=t.updateQueue;if(null!==l){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vo(t,l,n)}break;case 5:var s=t.stateNode;if(null===n&&4&t.flags){n=s;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var p=u.dehydrated;null!==p&&Gt(p)}}}break;default:throw Error(o(163))}Ql||512&t.flags&&as(t)}catch(m){wc(t,t.return,m)}}if(t===e){Yl=null;break}if(null!==(n=t.sibling)){n.return=t.return,Yl=n;break}Yl=t.return}}function xs(e){for(;null!==Yl;){var t=Yl;if(t===e){Yl=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Yl=n;break}Yl=t.return}}function ks(e){for(;null!==Yl;){var t=Yl;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ns(4,t)}catch(s){wc(t,n,s)}break;case 1:var a=t.stateNode;if("function"===typeof a.componentDidMount){var r=t.return;try{a.componentDidMount()}catch(s){wc(t,r,s)}}var o=t.return;try{as(t)}catch(s){wc(t,o,s)}break;case 5:var i=t.return;try{as(t)}catch(s){wc(t,i,s)}}}catch(s){wc(t,t.return,s)}if(t===e){Yl=null;break}var l=t.sibling;if(null!==l){l.return=t.return,Yl=l;break}Yl=t.return}}var js,ws=Math.ceil,Ss=x.ReactCurrentDispatcher,Ns=x.ReactCurrentOwner,Cs=x.ReactCurrentBatchConfig,Es=0,Is=null,Ds=null,Ts=0,As=0,Ps=Sr(0),Os=0,Ls=null,Rs=0,Ms=0,Fs=0,Us=null,_s=null,zs=0,Bs=1/0,Gs=null,Ws=!1,Vs=null,qs=null,Ks=!1,Js=null,Hs=0,Qs=0,$s=null,Ys=-1,Xs=0;function Zs(){return 0!==(6&Es)?Ye():-1!==Ys?Ys:Ys=Ye()}function ec(e){return 0===(1&e.mode)?1:0!==(2&Es)&&0!==Ts?Ts&-Ts:null!==fo.transition?(0===Xs&&(Xs=gt()),Xs):0!==(e=bt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function tc(e,t,n,a){if(50<Qs)throw Qs=0,$s=null,Error(o(185));vt(e,n,a),0!==(2&Es)&&e===Is||(e===Is&&(0===(2&Es)&&(Ms|=n),4===Os&&ic(e,Ts)),nc(e,a),1===n&&0===Es&&0===(1&t.mode)&&(Bs=Ye()+500,_r&&Gr()))}function nc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,r=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-it(o),l=1<<i,s=r[i];-1===s?0!==(l&n)&&0===(l&a)||(r[i]=mt(l,t)):s<=t&&(e.expiredLanes|=l),o&=~l}}(e,t);var a=pt(e,e===Is?Ts:0);if(0===a)null!==n&&He(n),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(null!=n&&He(n),1===t)0===e.tag?function(e){_r=!0,Br(e)}(lc.bind(null,e)):Br(lc.bind(null,e)),ir(function(){0===(6&Es)&&Gr()}),n=null;else{switch(xt(a)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=at}n=Ic(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Ys=-1,Xs=0,0!==(6&Es))throw Error(o(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var a=pt(e,e===Is?Ts:0);if(0===a)return null;if(0!==(30&a)||0!==(a&e.expiredLanes)||t)t=gc(e,a);else{t=a;var r=Es;Es|=2;var i=mc();for(Is===e&&Ts===t||(Gs=null,Bs=Ye()+500,uc(e,t));;)try{vc();break}catch(s){pc(e,s)}Eo(),Ss.current=i,Es=r,null!==Ds?t=0:(Is=null,Ts=0,t=Os)}if(0!==t){if(2===t&&(0!==(r=ht(e))&&(a=r,t=rc(e,r))),1===t)throw n=Ls,uc(e,0),ic(e,a),nc(e,Ye()),n;if(6===t)ic(e,a);else{if(r=e.current.alternate,0===(30&a)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var a=0;a<n.length;a++){var r=n[a],o=r.getSnapshot;r=r.value;try{if(!la(o(),r))return!1}catch(l){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gc(e,a))&&(0!==(i=ht(e))&&(a=i,t=rc(e,i))),1===t))throw n=Ls,uc(e,0),ic(e,a),nc(e,Ye()),n;switch(e.finishedWork=r,e.finishedLanes=a,t){case 0:case 1:throw Error(o(345));case 2:case 5:xc(e,_s,Gs);break;case 3:if(ic(e,a),(130023424&a)===a&&10<(t=zs+500-Ye())){if(0!==pt(e,0))break;if(((r=e.suspendedLanes)&a)!==a){Zs(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ar(xc.bind(null,e,_s,Gs),t);break}xc(e,_s,Gs);break;case 4:if(ic(e,a),(4194240&a)===a)break;for(t=e.eventTimes,r=-1;0<a;){var l=31-it(a);i=1<<l,(l=t[l])>r&&(r=l),a&=~i}if(a=r,10<(a=(120>(a=Ye()-a)?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*ws(a/1960))-a)){e.timeoutHandle=ar(xc.bind(null,e,_s,Gs),a);break}xc(e,_s,Gs);break;default:throw Error(o(329))}}}return nc(e,Ye()),e.callbackNode===n?ac.bind(null,e):null}function rc(e,t){var n=Us;return e.current.memoizedState.isDehydrated&&(uc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=_s,_s=n,null!==t&&oc(t)),e}function oc(e){null===_s?_s=e:_s.push.apply(_s,e)}function ic(e,t){for(t&=~Fs,t&=~Ms,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),a=1<<n;e[n]=-1,t&=~a}}function lc(e){if(0!==(6&Es))throw Error(o(327));kc();var t=pt(e,0);if(0===(1&t))return nc(e,Ye()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var a=ht(e);0!==a&&(t=a,n=rc(e,a))}if(1===n)throw n=Ls,uc(e,0),ic(e,t),nc(e,Ye()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,_s,Gs),nc(e,Ye()),null}function sc(e,t){var n=Es;Es|=1;try{return e(t)}finally{0===(Es=n)&&(Bs=Ye()+500,_r&&Gr())}}function cc(e){null!==Js&&0===Js.tag&&0===(6&Es)&&kc();var t=Es;Es|=1;var n=Cs.transition,a=bt;try{if(Cs.transition=null,bt=1,e)return e()}finally{bt=a,Cs.transition=n,0===(6&(Es=t))&&Gr()}}function dc(){As=Ps.current,Nr(Ps)}function uc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Ds)for(n=Ds.return;null!==n;){var a=n;switch(to(a),a.tag){case 1:null!==(a=a.type.childContextTypes)&&void 0!==a&&Or();break;case 3:Yo(),Nr(Dr),Nr(Ir),ai();break;case 5:Zo(a);break;case 4:Yo();break;case 13:case 19:Nr(ei);break;case 10:Io(a.type._context);break;case 22:case 23:dc()}n=n.return}if(Is=e,Ds=e=Pc(e.current,null),Ts=As=t,Os=0,Ls=null,Fs=Ms=Rs=0,_s=Us=null,null!==Po){for(t=0;t<Po.length;t++)if(null!==(a=(n=Po[t]).interleaved)){n.interleaved=null;var r=a.next,o=n.pending;if(null!==o){var i=o.next;o.next=r,a.next=i}n.pending=a}Po=null}return e}function pc(e,t){for(;;){var n=Ds;try{if(Eo(),ri.current=Xi,di){for(var a=li.memoizedState;null!==a;){var r=a.queue;null!==r&&(r.pending=null),a=a.next}di=!1}if(ii=0,ci=si=li=null,ui=!1,pi=0,Ns.current=null,null===n||null===n.return){Os=1,Ls=t,Ds=null;break}e:{var i=e,l=n.return,s=n,c=t;if(t=Ts,s.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=s,p=u.tag;if(0===(1&u.mode)&&(0===p||11===p||15===p)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=fl(l);if(null!==h){h.flags&=-257,vl(h,l,s,0,t),1&h.mode&&gl(i,d,t),c=d;var g=(t=h).updateQueue;if(null===g){var f=new Set;f.add(c),t.updateQueue=f}else g.add(c);break e}if(0===(1&t)){gl(i,d,t),hc();break e}c=Error(o(426))}else if(ro&&1&s.mode){var v=fl(l);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vl(v,l,s,0,t),go(cl(c,s));break e}}i=c=cl(c,s),4!==Os&&(Os=2),null===Us?Us=[i]:Us.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Go(i,ml(0,c,t));break e;case 1:s=c;var y=i.type,b=i.stateNode;if(0===(128&i.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===qs||!qs.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,Go(i,hl(i,s,t));break e}}i=i.return}while(null!==i)}bc(n)}catch(x){t=x,Ds===n&&null!==n&&(Ds=n=n.return);continue}break}}function mc(){var e=Ss.current;return Ss.current=Xi,null===e?Xi:e}function hc(){0!==Os&&3!==Os&&2!==Os||(Os=4),null===Is||0===(268435455&Rs)&&0===(268435455&Ms)||ic(Is,Ts)}function gc(e,t){var n=Es;Es|=2;var a=mc();for(Is===e&&Ts===t||(Gs=null,uc(e,t));;)try{fc();break}catch(r){pc(e,r)}if(Eo(),Es=n,Ss.current=a,null!==Ds)throw Error(o(261));return Is=null,Ts=0,Os}function fc(){for(;null!==Ds;)yc(Ds)}function vc(){for(;null!==Ds&&!Qe();)yc(Ds)}function yc(e){var t=js(e.alternate,e,As);e.memoizedProps=e.pendingProps,null===t?bc(e):Ds=t,Ns.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Kl(n,t,As)))return void(Ds=n)}else{if(null!==(n=Jl(n,t)))return n.flags&=32767,void(Ds=n);if(null===e)return Os=6,void(Ds=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ds=t);Ds=t=e}while(null!==t);0===Os&&(Os=5)}function xc(e,t,n){var a=bt,r=Cs.transition;try{Cs.transition=null,bt=1,function(e,t,n,a){do{kc()}while(null!==Js);if(0!==(6&Es))throw Error(o(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-it(n),o=1<<r;t[r]=0,a[r]=-1,e[r]=-1,n&=~o}}(e,i),e===Is&&(Ds=Is=null,Ts=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ks||(Ks=!0,Ic(tt,function(){return kc(),null})),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=Cs.transition,Cs.transition=null;var l=bt;bt=1;var s=Es;Es|=4,Ns.current=null,function(e,t){if(er=Vt,ma(e=pa())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(a&&0!==a.rangeCount){n=a.anchorNode;var r=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{n.nodeType,i.nodeType}catch(k){n=null;break e}var l=0,s=-1,c=-1,d=0,u=0,p=e,m=null;t:for(;;){for(var h;p!==n||0!==r&&3!==p.nodeType||(s=l+r),p!==i||0!==a&&3!==p.nodeType||(c=l+a),3===p.nodeType&&(l+=p.nodeValue.length),null!==(h=p.firstChild);)m=p,p=h;for(;;){if(p===e)break t;if(m===n&&++d===r&&(s=l),m===i&&++u===a&&(c=l),null!==(h=p.nextSibling))break;m=(p=m).parentNode}p=h}n=-1===s||-1===c?null:{start:s,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Vt=!1,Yl=t;null!==Yl;)if(e=(t=Yl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Yl=e;else for(;null!==Yl;){t=Yl;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var f=g.memoizedProps,v=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?f:nl(t.type,f),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(o(163))}}catch(k){wc(t,t.return,k)}if(null!==(e=t.sibling)){e.return=t.return,Yl=e;break}Yl=t.return}g=es,es=!1}(e,n),gs(n,e),ha(tr),Vt=!!er,tr=er=null,e.current=n,vs(n,e,r),$e(),Es=s,bt=l,Cs.transition=i}else e.current=n;if(Ks&&(Ks=!1,Js=e,Hs=r),i=e.pendingLanes,0===i&&(qs=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nc(e,Ye()),null!==t)for(a=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],a(r.value,{componentStack:r.stack,digest:r.digest});if(Ws)throw Ws=!1,e=Vs,Vs=null,e;0!==(1&Hs)&&0!==e.tag&&kc(),i=e.pendingLanes,0!==(1&i)?e===$s?Qs++:(Qs=0,$s=e):Qs=0,Gr()}(e,t,n,a)}finally{Cs.transition=r,bt=a}return null}function kc(){if(null!==Js){var e=xt(Hs),t=Cs.transition,n=bt;try{if(Cs.transition=null,bt=16>e?16:e,null===Js)var a=!1;else{if(e=Js,Js=null,Hs=0,0!==(6&Es))throw Error(o(331));var r=Es;for(Es|=4,Yl=e.current;null!==Yl;){var i=Yl,l=i.child;if(0!==(16&Yl.flags)){var s=i.deletions;if(null!==s){for(var c=0;c<s.length;c++){var d=s[c];for(Yl=d;null!==Yl;){var u=Yl;switch(u.tag){case 0:case 11:case 15:ts(8,u,i)}var p=u.child;if(null!==p)p.return=u,Yl=p;else for(;null!==Yl;){var m=(u=Yl).sibling,h=u.return;if(rs(u),u===d){Yl=null;break}if(null!==m){m.return=h,Yl=m;break}Yl=h}}}var g=i.alternate;if(null!==g){var f=g.child;if(null!==f){g.child=null;do{var v=f.sibling;f.sibling=null,f=v}while(null!==f)}}Yl=i}}if(0!==(2064&i.subtreeFlags)&&null!==l)l.return=i,Yl=l;else e:for(;null!==Yl;){if(0!==(2048&(i=Yl).flags))switch(i.tag){case 0:case 11:case 15:ts(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,Yl=y;break e}Yl=i.return}}var b=e.current;for(Yl=b;null!==Yl;){var x=(l=Yl).child;if(0!==(2064&l.subtreeFlags)&&null!==x)x.return=l,Yl=x;else e:for(l=b;null!==Yl;){if(0!==(2048&(s=Yl).flags))try{switch(s.tag){case 0:case 11:case 15:ns(9,s)}}catch(j){wc(s,s.return,j)}if(s===l){Yl=null;break e}var k=s.sibling;if(null!==k){k.return=s.return,Yl=k;break e}Yl=s.return}}if(Es=r,Gr(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(rt,e)}catch(j){}a=!0}return a}finally{bt=n,Cs.transition=t}}return!1}function jc(e,t,n){e=zo(e,t=ml(0,t=cl(n,t),1),1),t=Zs(),null!==e&&(vt(e,1,t),nc(e,t))}function wc(e,t,n){if(3===e.tag)jc(e,e,n);else for(;null!==t;){if(3===t.tag){jc(t,e,n);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===qs||!qs.has(a))){t=zo(t,e=hl(t,e=cl(n,e),1),1),e=Zs(),null!==t&&(vt(t,1,e),nc(t,e));break}}t=t.return}}function Sc(e,t,n){var a=e.pingCache;null!==a&&a.delete(t),t=Zs(),e.pingedLanes|=e.suspendedLanes&n,Is===e&&(Ts&n)===n&&(4===Os||3===Os&&(130023424&Ts)===Ts&&500>Ye()-zs?uc(e,0):Fs|=n),nc(e,t)}function Nc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=Zs();null!==(e=Ro(e,t))&&(vt(e,t,n),nc(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Nc(e,n)}function Ec(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(o(314))}null!==a&&a.delete(t),Nc(e,n)}function Ic(e,t){return Je(e,t)}function Dc(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tc(e,t,n,a){return new Dc(e,t,n,a)}function Ac(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Tc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,a,r,i){var l=2;if(a=e,"function"===typeof e)Ac(e)&&(l=1);else if("string"===typeof e)l=5;else e:switch(e){case w:return Lc(n.children,r,i,t);case S:l=8,r|=8;break;case N:return(e=Tc(12,n,t,2|r)).elementType=N,e.lanes=i,e;case D:return(e=Tc(13,n,t,r)).elementType=D,e.lanes=i,e;case T:return(e=Tc(19,n,t,r)).elementType=T,e.lanes=i,e;case O:return Rc(n,r,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:l=10;break e;case E:l=9;break e;case I:l=11;break e;case A:l=14;break e;case P:l=16,a=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Tc(l,n,t,r)).elementType=e,t.type=a,t.lanes=i,t}function Lc(e,t,n,a){return(e=Tc(7,e,a,t)).lanes=n,e}function Rc(e,t,n,a){return(e=Tc(22,e,a,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Mc(e,t,n){return(e=Tc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Tc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,a,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ft(0),this.expirationTimes=ft(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ft(0),this.identifierPrefix=a,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function _c(e,t,n,a,r,o,i,l,s){return e=new Uc(e,t,n,l,s),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Tc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:a,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fo(o),e}function zc(e){if(!e)return Er;e:{if(Ge(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Pr(n))return Rr(e,n,t)}return t}function Bc(e,t,n,a,r,o,i,l,s){return(e=_c(n,a,!0,e,0,o,0,l,s)).context=zc(null),n=e.current,(o=_o(a=Zs(),r=ec(n))).callback=void 0!==t&&null!==t?t:null,zo(n,o,r),e.current.lanes=r,vt(e,r,a),nc(e,a),e}function Gc(e,t,n,a){var r=t.current,o=Zs(),i=ec(r);return n=zc(n),null===t.context?t.context=n:t.pendingContext=n,(t=_o(o,i)).payload={element:e},null!==(a=void 0===a?null:a)&&(t.callback=a),null!==(e=zo(r,t,i))&&(tc(e,r,i,o),Bo(e,r,i)),i}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}js=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Dr.current)bl=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bl=!1,function(e,t,n){switch(t.tag){case 3:Dl(t),ho();break;case 5:Xo(t);break;case 1:Pr(t.type)&&Mr(t);break;case 4:$o(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,r=t.memoizedProps.value;Cr(wo,a._currentValue),a._currentValue=r;break;case 13:if(null!==(a=t.memoizedState))return null!==a.dehydrated?(Cr(ei,1&ei.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ml(e,t,n):(Cr(ei,1&ei.current),null!==(e=Wl(e,t,n))?e.sibling:null);Cr(ei,1&ei.current);break;case 19:if(a=0!==(n&t.childLanes),0!==(128&e.flags)){if(a)return Bl(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Cr(ei,ei.current),a)break;return null;case 22:case 23:return t.lanes=0,Sl(e,t,n)}return Wl(e,t,n)}(e,t,n);bl=0!==(131072&e.flags)}else bl=!1,ro&&0!==(1048576&t.flags)&&Zr(t,Kr,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Gl(e,t),e=t.pendingProps;var r=Ar(t,Ir.current);To(t,n),r=fi(null,t,a,e,r,n);var i=vi();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pr(a)?(i=!0,Mr(t)):i=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Fo(t),r.updater=rl,t.stateNode=r,r._reactInternals=t,sl(t,a,e,n),t=Il(null,t,a,!0,i,n)):(t.tag=0,ro&&i&&eo(t),xl(null,t,r,n),t=t.child),t;case 16:a=t.elementType;e:{switch(Gl(e,t),e=t.pendingProps,a=(r=a._init)(a._payload),t.type=a,r=t.tag=function(e){if("function"===typeof e)return Ac(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===A)return 14}return 2}(a),e=nl(a,e),r){case 0:t=Cl(null,t,a,e,n);break e;case 1:t=El(null,t,a,e,n);break e;case 11:t=kl(null,t,a,e,n);break e;case 14:t=jl(null,t,a,nl(a.type,e),n);break e}throw Error(o(306,a,""))}return t;case 0:return a=t.type,r=t.pendingProps,Cl(e,t,a,r=t.elementType===a?r:nl(a,r),n);case 1:return a=t.type,r=t.pendingProps,El(e,t,a,r=t.elementType===a?r:nl(a,r),n);case 3:e:{if(Dl(t),null===e)throw Error(o(387));a=t.pendingProps,r=(i=t.memoizedState).element,Uo(e,t),Wo(t,a,null,n);var l=t.memoizedState;if(a=l.element,i.isDehydrated){if(i={element:a,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Tl(e,t,a,n,r=cl(Error(o(423)),t));break e}if(a!==r){t=Tl(e,t,a,n,r=cl(Error(o(424)),t));break e}for(ao=cr(t.stateNode.containerInfo.firstChild),no=t,ro=!0,oo=null,n=jo(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ho(),a===r){t=Wl(e,t,n);break e}xl(e,t,a,n)}t=t.child}return t;case 5:return Xo(t),null===e&&co(t),a=t.type,r=t.pendingProps,i=null!==e?e.memoizedProps:null,l=r.children,nr(a,r)?l=null:null!==i&&nr(a,i)&&(t.flags|=32),Nl(e,t),xl(e,t,l,n),t.child;case 6:return null===e&&co(t),null;case 13:return Ml(e,t,n);case 4:return $o(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=ko(t,null,a,n):xl(e,t,a,n),t.child;case 11:return a=t.type,r=t.pendingProps,kl(e,t,a,r=t.elementType===a?r:nl(a,r),n);case 7:return xl(e,t,t.pendingProps,n),t.child;case 8:case 12:return xl(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(a=t.type._context,r=t.pendingProps,i=t.memoizedProps,l=r.value,Cr(wo,a._currentValue),a._currentValue=l,null!==i)if(la(i.value,l)){if(i.children===r.children&&!Dr.current){t=Wl(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var s=i.dependencies;if(null!==s){l=i.child;for(var c=s.firstContext;null!==c;){if(c.context===a){if(1===i.tag){(c=_o(-1,n&-n)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),Do(i.return,n,t),s.lanes|=n;break}c=c.next}}else if(10===i.tag)l=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(l=i.return))throw Error(o(341));l.lanes|=n,null!==(s=l.alternate)&&(s.lanes|=n),Do(l,n,t),l=i.sibling}else l=i.child;if(null!==l)l.return=i;else for(l=i;null!==l;){if(l===t){l=null;break}if(null!==(i=l.sibling)){i.return=l.return,l=i;break}l=l.return}i=l}xl(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,a=t.pendingProps.children,To(t,n),a=a(r=Ao(r)),t.flags|=1,xl(e,t,a,n),t.child;case 14:return r=nl(a=t.type,t.pendingProps),jl(e,t,a,r=nl(a.type,r),n);case 15:return wl(e,t,t.type,t.pendingProps,n);case 17:return a=t.type,r=t.pendingProps,r=t.elementType===a?r:nl(a,r),Gl(e,t),t.tag=1,Pr(a)?(e=!0,Mr(t)):e=!1,To(t,n),il(t,a,r),sl(t,a,r,n),Il(null,t,a,!0,e,n);case 19:return Bl(e,t,n);case 22:return Sl(e,t,n)}throw Error(o(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Jc(e){this._internalRoot=e}function Hc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Yc(){}function Xc(e,t,n,a,r){var o=n._reactRootContainer;if(o){var i=o;if("function"===typeof r){var l=r;r=function(){var e=Wc(i);l.call(e)}}Gc(t,i,e,r)}else i=function(e,t,n,a,r){if(r){if("function"===typeof a){var o=a;a=function(){var e=Wc(i);o.call(e)}}var i=Bc(t,a,e,0,null,!1,0,"",Yc);return e._reactRootContainer=i,e[hr]=i.current,Ga(8===e.nodeType?e.parentNode:e),cc(),i}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof a){var l=a;a=function(){var e=Wc(s);l.call(e)}}var s=_c(e,0,!1,null,0,!1,0,"",Yc);return e._reactRootContainer=s,e[hr]=s.current,Ga(8===e.nodeType?e.parentNode:e),cc(function(){Gc(t,s,n,a)}),s}(n,t,e,r,a);return Wc(i)}Hc.prototype.render=Jc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Gc(e,t,null,null)},Hc.prototype.unmount=Jc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cc(function(){Gc(null,e,null,null)}),t[hr]=null}},Hc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Ft(e)}},kt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(yt(t,1|n),nc(t,Ye()),0===(6&Es)&&(Bs=Ye()+500,Gr()))}break;case 13:cc(function(){var t=Ro(e,1);if(null!==t){var n=Zs();tc(t,e,1,n)}}),qc(e,1)}},jt=function(e){if(13===e.tag){var t=Ro(e,134217728);if(null!==t)tc(t,e,134217728,Zs());qc(e,134217728)}},wt=function(e){if(13===e.tag){var t=ec(e),n=Ro(e,t);if(null!==n)tc(n,e,t,Zs());qc(e,t)}},St=function(){return bt},Nt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},je=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var r=kr(a);if(!r)throw Error(o(90));J(a),X(a,r)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=sc,De=cc;var Zc={usingClientEntryPoint:!1,Events:[br,xr,kr,Ce,Ee,sc]},ed={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},td={bundleType:ed.bundleType,version:ed.version,rendererPackageName:ed.rendererPackageName,rendererConfig:ed.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:ed.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{rt=nd.inject(td),ot=nd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(o(200));return function(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:j,key:null==a?null:""+a,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Qc(e))throw Error(o(299));var n=!1,a="",r=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=_c(e,1,!1,null,0,n,0,a,r),e[hr]=t.current,Ga(8===e.nodeType?e.parentNode:e),new Jc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return cc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(o(200));return Xc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qc(e))throw Error(o(405));var a=null!=n&&n.hydratedSources||null,r=!1,i="",l=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(l=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,r,0,i,l),e[hr]=t.current,Ga(e),a)for(e=0;e<a.length;e++)r=(r=(n=a[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Hc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(o(200));return Xc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(o(40));return!!e._reactRootContainer&&(cc(function(){Xc(null,null,e,!1,function(){e._reactRootContainer=null,e[hr]=null})}),!0)},t.unstable_batchedUpdates=sc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,a){if(!$c(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return Xc(e,t,n,!1,a)},t.version="18.3.1-next-f1338f8080-20240426"},853(e,t,n){e.exports=n(234)},950(e,t,n){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,n),o.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(a,r){if(1&r&&(a=this(a)),8&r)return a;if("object"===typeof a&&a){if(4&r&&a.__esModule)return a;if(16&r&&"function"===typeof a.then)return a}var o=Object.create(null);n.r(o);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&r&&a;("object"==typeof l||"function"==typeof l)&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach(e=>i[e]=()=>a[e]);return i.default=()=>a,n.d(o,i),o}})(),n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};n.r(a),n.d(a,{cosineSimilarity:()=>en,findTopKSimilar:()=>tn,generateBatchEmbeddings:()=>Zt,generateChecksum:()=>nn,generateEmbedding:()=>Xt,getEmbeddingDimension:()=>ln,summarizePaper:()=>rn,summarizePapersBatch:()=>on,supportsEmbeddings:()=>sn,validateOpenaiApiKey:()=>an});var r={};n.r(r),n.d(r,{generateBatchEmbeddings:()=>gn,generateEmbedding:()=>hn,getEmbeddingDimension:()=>vn,summarizePaper:()=>pn,summarizePapersBatch:()=>mn,supportsEmbeddings:()=>yn,validateGeminiApiKey:()=>fn});var o={};n.r(o),n.d(o,{generateBatchEmbeddings:()=>dr,generateEmbedding:()=>cr,getEmbeddingDimension:()=>pr,summarizePaper:()=>ir,summarizePapersBatch:()=>lr,supportsEmbeddings:()=>ur,validateClaudeApiKey:()=>sr});var i,l=n(43),s=n.t(l,2),c=n(391),d=n(950),u=n.t(d,2);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},p.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(i||(i={}));const m="popstate";function h(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function g(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function f(e,t){return{usr:e.state,key:e.key,idx:t}}function v(e,t,n,a){return void 0===n&&(n=null),p({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?b(t):t,{state:n,key:t&&t.key||a||Math.random().toString(36).substr(2,8)})}function y(e){let{pathname:t="/",search:n="",hash:a=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function b(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}function x(e,t,n,a){void 0===a&&(a={});let{window:r=document.defaultView,v5Compat:o=!1}=a,l=r.history,s=i.Pop,c=null,d=u();function u(){return(l.state||{idx:null}).idx}function g(){s=i.Pop;let e=u(),t=null==e?null:e-d;d=e,c&&c({action:s,location:x.location,delta:t})}function b(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,n="string"===typeof e?e:y(e);return n=n.replace(/ $/,"%20"),h(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==d&&(d=0,l.replaceState(p({},l.state,{idx:d}),""));let x={get action(){return s},get location(){return e(r,l)},listen(e){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(m,g),c=e,()=>{r.removeEventListener(m,g),c=null}},createHref:e=>t(r,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){s=i.Push;let a=v(x.location,e,t);n&&n(a,e),d=u()+1;let p=f(a,d),m=x.createHref(a);try{l.pushState(p,"",m)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;r.location.assign(m)}o&&c&&c({action:s,location:x.location,delta:1})},replace:function(e,t){s=i.Replace;let a=v(x.location,e,t);n&&n(a,e),d=u();let r=f(a,d),p=x.createHref(a);l.replaceState(r,"",p),o&&c&&c({action:s,location:x.location,delta:0})},go:e=>l.go(e)};return x}var k;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(k||(k={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function j(e,t,n){return void 0===n&&(n="/"),w(e,t,n,!1)}function w(e,t,n,a){let r=F(("string"===typeof t?b(t):t).pathname||"/",n);if(null==r)return null;let o=S(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(o);let i=null;for(let l=0;null==i&&l<o.length;++l){let e=M(r);i=L(o[l],e,a)}return i}function S(e,t,n,a){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===a&&(a="");let r=(e,r,o)=>{let i={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};i.relativePath.startsWith("/")&&(h(i.relativePath.startsWith(a),'Absolute route path "'+i.relativePath+'" nested under path "'+a+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(a.length));let l=q([a,i.relativePath]),s=n.concat(i);e.children&&e.children.length>0&&(h(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),S(e.children,t,s,l)),(null!=e.path||e.index)&&t.push({path:l,score:O(l,e.index),routesMeta:s})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let a of N(e.path))r(e,t,a);else r(e,t)}),t}function N(e){let t=e.split("/");if(0===t.length)return[];let[n,...a]=t,r=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===a.length)return r?[o,""]:[o];let i=N(a.join("/")),l=[];return l.push(...i.map(e=>""===e?o:[o,e].join("/"))),r&&l.push(...i),l.map(t=>e.startsWith("/")&&""===t?"/":t)}const C=/^:[\w-]+$/,E=3,I=2,D=1,T=10,A=-2,P=e=>"*"===e;function O(e,t){let n=e.split("/"),a=n.length;return n.some(P)&&(a+=A),t&&(a+=I),n.filter(e=>!P(e)).reduce((e,t)=>e+(C.test(t)?E:""===t?D:T),a)}function L(e,t,n){void 0===n&&(n=!1);let{routesMeta:a}=e,r={},o="/",i=[];for(let l=0;l<a.length;++l){let e=a[l],s=l===a.length-1,c="/"===o?t:t.slice(o.length)||"/",d=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:s},c),u=e.route;if(!d&&s&&n&&!a[a.length-1].route.index&&(d=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(r,d.params),i.push({params:r,pathname:q([o,d.pathname]),pathnameBase:K(q([o,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(o=q([o,d.pathnameBase]))}return i}function R(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);g("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let a=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(a.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(a.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let o=new RegExp(r,t?void 0:"i");return[o,a]}(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let o=r[0],i=o.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:a.reduce((e,t,n)=>{let{paramName:a,isOptional:r}=t;if("*"===a){let e=l[n]||"";i=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const s=l[n];return e[a]=r&&!s?void 0:(s||"").replace(/%2F/g,"/"),e},{}),pathname:o,pathnameBase:i,pattern:e}}function M(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return g(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function F(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&"/"!==a?null:e.slice(n)||"/"}const U=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function _(e,t){void 0===t&&(t="/");let n,{pathname:a,search:r="",hash:o=""}="string"===typeof e?b(e):e;if(a)if(i=a,U.test(i))n=a;else{if(a.includes("//")){let e=a;a=a.replace(/\/\/+/g,"/"),g(!1,"Pathnames cannot have embedded double slashes - normalizing "+e+" -> "+a)}n=a.startsWith("/")?z(a.substring(1),"/"):z(a,t)}else n=t;var i;return{pathname:n,search:J(r),hash:H(o)}}function z(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}function B(e,t,n,a){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function G(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function W(e,t){let n=G(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function V(e,t,n,a){let r;void 0===a&&(a=!1),"string"===typeof e?r=b(e):(r=p({},e),h(!r.pathname||!r.pathname.includes("?"),B("?","pathname","search",r)),h(!r.pathname||!r.pathname.includes("#"),B("#","pathname","hash",r)),h(!r.search||!r.search.includes("#"),B("#","search","hash",r)));let o,i=""===e||""===r.pathname,l=i?"/":r.pathname;if(null==l)o=n;else{let e=t.length-1;if(!a&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}o=e>=0?t[e]:"/"}let s=_(r,o),c=l&&"/"!==l&&l.endsWith("/"),d=(i||"."===l)&&n.endsWith("/");return s.pathname.endsWith("/")||!c&&!d||(s.pathname+="/"),s}const q=e=>e.join("/").replace(/\/\/+/g,"/"),K=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),J=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",H=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function Q(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const $=["post","put","patch","delete"],Y=(new Set($),["get",...$]);new Set(Y),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function X(){return X=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},X.apply(this,arguments)}const Z=l.createContext(null);const ee=l.createContext(null);const te=l.createContext(null);const ne=l.createContext(null);const ae=l.createContext({outlet:null,matches:[],isDataRoute:!1});const re=l.createContext(null);function oe(){return null!=l.useContext(ne)}function ie(){return oe()||h(!1),l.useContext(ne).location}function le(e){l.useContext(te).static||l.useLayoutEffect(e)}function se(){let{isDataRoute:e}=l.useContext(ae);return e?function(){let{router:e}=ye(fe.UseNavigateStable),t=xe(ve.UseNavigateStable),n=l.useRef(!1);return le(()=>{n.current=!0}),l.useCallback(function(a,r){void 0===r&&(r={}),n.current&&("number"===typeof a?e.navigate(a):e.navigate(a,X({fromRouteId:t},r)))},[e,t])}():function(){oe()||h(!1);let e=l.useContext(Z),{basename:t,future:n,navigator:a}=l.useContext(te),{matches:r}=l.useContext(ae),{pathname:o}=ie(),i=JSON.stringify(W(r,n.v7_relativeSplatPath)),s=l.useRef(!1);return le(()=>{s.current=!0}),l.useCallback(function(n,r){if(void 0===r&&(r={}),!s.current)return;if("number"===typeof n)return void a.go(n);let l=V(n,JSON.parse(i),o,"path"===r.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:q([t,l.pathname])),(r.replace?a.replace:a.push)(l,r.state,r)},[t,a,i,o,e])}()}function ce(e,t){let{relative:n}=void 0===t?{}:t,{future:a}=l.useContext(te),{matches:r}=l.useContext(ae),{pathname:o}=ie(),i=JSON.stringify(W(r,a.v7_relativeSplatPath));return l.useMemo(()=>V(e,JSON.parse(i),o,"path"===n),[e,i,o,n])}function de(e,t,n,a){oe()||h(!1);let{navigator:r}=l.useContext(te),{matches:o}=l.useContext(ae),s=o[o.length-1],c=s?s.params:{},d=(s&&s.pathname,s?s.pathnameBase:"/");s&&s.route;let u,p=ie();if(t){var m;let e="string"===typeof t?b(t):t;"/"===d||(null==(m=e.pathname)?void 0:m.startsWith(d))||h(!1),u=e}else u=p;let g=u.pathname||"/",f=g;if("/"!==d){let e=d.replace(/^\//,"").split("/");f="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let v=j(e,{pathname:f});let y=ge(v&&v.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:q([d,r.encodeLocation?r.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:q([d,r.encodeLocation?r.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,n,a);return t&&y?l.createElement(ne.Provider,{value:{location:X({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:i.Pop}},y):y}function ue(){let e=function(){var e;let t=l.useContext(re),n=be(ve.UseRouteError),a=xe(ve.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[a]}(),t=Q(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:a};return l.createElement(l.Fragment,null,l.createElement("h2",null,"Unexpected Application Error!"),l.createElement("h3",{style:{fontStyle:"italic"}},t),n?l.createElement("pre",{style:r},n):null,null)}const pe=l.createElement(ue,null);class me extends l.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?l.createElement(ae.Provider,{value:this.props.routeContext},l.createElement(re.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function he(e){let{routeContext:t,match:n,children:a}=e,r=l.useContext(Z);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),l.createElement(ae.Provider,{value:t},a)}function ge(e,t,n,a){var r;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===a&&(a=null),null==e){var o;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(o=a)&&o.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let i=e,s=null==(r=n)?void 0:r.errors;if(null!=s){let e=i.findIndex(e=>e.route.id&&void 0!==(null==s?void 0:s[e.route.id]));e>=0||h(!1),i=i.slice(0,Math.min(i.length,e+1))}let c=!1,d=-1;if(n&&a&&a.v7_partialHydration)for(let l=0;l<i.length;l++){let e=i[l];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=l),e.route.id){let{loaderData:t,errors:a}=n,r=e.route.loader&&void 0===t[e.route.id]&&(!a||void 0===a[e.route.id]);if(e.route.lazy||r){c=!0,i=d>=0?i.slice(0,d+1):[i[0]];break}}}return i.reduceRight((e,a,r)=>{let o,u=!1,p=null,m=null;var h;n&&(o=s&&a.route.id?s[a.route.id]:void 0,p=a.route.errorElement||pe,c&&(d<0&&0===r?(h="route-fallback",!1||ke[h]||(ke[h]=!0),u=!0,m=null):d===r&&(u=!0,m=a.route.hydrateFallbackElement||null)));let g=t.concat(i.slice(0,r+1)),f=()=>{let t;return t=o?p:u?m:a.route.Component?l.createElement(a.route.Component,null):a.route.element?a.route.element:e,l.createElement(he,{match:a,routeContext:{outlet:e,matches:g,isDataRoute:null!=n},children:t})};return n&&(a.route.ErrorBoundary||a.route.errorElement||0===r)?l.createElement(me,{location:n.location,revalidation:n.revalidation,component:p,error:o,children:f(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):f()},null)}var fe=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(fe||{}),ve=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ve||{});function ye(e){let t=l.useContext(Z);return t||h(!1),t}function be(e){let t=l.useContext(ee);return t||h(!1),t}function xe(e){let t=function(){let e=l.useContext(ae);return e||h(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||h(!1),n.route.id}const ke={};function je(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}s.startTransition;function we(e){h(!1)}function Se(e){let{basename:t="/",children:n=null,location:a,navigationType:r=i.Pop,navigator:o,static:s=!1,future:c}=e;oe()&&h(!1);let d=t.replace(/^\/*/,"/"),u=l.useMemo(()=>({basename:d,navigator:o,static:s,future:X({v7_relativeSplatPath:!1},c)}),[d,c,o,s]);"string"===typeof a&&(a=b(a));let{pathname:p="/",search:m="",hash:g="",state:f=null,key:v="default"}=a,y=l.useMemo(()=>{let e=F(p,d);return null==e?null:{location:{pathname:e,search:m,hash:g,state:f,key:v},navigationType:r}},[d,p,m,g,f,v,r]);return null==y?null:l.createElement(te.Provider,{value:u},l.createElement(ne.Provider,{children:n,value:y}))}function Ne(e){let{children:t,location:n}=e;return de(Ce(t),n)}new Promise(()=>{});l.Component;function Ce(e,t){void 0===t&&(t=[]);let n=[];return l.Children.forEach(e,(e,a)=>{if(!l.isValidElement(e))return;let r=[...t,a];if(e.type===l.Fragment)return void n.push.apply(n,Ce(e.props.children,r));e.type!==we&&h(!1),e.props.index&&e.props.children&&h(!1);let o={id:e.props.id||r.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=Ce(e.props.children,r)),n.push(o)}),n}function Ee(){return Ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ee.apply(this,arguments)}function Ie(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const De=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(Fr){}new Map;const Te=s.startTransition;u.flushSync,s.useId;function Ae(e){let{basename:t,children:n,future:a,window:r}=e,o=l.useRef();var i;null==o.current&&(o.current=(void 0===(i={window:r,v5Compat:!0})&&(i={}),x(function(e,t){let{pathname:n="/",search:a="",hash:r=""}=b(e.location.hash.substr(1));return n.startsWith("/")||n.startsWith(".")||(n="/"+n),v("",{pathname:n,search:a,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){let n=e.document.querySelector("base"),a="";if(n&&n.getAttribute("href")){let t=e.location.href,n=t.indexOf("#");a=-1===n?t:t.slice(0,n)}return a+"#"+("string"===typeof t?t:y(t))},function(e,t){g("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")},i)));let s=o.current,[c,d]=l.useState({action:s.action,location:s.location}),{v7_startTransition:u}=a||{},p=l.useCallback(e=>{u&&Te?Te(()=>d(e)):d(e)},[d,u]);return l.useLayoutEffect(()=>s.listen(p),[s,p]),l.useEffect(()=>je(a),[a]),l.createElement(Se,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:s,future:a})}const Pe="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Oe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Le=l.forwardRef(function(e,t){let n,{onClick:a,relative:r,reloadDocument:o,replace:i,state:s,target:c,to:d,preventScrollReset:u,viewTransition:p}=e,m=Ie(e,De),{basename:g}=l.useContext(te),f=!1;if("string"===typeof d&&Oe.test(d)&&(n=d,Pe))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),n=F(t.pathname,g);t.origin===e.origin&&null!=n?d=n+t.search+t.hash:f=!0}catch(Fr){}let v=function(e,t){let{relative:n}=void 0===t?{}:t;oe()||h(!1);let{basename:a,navigator:r}=l.useContext(te),{hash:o,pathname:i,search:s}=ce(e,{relative:n}),c=i;return"/"!==a&&(c="/"===i?a:q([a,i])),r.createHref({pathname:c,search:s,hash:o})}(d,{relative:r}),b=function(e,t){let{target:n,replace:a,state:r,preventScrollReset:o,relative:i,viewTransition:s}=void 0===t?{}:t,c=se(),d=ie(),u=ce(e,{relative:i});return l.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==a?a:y(d)===y(u);c(e,{replace:n,state:r,preventScrollReset:o,relative:i,viewTransition:s})}},[d,c,u,a,r,n,e,o,i,s])}(d,{replace:i,state:s,target:c,preventScrollReset:u,relative:r,viewTransition:p});return l.createElement("a",Ee({},m,{href:n||v,onClick:f||o?a:function(e){a&&a(e),e.defaultPrevented||b(e)},ref:t,target:c}))});var Re,Me;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Re||(Re={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Me||(Me={}));const Fe=e=>{const t=new Date;return t.setDate(t.getDate()+e),t.toISOString()},Ue={cart:[{id:"ref-cart-1",pmid:"32433953",doi:"10.1038/s41591-020-0914-7",title:"Long-term follow-up of CD19 CAR T-cell therapy in children and young adults with B-ALL",authors:"Maude SL, Frey N, Shaw PA, et al.",journal:"Nature Medicine",year:"2020",volume:"26",pages:"1587-1593",abstract:"Chimeric antigen receptor (CAR) T-cell therapy targeting CD19 has shown remarkable efficacy in patients with relapsed or refractory B-cell acute lymphoblastic leukemia (B-ALL).",notes:"Key reference for CAR-T persistence data. Important for Aim 2 comparison.",tags:["CAR-T","persistence","clinical"],dateAdded:Fe(-30)},{id:"ref-cart-2",pmid:"35396580",doi:"10.1016/j.cell.2022.03.023",title:"4-1BB costimulation induces T cell mitochondrial function and biogenesis enabling cancer immunotherapy",authors:"Kawalekar OU, O'Connor RS, Fraietta JA, et al.",journal:"Cell",year:"2022",volume:"185",pages:"2252-2270",abstract:"We show that 4-1BB costimulation enhances mitochondrial biogenesis in CAR T cells, leading to improved persistence and anti-tumor function.",notes:"Supports our 4-1BB CAR design hypothesis. Review for methods.",tags:["4-1BB","metabolism","signaling"],dateAdded:Fe(-15)},{id:"ref-cart-3",pmid:"33504987",doi:"10.1172/JCI141256",title:"IL-15 promotes CAR T cell expansion and memory formation in vivo",authors:"Hurton LV, Singh H, Najjar AM, et al.",journal:"Journal of Clinical Investigation",year:"2021",volume:"131",pages:"e141256",abstract:"IL-15 transpresentation by engineered CAR T cells enhances their persistence and anti-tumor efficacy.",notes:"Critical for IL-15 supplementation approach. Compare dosing regimens.",tags:["IL-15","cytokine","expansion"],dateAdded:Fe(-7)}],crispr:[{id:"ref-crispr-1",pmid:"32753547",doi:"10.1038/s41586-020-2629-y",title:"Mapping the genetic landscape of human cells reveals novel regulators of cancer dependencies",authors:"Tsherniak A, Vazquez F, Montgomery PG, et al.",journal:"Nature",year:"2020",volume:"596",pages:"517-522",abstract:"We performed genome-wide CRISPR screens across hundreds of cancer cell lines to identify genetic dependencies.",notes:"Reference for screen design and analysis pipeline. Use DepMap data.",tags:["CRISPR screen","DepMap","methods"],dateAdded:Fe(-45)},{id:"ref-crispr-2",pmid:"31511697",doi:"10.1038/s41596-019-0209-6",title:"MAGeCK enables robust identification of essential genes from genome-scale CRISPR/Cas9 knockout screens",authors:"Li W, Xu H, Xiao T, et al.",journal:"Nature Protocols",year:"2019",volume:"14",pages:"2939-2962",abstract:"MAGeCK is a computational tool to identify positively and negatively selected sgRNAs from CRISPR screens.",notes:"Primary analysis tool for our screen. Follow protocol exactly.",tags:["MAGeCK","bioinformatics","analysis"],dateAdded:Fe(-20)}],tme:[{id:"ref-tme-1",pmid:"35512530",doi:"10.1038/s41586-022-04718-6",title:"Spatial transcriptomics reveals immune cell infiltration patterns in melanoma",authors:"Thrane K, Eriksson H, Maaskola J, et al.",journal:"Nature",year:"2022",volume:"612",pages:"89-97",abstract:"We applied spatial transcriptomics to melanoma samples to characterize the tumor immune microenvironment.",notes:"Key reference for spatial analysis approach. Compare methods.",tags:["spatial","melanoma","immune"],dateAdded:Fe(-25)},{id:"ref-tme-2",pmid:"34497389",doi:"10.1016/j.cell.2021.08.020",title:"CODEX multiplexed tissue imaging reveals immune-stromal interactions predicting immunotherapy response",authors:"Black S, Phillips D, Hickey JW, et al.",journal:"Cell",year:"2021",volume:"184",pages:"4988-5002",abstract:"CODEX imaging reveals spatial relationships between immune and stromal cells in tumors.",notes:"Reference for CODEX protocol and spatial analysis metrics.",tags:["CODEX","spatial","immunotherapy"],dateAdded:Fe(-12)}],scrna:[{id:"ref-scrna-1",pmid:"31455834",doi:"10.1016/j.cell.2019.07.036",title:"Single-cell RNA sequencing reveals the cellular hierarchy of human AML",authors:"van Galen P, Hovestadt V, Wadsworth II MH, et al.",journal:"Cell",year:"2019",volume:"176",pages:"1265-1281",abstract:"We generated a single-cell atlas of AML revealing cellular heterogeneity and leukemic stem cell signatures.",notes:"Primary reference dataset for integration. Use as benchmark.",tags:["AML","scRNA-seq","atlas"],dateAdded:Fe(-60)},{id:"ref-scrna-2",pmid:"33176164",doi:"10.1038/s41587-020-00744-z",title:"Scanpy: large-scale single-cell gene expression data analysis",authors:"Wolf FA, Angerer P, Theis FJ",journal:"Nature Methods",year:"2021",volume:"15",pages:"818-825",abstract:"Scanpy is a scalable toolkit for analyzing single-cell gene expression data.",notes:"Primary analysis framework. Review tutorials for best practices.",tags:["Scanpy","methods","software"],dateAdded:Fe(-40)},{id:"ref-scrna-3",pmid:"34385701",doi:"10.1182/blood.2021011426",title:"Therapy-resistant leukemic stem cells defined by single-cell RNA sequencing",authors:"Pei S, Pollyea DA, Jordan CT, et al.",journal:"Blood",year:"2021",volume:"138",pages:"1674-1688",abstract:"scRNA-seq identifies therapy-resistant LSC populations with distinct gene expression profiles.",notes:"Key paper for relapse signature genes. Compare our results.",tags:["LSC","resistance","signature"],dateAdded:Fe(-18)}]},_e={cart:[{id:"prot-cart-1",title:"Lentiviral CAR-T Transduction Protocol",content:"## Lentiviral CAR-T Cell Generation\n\n### Materials Required\n- Lentivirus (CAR construct, titer >1x10^8 TU/mL)\n- CD3+ T-cells (freshly isolated or thawed)\n- X-VIVO 15 media\n- Human AB serum (5%)\n- IL-2 (100 U/mL)\n- CD3/CD28 Dynabeads\n- RetroNectin-coated plates\n- Polybrene (8 \xb5g/mL)\n\n### Day 0: T-cell Activation\n1. Thaw T-cells and rest for 2 hours at 37\xb0C\n2. Count viable cells (target >90% viability)\n3. Resuspend at 1x10^6 cells/mL in complete media\n4. Add CD3/CD28 beads at 1:1 ratio\n5. Culture overnight at 37\xb0C, 5% CO2\n\n### Day 1: Transduction\n1. Prepare RetroNectin plates (20 \xb5g/mL, overnight at 4\xb0C)\n2. Wash plates 2x with PBS\n3. Add lentivirus at MOI 10-20\n4. Centrifuge at 2000g for 2 hours at 32\xb0C\n5. Remove supernatant, add activated T-cells\n6. Add polybrene to 8 \xb5g/mL\n7. Spinoculate at 1000g for 90 min at 32\xb0C\n\n### Day 2-14: Expansion\n1. Refresh media every 2-3 days\n2. Maintain cell density at 0.5-1x10^6/mL\n3. Remove beads on Day 6\n4. Check CAR expression by flow on Day 5\n\n### Quality Control\n- Viability >80%\n- CAR expression >30%\n- CD4:CD8 ratio documented",createdAt:Fe(-30),updatedAt:Fe(-10),tags:["transduction","CAR-T","lentivirus"]},{id:"prot-cart-2",title:"T-cell Exhaustion Flow Cytometry Panel",content:"## Exhaustion Marker Flow Cytometry\n\n### Antibody Panel\n| Marker | Fluorochrome | Clone | Dilution |\n|--------|--------------|-------|----------|\n| CD3 | BV421 | UCHT1 | 1:100 |\n| CD4 | BV605 | RPA-T4 | 1:200 |\n| CD8 | BV785 | SK1 | 1:100 |\n| PD-1 | PE | EH12.2H7 | 1:50 |\n| TIM-3 | APC | F38-2E2 | 1:50 |\n| LAG-3 | PE-Cy7 | 11C3C65 | 1:50 |\n| TIGIT | PerCP-Cy5.5 | A15153G | 1:100 |\n| CAR | FITC | Protein L | 1:100 |\n\n### Staining Protocol\n1. Harvest 1x10^6 cells per sample\n2. Wash with FACS buffer (PBS + 2% FBS)\n3. Block Fc receptors (Human TruStain FcX, 10 min)\n4. Add antibody cocktail, incubate 30 min at 4\xb0C\n5. Wash 2x with FACS buffer\n6. Fix with 2% PFA if needed\n7. Acquire on flow cytometer within 2 hours\n\n### Gating Strategy\n1. FSC-A vs SSC-A \u2192 Lymphocytes\n2. FSC-A vs FSC-H \u2192 Singlets\n3. CD3+ \u2192 T-cells\n4. CD4+ or CD8+ \u2192 Subsets\n5. CAR+ \u2192 Transduced cells",createdAt:Fe(-15),updatedAt:Fe(-15),tags:["flow cytometry","exhaustion","panel"]}],crispr:[{id:"prot-crispr-1",title:"Genome-wide CRISPR Screen Protocol",content:"## Pooled CRISPR Knockout Screen\n\n### Library Information\n- Brunello library (77,441 sgRNAs)\n- 4 sgRNAs per gene\n- Coverage: 500x minimum\n\n### Cell Preparation\n1. Expand Cas9-stable cells to 100x10^6\n2. Verify Cas9 activity with test sgRNA\n3. Prepare for lentiviral infection\n\n### Library Transduction\n1. Infect at MOI 0.3 (30% transduction)\n2. Use enough cells for 500x coverage\n3. Spinoculate at 1000g, 2 hours, 32\xb0C\n4. Rest overnight, add puromycin (2 \xb5g/mL)\n5. Select for 3 days\n\n### Screen Timeline\n- Day 0: Library infection\n- Day 1: Begin puromycin selection\n- Day 4: End selection, split cells\n- Day 5: Begin drug treatment (if applicable)\n- Day 14: Harvest cells for gDNA\n\n### Genomic DNA Extraction\n1. Pellet 30x10^6 cells\n2. Lyse with Buffer AL + Proteinase K\n3. Extract with phenol:chloroform\n4. Precipitate with isopropanol\n5. Resuspend in TE buffer\n\n### PCR Amplification\n1. Use 10 \xb5g gDNA per reaction\n2. Run 23 cycles with Herculase II\n3. Pool reactions, purify with beads\n4. Index with Illumina adapters",createdAt:Fe(-45),updatedAt:Fe(-20),tags:["CRISPR","screen","Brunello"]}],tme:[{id:"prot-tme-1",title:"CODEX Multiplexed Imaging Protocol",content:"## CODEX Tissue Imaging\n\n### Tissue Preparation\n1. Cut 5 \xb5m FFPE sections onto poly-L-lysine slides\n2. Bake at 60\xb0C for 1 hour\n3. Deparaffinize: Xylene (3x5 min)\n4. Rehydrate: EtOH gradient to water\n5. Antigen retrieval: Citrate buffer, pH 6.0, 20 min\n\n### Antibody Conjugation\n1. Conjugate antibodies to CODEX barcodes\n2. Verify conjugation by dot blot\n3. Titrate on positive control tissue\n\n### Staining\n1. Block with CODEX blocking buffer (30 min)\n2. Apply antibody cocktail (overnight, 4\xb0C)\n3. Wash 3x with CODEX buffer\n4. Fix with 1.6% PFA (10 min)\n5. Post-fix with ice-cold methanol (5 min)\n\n### Imaging Cycles\n1. Mount tissue in CODEX buffer\n2. Add fluorescent reporters\n3. Image all cycles (3-channel per cycle)\n4. Strip reporters between cycles\n5. Repeat for all antibody cycles\n\n### Analysis\n1. Register images across cycles\n2. Segment cells (CODEX Processor)\n3. Extract single-cell intensities\n4. Phenotype using clustering",createdAt:Fe(-20),updatedAt:Fe(-8),tags:["CODEX","imaging","spatial"]}],scrna:[{id:"prot-scrna-1",title:"10x Chromium scRNA-seq Protocol",content:"## Single-Cell RNA Sequencing (10x Genomics)\n\n### Sample Requirements\n- Single-cell suspension\n- Viability >80%\n- Cell concentration: 700-1200 cells/\xb5L\n- No debris or clumps\n\n### Cell Preparation\n1. Filter through 40 \xb5m strainer\n2. Wash with PBS + 0.04% BSA\n3. Count cells (hemocytometer + Trypan blue)\n4. Adjust to 1000 cells/\xb5L\n5. Keep on ice until loading\n\n### Chromium Controller\n1. Load cells per chip well (10,000 target)\n2. Run Chromium Controller program\n3. Collect GEMs (gel beads in emulsion)\n4. Perform reverse transcription\n\n### Library Preparation\n1. cDNA amplification (12 cycles)\n2. QC: Bioanalyzer (expect 400-3000 bp)\n3. Fragmentation and adapter ligation\n4. Sample index PCR\n5. Final QC: Qubit + Bioanalyzer\n\n### Sequencing Parameters\n- Read 1: 28 bp (cell barcode + UMI)\n- i7 Index: 8 bp\n- Read 2: 91 bp (transcript)\n- Depth: 50,000 reads/cell minimum",createdAt:Fe(-25),updatedAt:Fe(-5),tags:["10x","scRNA-seq","library prep"]}]},ze={cart:[{id:"res-cart-1",title:"CAR Expression Analysis - Batch 1",content:"## Flow Cytometry Results\n\n### Transduction Efficiency\n| Sample | MOI | CAR+ (%) | Viability |\n|--------|-----|----------|-----------|\n| HD-001 | 5 | 28.4% | 91% |\n| HD-001 | 10 | 42.1% | 88% |\n| HD-001 | 20 | 51.3% | 82% |\n| HD-002 | 10 | 38.7% | 90% |\n| HD-002 | 20 | 48.9% | 85% |\n\n### Key Findings\n- Optimal MOI appears to be 10-20\n- Higher MOI reduces viability\n- CAR expression stable through Day 14\n\n### CD4/CD8 Ratios\n| Sample | Pre-transduction | Post-transduction |\n|--------|-----------------|-------------------|\n| HD-001 | 1.8 | 1.2 |\n| HD-002 | 2.1 | 1.4 |\n\n### Conclusions\nMOI 10 provides good balance of transduction efficiency and viability. Proceed with expansion studies using this condition.",createdAt:Fe(-12),updatedAt:Fe(-12),tags:["flow cytometry","transduction","results"]}],crispr:[{id:"res-crispr-1",title:"Paclitaxel IC50 Determination",content:"## Drug Sensitivity Results\n\n### MDA-MB-231 Paclitaxel Response\n\n#### 72-hour Viability Assay\n| Concentration (nM) | Viability (%) | SD |\n|--------------------|---------------|-----|\n| 0 | 100.0 | 2.1 |\n| 1 | 98.2 | 3.4 |\n| 5 | 87.4 | 4.2 |\n| 10 | 62.3 | 5.1 |\n| 25 | 38.7 | 3.8 |\n| 50 | 21.4 | 2.9 |\n| 100 | 12.1 | 2.3 |\n\n### Calculated IC50\n**IC50 = 18.3 nM** (95% CI: 15.2 - 21.8 nM)\n\n### Recommended Screen Concentration\nUse 25 nM paclitaxel for selection:\n- ~60% cell death\n- Sufficient selective pressure\n- Allows resistant population outgrowth",createdAt:Fe(-25),updatedAt:Fe(-25),tags:["IC50","paclitaxel","viability"]}],tme:[{id:"res-tme-1",title:"Spatial Analysis - Pilot Melanoma Sample",content:'## Spatial Transcriptomics Pilot Results\n\n### Sample Information\n- Patient: MEL-042 (pre-treatment)\n- Response: Partial responder to anti-PD-1\n- Tissue: Primary cutaneous melanoma\n\n### Cell Type Composition\n| Cell Type | Percentage | Location |\n|-----------|------------|----------|\n| Melanoma cells | 45% | Tumor core |\n| CD8+ T-cells | 12% | Tumor margin |\n| CD4+ T-cells | 8% | Stroma |\n| Macrophages | 15% | Infiltrating |\n| Fibroblasts | 18% | Stroma |\n| B-cells | 2% | Tertiary lymphoid |\n\n### Spatial Metrics\n- CD8+ T-cell proximity to tumor: 45 \xb5m (median)\n- PD-L1+ tumor fraction: 32%\n- Tertiary lymphoid structures: 2 identified\n\n### Key Observations\n1. "Hot" regions with CD8 infiltration at tumor margin\n2. "Cold" core with minimal immune infiltration\n3. Macrophages predominantly M2 polarized',createdAt:Fe(-6),updatedAt:Fe(-6),tags:["spatial","pilot","melanoma"]}],scrna:[{id:"res-scrna-1",title:"QC Metrics - Batch 1 Sequencing",content:"## scRNA-seq Quality Control\n\n### Sequencing Summary\n| Sample | Reads | Cells | Median Genes | Median UMI |\n|--------|-------|-------|--------------|------------|\n| AML-001 | 285M | 6,842 | 2,145 | 8,234 |\n| AML-002 | 312M | 7,231 | 2,389 | 9,102 |\n| AML-003 | 278M | 5,921 | 1,987 | 7,456 |\n| AML-004 | 301M | 6,654 | 2,234 | 8,567 |\n| AML-005 | 295M | 6,123 | 2,098 | 7,890 |\n\n### QC Thresholds Applied\n- Minimum genes: 500\n- Maximum genes: 6000\n- Maximum MT%: 15%\n- Doublet removal: scrublet\n\n### Cells Passing QC\n| Sample | Pre-QC | Post-QC | % Retained |\n|--------|--------|---------|------------|\n| AML-001 | 6,842 | 5,823 | 85.1% |\n| AML-002 | 7,231 | 6,412 | 88.7% |\n| AML-003 | 5,921 | 4,892 | 82.6% |\n| AML-004 | 6,654 | 5,734 | 86.2% |\n| AML-005 | 6,123 | 5,298 | 86.5% |\n\n### Total Cells for Analysis: 28,159",createdAt:Fe(-3),updatedAt:Fe(-3),tags:["QC","sequencing","metrics"]}]},Be={cart:{background:"## Research Background\n\n### Scientific Rationale\nCAR-T cell therapy has revolutionized treatment for B-cell malignancies, but efficacy in solid tumors remains limited. Key challenges include:\n\n1. **T-cell exhaustion**: Chronic antigen exposure leads to functional exhaustion\n2. **Immunosuppressive TME**: Solid tumors create hostile environments\n3. **Limited persistence**: CAR-T cells often fail to establish long-term memory\n\n### Our Approach\nWe hypothesize that combining:\n- **4-1BB costimulation**: Enhances mitochondrial fitness and memory formation\n- **IL-15 supplementation**: Promotes T-cell survival without exhaustion\n- **Novel CAR design**: Optimized for solid tumor targeting\n\n### Preliminary Data\n- 4-1BB CARs show 2.3x improved persistence vs CD28 CARs\n- IL-15 reduces PD-1 expression by 40%\n- Combination shows synergistic anti-tumor activity in vitro",notes:"## Research Notes\n\n### Week 1-2 Summary\n- Completed IRB approval for healthy donor blood collection\n- Validated CAR construct by Sanger sequencing\n- Established lentivirus production protocol\n\n### Key Observations\n1. Transduction efficiency varies significantly by donor (28-52%)\n2. IL-15 groups maintain better viability during expansion\n3. Need to optimize MOI for each donor batch\n\n### Outstanding Questions\n- Optimal IL-15 concentration for expansion?\n- When to assess exhaustion markers?\n- Best solid tumor model for in vivo studies?\n\n### Next Steps\n1. Complete expansion comparison study\n2. Flow cytometry for exhaustion panel\n3. Plan xenograft experiments",createdAt:Fe(-20),updatedAt:Fe(-2)},crispr:{background:"## Research Background\n\n### Scientific Context\nTriple-negative breast cancer (TNBC) has limited treatment options and frequently develops chemotherapy resistance. Understanding the genetic basis of resistance could identify new therapeutic targets.\n\n### CRISPR Screening Strategy\n- **Library**: Brunello (genome-wide, 77,441 sgRNAs)\n- **Selection**: Paclitaxel treatment\n- **Readout**: Enrichment/depletion of sgRNAs\n- **Analysis**: MAGeCK for hit identification\n\n### Expected Outcomes\n1. Identify genes whose loss confers paclitaxel resistance\n2. Validate top hits with individual knockouts\n3. Characterize mechanisms for drug development\n\n### Preliminary Work\n- Cas9-stable MDA-MB-231 cells validated\n- Library QC confirms excellent representation\n- IC50 determined for selection concentration",notes:"## Research Notes\n\n### Screen Design Notes\n- MOI 0.3 ensures single sgRNA per cell\n- 500x coverage requires 40M cells minimum\n- Treatment duration: 14 days with drug refresh\n\n### Analysis Pipeline\n1. FastQC \u2192 quality assessment\n2. MAGeCK count \u2192 sgRNA quantification\n3. MAGeCK test \u2192 statistical analysis\n4. GSEA \u2192 pathway enrichment\n\n### Validation Strategy\n- Top 50 enriched genes for validation\n- 3-4 independent sgRNAs per gene\n- Confirm knockout by Western blot\n- Re-test drug sensitivity\n\n### Potential Hits to Watch\nBased on literature, expect to see:\n- ABC transporters (drug efflux)\n- DNA repair genes\n- Apoptosis regulators",createdAt:Fe(-30),updatedAt:Fe(-5)},tme:{background:"## Research Background\n\n### Clinical Context\nResponse to immune checkpoint blockade (ICB) in melanoma varies widely. Spatial organization of immune cells in the tumor microenvironment may predict treatment response.\n\n### Hypothesis\nPatients with CD8+ T-cells in close proximity to tumor cells will have better response to anti-PD-1 therapy.\n\n### Technical Approach\n1. **CODEX imaging**: 40-plex antibody panel for comprehensive TME profiling\n2. **Spatial transcriptomics**: 10x Visium for gene expression in spatial context\n3. **Clinical correlation**: Link spatial features to treatment outcomes\n\n### Cohort Information\n- 40 melanoma patients with pre-treatment biopsies\n- Response data available (RECIST criteria)\n- Mix of responders and non-responders",notes:"## Research Notes\n\n### Panel Development\n40-plex CODEX panel includes:\n- T-cell markers: CD3, CD4, CD8, FOXP3\n- Myeloid markers: CD68, CD163, CD11c\n- B-cell markers: CD20, CD19\n- Structural: Pan-CK, SMA, Vimentin\n- Functional: Ki67, PD-1, PD-L1, LAG-3\n\n### Spatial Metrics to Calculate\n1. Nearest neighbor distances\n2. Cell type co-localization scores\n3. Infiltration depth into tumor\n4. Tertiary lymphoid structure identification\n\n### Preliminary Findings\nPilot sample (MEL-042) shows:\n- Clear spatial segregation of immune/tumor compartments\n- CD8+ T-cells concentrated at tumor margin\n- M2 macrophages in tumor core",createdAt:Fe(-15),updatedAt:Fe(-4)},scrna:{background:"## Research Background\n\n### Disease Context\nAcute myeloid leukemia (AML) is characterized by cellular heterogeneity. Leukemic stem cells (LSCs) are thought to drive relapse after chemotherapy.\n\n### Scientific Questions\n1. What defines the LSC transcriptional signature?\n2. Which populations persist after treatment?\n3. Can we predict relapse from diagnosis samples?\n\n### Approach\n- Single-cell RNA-seq on 50 AML patient samples\n- Samples at diagnosis (pre-treatment)\n- Integration with published datasets\n- Machine learning for relapse prediction\n\n### Expected Impact\n- Define therapy-resistant cell populations\n- Identify therapeutic targets on LSCs\n- Develop prognostic gene signature",notes:"## Research Notes\n\n### Sample Collection\n- Bone marrow aspirates at diagnosis\n- Minimum 1x10^6 mononuclear cells\n- Viability >80% required\n- Cryopreserved in 10% DMSO\n\n### Analysis Pipeline\n1. CellRanger \u2192 alignment and counting\n2. Scanpy \u2192 QC, normalization, clustering\n3. Cell type annotation \u2192 reference mapping\n4. Trajectory analysis \u2192 differentiation paths\n5. Signature scoring \u2192 LSC identification\n\n### Reference Datasets\n- van Galen et al. (Cell 2019): AML atlas\n- Pei et al. (Blood 2021): LSC signatures\n- TCGA AML: bulk RNA-seq for validation\n\n### Key Genes for LSC\nCD34+, CD38-, CD123+, TIM-3+\nSignature: GPR56, CD99, IL1RAP",createdAt:Fe(-25),updatedAt:Fe(-1)}},Ge=[{id:"nb-1",title:"CAR-T transduction optimization - Day 1",content:"## Experiment Overview\nOptimized lentiviral transduction protocol for CAR-T cell generation.\n\n## Materials\n- Lentivirus: CAR19-4-1BB (lot #LV2024-03)\n- T-cells: CD3+ cells from healthy donor HD-001\n- Polybrene: 8 \xb5g/mL\n- RetroNectin plates: pre-coated overnight\n\n## Protocol\n1. Thawed T-cells and activated with CD3/CD28 beads (1:1 ratio)\n2. Cultured in X-VIVO 15 + 5% human serum + IL-2 (100 U/mL)\n3. Day 2: Added lentivirus at MOI 5, 10, and 20\n4. Spinoculated at 1000g for 90 min at 32\xb0C\n\n## Results\n- Cell viability post-thaw: 92%\n- Activation efficiency (CD25+): 78%\n- Transduction pending (check Day 5)\n\n## Next Steps\n- Flow cytometry for CAR expression on Day 5\n- Expansion count every 2 days",projectId:"cart",tags:["transduction","protocol","optimization"],createdAt:Fe(-14),updatedAt:Fe(-14),author:"Demo User",isLocked:!0,auditTrail:[]},{id:"nb-2",title:"Brunello library QC results",content:"## Library Quality Control\n\n### NGS Results Summary\nPerformed deep sequencing of Brunello library to assess sgRNA representation.\n\n### Key Metrics\n- Total reads: 42.3M\n- Mapped to library: 98.2%\n- sgRNA detected: 76,441/77,441 (98.7%)\n- Gini index: 0.09 (excellent uniformity)\n\n### Distribution Analysis\n```\nRepresentation percentiles:\n- 10th: 312 reads\n- 50th: 548 reads\n- 90th: 892 reads\n```\n\n### Conclusion\nLibrary quality is excellent. Proceed with screen at 500x coverage.\n\n### Files\n- FastQ: /data/crispr/brunello_qc_R1.fastq.gz\n- Count table: /data/crispr/brunello_counts.txt",projectId:"crispr",tags:["QC","NGS","library"],createdAt:Fe(-21),updatedAt:Fe(-21),author:"Demo User",isLocked:!0,auditTrail:[]},{id:"nb-3",title:"CODEX panel validation - tonsil tissue",content:"## Antibody Panel Validation\n\n### Objective\nValidate first 20 antibodies of CODEX panel on positive control tissue (tonsil).\n\n### Antibodies Tested\n| Marker | Clone | Dilution | Result |\n|--------|-------|----------|--------|\n| CD3 | UCHT1 | 1:200 | Pass |\n| CD4 | RPA-T4 | 1:100 | Pass |\n| CD8 | SK1 | 1:150 | Pass |\n| CD20 | L26 | 1:200 | Pass |\n| CD68 | KP1 | 1:100 | Pass |\n| PanCK | AE1/AE3 | 1:200 | Pass |\n| Ki67 | MIB-1 | 1:100 | Pass |\n| PD-1 | NAT105 | 1:50 | Weak |\n| FOXP3 | 236A/E7 | 1:100 | Pass |\n| CD45 | HI30 | 1:200 | Pass |\n\n### Issues\n- PD-1 signal weak - try 1:25 dilution\n- Some autofluorescence in germinal centers\n\n### Next Steps\n1. Re-test PD-1 at lower dilution\n2. Add autofluorescence removal step\n3. Proceed with remaining 20 antibodies",projectId:"tme",tags:["CODEX","validation","antibodies"],createdAt:Fe(-8),updatedAt:Fe(-6),author:"Demo User",isLocked:!1,auditTrail:[]},{id:"nb-4",title:"AML sample processing - Batch 1",content:"## Sample Processing Log\n\n### Samples Received\n5 AML bone marrow aspirates (diagnostic)\n\n| Sample ID | Diagnosis | Blast % | Viability |\n|-----------|-----------|---------|-----------|\n| AML-001 | AML-M1 | 78% | 89% |\n| AML-002 | AML-M4 | 65% | 92% |\n| AML-003 | AML-M2 | 82% | 85% |\n| AML-004 | AML-M5 | 71% | 88% |\n| AML-005 | AML-M1 | 69% | 91% |\n\n### Processing Protocol\n1. Ficoll separation (400g, 30 min)\n2. Red cell lysis (ACK buffer, 5 min)\n3. Wash 2x in PBS + 0.04% BSA\n4. Count and viability check\n5. Target: 10,000 cells for 10x loading\n\n### 10x Chromium Loading\n- Target cells: 10,000\n- Expected recovery: 6,000-8,000\n- Loaded all 5 samples successfully\n\n### Notes\n- AML-003 had some clumping - extra filtering\n- All samples passed QC for sequencing",projectId:"scrna",tags:["sample processing","10x","AML"],createdAt:Fe(-5),updatedAt:Fe(-5),author:"Demo User",isLocked:!1,auditTrail:[]},{id:"nb-5",title:"IL-15 expansion comparison - Week 1",content:"## CAR-T Expansion Study\n\n### Experimental Design\nCompare CAR-T expansion with IL-2 vs IL-15 supplementation.\n\n### Conditions\n- **Group A**: IL-2 (100 U/mL)\n- **Group B**: IL-15 (10 ng/mL)\n- **Group C**: IL-15 + IL-21 (10 ng/mL each)\n\n### Cell Counts (x10^6)\n\n| Day | IL-2 | IL-15 | IL-15/21 |\n|-----|------|-------|----------|\n| 0 | 2.0 | 2.0 | 2.0 |\n| 3 | 4.2 | 5.1 | 5.8 |\n| 5 | 8.5 | 12.3 | 14.1 |\n| 7 | 15.2 | 28.4 | 31.2 |\n\n### Observations\n- IL-15 groups showing enhanced expansion\n- Cell morphology healthier in IL-15 groups\n- Less activation-induced cell death\n\n### Samples Collected\n- Day 7: Flow cytometry for exhaustion markers\n- Day 7: Cytokine supernatant (stored -80C)",projectId:"cart",tags:["expansion","IL-15","comparison"],createdAt:Fe(-3),updatedAt:Fe(-2),author:"Demo User",isLocked:!1,auditTrail:[]}];function We(e){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(e)}function Ve(e){var t=function(e,t){if("object"!=We(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=We(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==We(t)?t:t+""}function qe(e,t,n){return(t=Ve(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach(function(t){qe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var He=n(579);const Qe=(0,l.createContext)(),$e="research-dashboard-theme",Ye="research-dashboard-activity",Xe="research-dashboard-archived";function Ze(e){let{children:t}=e;const[n,a]=(0,l.useState)(()=>localStorage.getItem($e)||"dark"),[r,o]=(0,l.useState)(()=>{const e=localStorage.getItem(Ye);try{return e?JSON.parse(e):[]}catch(t){return[]}}),[i,s]=(0,l.useState)(()=>{const e=localStorage.getItem(Xe);try{return e?JSON.parse(e):[]}catch(t){return[]}});(0,l.useEffect)(()=>{localStorage.setItem($e,n),document.documentElement.setAttribute("data-theme",n)},[n]),(0,l.useEffect)(()=>{const e=r.slice(0,100);localStorage.setItem(Ye,JSON.stringify(e))},[r]),(0,l.useEffect)(()=>{localStorage.setItem(Xe,JSON.stringify(i))},[i]);const c=(e,t)=>{const n=Je({id:Date.now(),timestamp:(new Date).toISOString(),action:e},t);o(e=>[n,...e])};return(0,He.jsx)(Qe.Provider,{value:{theme:n,toggleTheme:()=>{a(e=>"dark"===e?"light":"dark")},activities:r,logActivity:c,archivedProjects:i,archiveProject:e=>{s(t=>[...t,e]),c("archive_project",{projectId:e})},unarchiveProject:e=>{s(t=>t.filter(t=>t!==e)),c("unarchive_project",{projectId:e})},isProjectArchived:e=>i.includes(e)},children:t})}function et(){const e=(0,l.useContext)(Qe);if(!e)throw new Error("useApp must be used within AppProvider");return e}const tt="your-client-id-here.apps.googleusercontent.com",nt="your-api-key-here",at=(0,l.createContext)(null),rt="google-auth-token",ot="google-auth-user";function it(e){let{children:t}=e;const[n,a]=(0,l.useState)(!1),[r,o]=(0,l.useState)(!1),[i,s]=(0,l.useState)(!1),[c,d]=(0,l.useState)(!1),[u,p]=(0,l.useState)(null),[m,h]=(0,l.useState)(null),[g,f]=(0,l.useState)(!1),v=(0,l.useRef)(!1),y=Boolean(tt&&nt),[b,x]=(0,l.useState)(()=>"true"===sessionStorage.getItem("google-signin-dismissed")),k=(0,l.useCallback)(e=>{const t={access_token:e.access_token,expires_at:Date.now()+1e3*e.expires_in,token_type:e.token_type,scope:e.scope};return localStorage.setItem(rt,JSON.stringify(t)),t},[]),j=(0,l.useCallback)(()=>{try{const e=localStorage.getItem(rt);if(!e)return null;const t=JSON.parse(e);return t.expires_at&&t.expires_at<Date.now()+3e5?(localStorage.removeItem(rt),localStorage.removeItem(ot),null):t}catch(Fr){return console.error("Error loading saved token:",Fr),null}},[]),w=(0,l.useCallback)(()=>{try{const e=localStorage.getItem(ot);if(e)return JSON.parse(e)}catch(Fr){console.error("Error loading saved user:",Fr)}return null},[]);(0,l.useEffect)(()=>{const e=async()=>{try{if(await window.gapi.client.init({apiKey:nt,discoveryDocs:["https://docs.googleapis.com/$discovery/rest?version=v1","https://www.googleapis.com/discovery/v1/apis/drive/v3/rest","https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest","https://sheets.googleapis.com/$discovery/rest?version=v4"]}),o(!0),!v.current){v.current=!0;const e=j();if(e){window.gapi.client.setToken({access_token:e.access_token,token_type:e.token_type||"Bearer"}),a(!0);const t=w();t&&h(t)}}}catch(e){console.error("Error initializing gapi:",e)}};(()=>{if(window.gapi&&window.gapi.client)return void e();const t=document.createElement("script");t.src="https://apis.google.com/js/api.js",t.async=!0,t.defer=!0,t.onload=()=>{window.gapi.load("client:picker",()=>{e(),d(!0)})},document.body.appendChild(t)})()},[j,w]),(0,l.useEffect)(()=>{if(i)return;const e=()=>{try{const e=window.google.accounts.oauth2.initTokenClient({client_id:tt,scope:"openid profile email https://www.googleapis.com/auth/documents https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.appdata https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/calendar.events https://www.googleapis.com/auth/spreadsheets",callback:e=>{e&&e.access_token&&(k(e),a(!0),f(!1),S(e.access_token))},error_callback:e=>{console.error("GIS error:",e)}});p(e),s(!0)}catch(e){console.error("Error initializing GIS:",e)}};(()=>{if(window.google&&window.google.accounts)return void e();const t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",t.async=!0,t.defer=!0,t.onload=e,document.body.appendChild(t)})()},[i,k]),(0,l.useEffect)(()=>{if(i&&r&&y&&!n&&!b){const e=setTimeout(()=>{f(!0)},1500);return()=>clearTimeout(e)}},[i,r,y,n,b]),(0,l.useEffect)(()=>{if(!n)return;const e=setInterval(()=>{j()||(a(!1),h(null))},6e4);return()=>clearInterval(e)},[n,j]);const S=async e=>{try{const t=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:"Bearer ".concat(e)}}),n=await t.json(),a={name:n.name,email:n.email,picture:n.picture};h(a),localStorage.setItem(ot,JSON.stringify(a))}catch(t){console.error("Error fetching user info:",t)}},N=(0,l.useCallback)(()=>{u&&u.requestAccessToken()},[u]),C=(0,l.useCallback)(()=>{var e,t;localStorage.removeItem(rt),localStorage.removeItem(ot),window.google&&window.google.accounts&&null!==(e=window.gapi)&&void 0!==e&&null!==(t=e.client)&&void 0!==t&&t.getToken()?window.google.accounts.oauth2.revoke(window.gapi.client.getToken().access_token,()=>{window.gapi.client.setToken(null),a(!1),h(null)}):(a(!1),h(null))},[]),E=(0,l.useCallback)(()=>{f(!1),x(!0),sessionStorage.setItem("google-signin-dismissed","true")},[]),I=(0,l.useCallback)(async(e,t)=>{if(!r||!n)return null;try{const n=(await window.gapi.client.docs.documents.create({resource:{title:e}})).result.documentId,a="https://docs.google.com/document/d/".concat(n,"/edit");return await window.gapi.client.docs.documents.batchUpdate({documentId:n,resource:{requests:[{insertText:{location:{index:1},text:t}}]}}),{docId:n,docUrl:a}}catch(a){return console.error("Error creating Google Doc:",a),null}},[r,n]),D=(0,l.useCallback)(async(e,t)=>{if(!r||!n||!e)return!1;try{var a;const n=(null===(a=(await window.gapi.client.docs.documents.get({documentId:e})).result.body.content.slice(-1)[0])||void 0===a?void 0:a.endIndex)||1,r=[];return n>2&&r.push({deleteContentRange:{range:{startIndex:1,endIndex:n-1}}}),r.push({insertText:{location:{index:1},text:t}}),await window.gapi.client.docs.documents.batchUpdate({documentId:e,resource:{requests:r}}),!0}catch(o){return console.error("Error syncing to Google Doc:",o),!1}},[r,n]),T=(0,l.useCallback)(async e=>{if(!r||!n||!e)return null;try{const t=await window.gapi.client.docs.documents.get({documentId:e});let n="";const a=t.result.body.content;for(const e of a)if(e.paragraph)for(const t of e.paragraph.elements||[])t.textRun&&t.textRun.content&&(n+=t.textRun.content);return{title:t.result.title,content:n.trim()}}catch(t){return console.error("Error importing from Google Doc:",t),null}},[r,n]),A=(0,l.useCallback)(async(e,t)=>{if(!r||!n)return[];try{return(await window.gapi.client.calendar.events.list({calendarId:"primary",timeMin:e.toISOString(),timeMax:t.toISOString(),singleEvents:!0,orderBy:"startTime"})).result.items||[]}catch(a){return console.error("Error fetching calendar events:",a),[]}},[r,n]),P=(0,l.useCallback)(async e=>{if(!r||!n)return null;try{return(await window.gapi.client.calendar.events.insert({calendarId:"primary",resource:e})).result}catch(t){return console.error("Error creating calendar event:",t),null}},[r,n]),O=(0,l.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!r||!n)return null;try{const n=(await window.gapi.client.sheets.spreadsheets.create({resource:{properties:{title:e},sheets:[{properties:{title:"Sheet1"}}]}})).result.spreadsheetId,r="https://docs.google.com/spreadsheets/d/".concat(n,"/edit");if(t.length>0||a.length>0){const e=[];t.length>0&&e.push(t),a.length>0&&e.push(...a),e.length>0&&await window.gapi.client.sheets.spreadsheets.values.update({spreadsheetId:n,range:"Sheet1!A1",valueInputOption:"RAW",resource:{values:e}})}return{spreadsheetId:n,sheetUrl:r}}catch(o){return console.error("Error creating Google Sheet:",o),null}},[r,n]),L=(0,l.useCallback)(async(e,t,a)=>{if(!r||!n||!e)return!1;try{await window.gapi.client.sheets.spreadsheets.values.clear({spreadsheetId:e,range:"Sheet1"});const n=[t,...a];return await window.gapi.client.sheets.spreadsheets.values.update({spreadsheetId:e,range:"Sheet1!A1",valueInputOption:"RAW",resource:{values:n}}),!0}catch(o){return console.error("Error syncing to Google Sheet:",o),!1}},[r,n]),R=(0,l.useCallback)(async e=>{if(!r||!n||!e)return null;try{const t=(await window.gapi.client.sheets.spreadsheets.values.get({spreadsheetId:e,range:"Sheet1"})).result.values||[],n=t[0]||[];return{headers:n,data:t.slice(1)}}catch(t){return console.error("Error importing from Google Sheet:",t),null}},[r,n]),M=(0,l.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!r||!n)return null;try{const n={name:e.name,mimeType:e.type};t&&(n.parents=[t]);const a=new FormData;a.append("metadata",new Blob([JSON.stringify(n)],{type:"application/json"})),a.append("file",e);const r=window.gapi.client.getToken(),o=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,mimeType,webViewLink,webContentLink,thumbnailLink,iconLink",{method:"POST",headers:{Authorization:"Bearer ".concat(r.access_token)},body:a});if(!o.ok)throw new Error("Upload failed: ".concat(o.status));const i=await o.json();return{id:i.id,name:i.name,mimeType:i.mimeType,webViewLink:i.webViewLink,webContentLink:i.webContentLink,thumbnailLink:i.thumbnailLink,iconLink:i.iconLink}}catch(a){return console.error("Error uploading to Google Drive:",a),null}},[r,n]),F=(0,l.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((t,a)=>{if(!c||!n)return void a(new Error("Picker not available or not signed in"));const r=window.gapi.client.getToken();if(!r)return void a(new Error("No access token available"));const{multiSelect:o=!1,mimeTypes:i=null,viewId:l="DOCS"}=e;try{let e;e=i&&i.length>0?(new window.google.picker.DocsView).setMimeTypes(i.join(",")).setIncludeFolders(!1):"PDFS"===l?(new window.google.picker.DocsView).setMimeTypes("application/pdf").setIncludeFolders(!1):new window.google.picker.DocsView(window.google.picker.ViewId[l]||window.google.picker.ViewId.DOCS).setIncludeFolders(!1);const n=(new window.google.picker.PickerBuilder).addView(e).addView(new window.google.picker.DocsUploadView).setOAuthToken(r.access_token).setDeveloperKey(nt).setCallback(e=>{if(e.action===window.google.picker.Action.PICKED){const n=e.docs.map(e=>({id:e.id,name:e.name,mimeType:e.mimeType,url:e.url,iconUrl:e.iconUrl,embedUrl:e.embedUrl}));t(o?n:n[0])}else e.action===window.google.picker.Action.CANCEL&&t(null)});o&&n.enableFeature(window.google.picker.Feature.MULTISELECT_ENABLED),n.build().setVisible(!0)}catch(s){console.error("Error opening file picker:",s),a(s)}})},[c,n]),U=(0,l.useCallback)(async e=>{if(!r||!n)return null;try{return(await window.gapi.client.drive.files.get({fileId:e,fields:"id,name,mimeType,webViewLink,webContentLink,thumbnailLink,iconLink,size"})).result}catch(t){return console.error("Error getting file info:",t),null}},[r,n]),_={isSignedIn:n,gapiLoaded:r,gisLoaded:i,pickerLoaded:c,hasCredentials:y,user:m,showSignInPrompt:g,signIn:N,signOut:C,dismissPrompt:E,createDoc:I,syncToDoc:D,importFromDoc:T,createSheet:O,syncToSheet:L,importFromSheet:R,getCalendarEvents:A,createCalendarEvent:P,uploadFileToDrive:M,openFilePicker:F,getFileInfo:U};return(0,He.jsx)(at.Provider,{value:_,children:t})}function lt(){const e=(0,l.useContext)(at);if(!e)throw new Error("useGoogleAuth must be used within a GoogleAuthProvider");return e}const st=(0,l.createContext)(null),ct="success",dt="error",ut="warning",pt="info";let mt=null;function ht(e){let{children:t}=e;const[n,a]=(0,l.useState)([]),r=(0,l.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pt,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;const r=Date.now()+Math.random(),i={id:r,message:e,type:t,duration:n};return a(e=>[...e,i]),n>0&&setTimeout(()=>{o(r)},n),r},[]),o=(0,l.useCallback)(e=>{a(t=>t.filter(t=>t.id!==e))},[]),i=(0,l.useCallback)(function(e){return r(e,ct,arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3)},[r]),s=(0,l.useCallback)(function(e){return r(e,dt,arguments.length>1&&void 0!==arguments[1]?arguments[1]:6e3)},[r]),c=(0,l.useCallback)(function(e){return r(e,ut,arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3)},[r]),d=(0,l.useCallback)(function(e){return r(e,pt,arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3)},[r]),u=(0,l.useCallback)(()=>{a([])},[]);return(0,l.useEffect)(()=>(mt=r,()=>{mt=null}),[r]),(0,l.useEffect)(()=>{const e=e=>{const{message:t,type:n,duration:a}=e.detail;r(t,n,a)};return window.addEventListener("show-toast",e),()=>window.removeEventListener("show-toast",e)},[r]),(0,He.jsxs)(st.Provider,{value:{toasts:n,addToast:r,removeToast:o,showSuccess:i,showError:s,showWarning:c,showInfo:d,clearAll:u},children:[t,(0,He.jsx)(gt,{toasts:n,onRemove:o})]})}function gt(e){let{toasts:t,onRemove:n}=e;return 0===t.length?null:(0,He.jsx)("div",{className:"toast-container",role:"alert","aria-live":"polite",children:t.map(e=>(0,He.jsx)(ft,{toast:e,onRemove:n},e.id))})}function ft(e){let{toast:t,onRemove:n}=e;return(0,He.jsxs)("div",{className:"toast toast-".concat(t.type),children:[(0,He.jsx)("span",{className:"toast-icon",children:(()=>{switch(t.type){case ct:return"\u2713";case dt:return"\u2715";case ut:return"\u26a0";default:return"\u2139"}})()}),(0,He.jsx)("span",{className:"toast-message",children:t.message}),(0,He.jsx)("button",{className:"toast-close",onClick:()=>n(t.id),"aria-label":"Dismiss notification",children:"\xd7"})]})}function vt(){const e=(0,l.useContext)(st);if(!e)throw new Error("useToast must be used within ToastProvider");return e}const yt=(0,l.createContext)(null),bt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pt,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;window.dispatchEvent(new CustomEvent("show-toast",{detail:{message:e,type:t,duration:n}}))},xt=["research-dashboard-custom-projects","research-dashboard-tasks","research-dashboard-lab-notebook","research-dashboard-literature","research-dashboard-recurring","research-dashboard-templates","research-dashboard-activity","research-dashboard-archived","research-dashboard-theme","research-dashboard-project-order","research-dashboard-project-overrides"],kt=["research-dashboard-research-notes-","research-dashboard-protocols-","research-dashboard-results-"],jt="research-dashboard-data.json";function wt(e){let{children:t}=e;const{isSignedIn:n,gapiLoaded:a}=lt(),[r,o]=(0,l.useState)("idle"),[i,s]=(0,l.useState)(null),[c,d]=(0,l.useState)(null),[u,p]=(0,l.useState)(null),m=(0,l.useRef)(null),h=(0,l.useRef)(!1),g=(0,l.useCallback)(()=>{const e={version:1,lastModified:(new Date).toISOString(),keys:{}};xt.forEach(t=>{const n=localStorage.getItem(t);if(n)try{e.keys[t]=JSON.parse(n)}catch(a){e.keys[t]=n}});for(let n=0;n<localStorage.length;n++){const a=localStorage.key(n);if(kt.some(e=>a.startsWith(e))){const n=localStorage.getItem(a);if(n)try{e.keys[a]=JSON.parse(n)}catch(t){e.keys[a]=n}}}return e},[]),f=(0,l.useCallback)(e=>{e&&e.keys&&Object.entries(e.keys).forEach(e=>{let[t,n]=e;"object"===typeof n?localStorage.setItem(t,JSON.stringify(n)):localStorage.setItem(t,n)})},[]),v=(0,l.useCallback)(async()=>{if(!a||!n)return null;try{const e=(await window.gapi.client.drive.files.list({spaces:"appDataFolder",q:"name = '".concat(jt,"'"),fields:"files(id, name, modifiedTime)"})).result.files||[];return e.length>0?e[0]:null}catch(e){return console.error("Error finding sync file:",e),null}},[a,n]),y=(0,l.useCallback)(async e=>{if(!a||!n||!e)return null;try{return(await window.gapi.client.drive.files.get({fileId:e,alt:"media"})).result}catch(t){return console.error("Error reading from Drive:",t),null}},[a,n]),b=(0,l.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!a||!n)return null;try{const n="-------314159265358979323846",a="\r\n--"+n+"\r\n",r="\r\n--"+n+"--",o={name:jt,mimeType:"application/json"};t||(o.parents=["appDataFolder"]);const i=a+"Content-Type: application/json\r\n\r\n"+JSON.stringify(o)+a+"Content-Type: application/json\r\n\r\n"+JSON.stringify(e)+r,l=t?"https://www.googleapis.com/upload/drive/v3/files/".concat(t,"?uploadType=multipart"):"https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",s=t?"PATCH":"POST";return(await window.gapi.client.request({path:l,method:s,headers:{"Content-Type":'multipart/related; boundary="'+n+'"'},body:i})).result}catch(r){throw console.error("Error writing to Drive:",r),r}},[a,n]),x=(0,l.useCallback)((e,t)=>{if(!t||!t.keys)return e;if(!e||!e.keys)return t;return{version:1,lastModified:(new Date).toISOString(),keys:Je(Je({},t.keys),e.keys)}},[]),k=(0,l.useCallback)(async function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!a||!n)return o("error"),p("Not signed in to Google"),e&&bt("Sync failed: Not signed in to Google",dt),!1;o("syncing"),p(null);try{let e=await v(),t=null;e&&(d(e.id),t=await y(e.id));const n=g(),a=x(n,t);f(a);const r=await b(a,null===e||void 0===e?void 0:e.id);if(r)return d(r.id),s(new Date),o("success"),window.dispatchEvent(new CustomEvent("data-synced")),!0;throw new Error("Failed to write to Drive")}catch(t){return console.error("Sync error:",t),o("error"),p(t.message),e&&bt("Sync failed: ".concat(t.message),dt,8e3),!1}},[a,n,v,y,g,x,f,b]),j=(0,l.useCallback)(()=>{m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{k()},3e3)},[k]);(0,l.useEffect)(()=>{n&&a&&!h.current&&(h.current=!0,k())},[n,a,k]),(0,l.useEffect)(()=>{n||(h.current=!1,d(null),s(null),o("idle"))},[n]),(0,l.useEffect)(()=>{if(!n||!a)return;const e=e=>{(xt.includes(e.key)||kt.some(t=>{var n;return null===(n=e.key)||void 0===n?void 0:n.startsWith(t)}))&&j()};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[n,a,j]),(0,l.useEffect)(()=>{if(!n||!a)return;const e=()=>{j()};return window.addEventListener("local-data-changed",e),()=>window.removeEventListener("local-data-changed",e)},[n,a,j]);const w={syncStatus:r,lastSynced:i,syncError:u,syncNow:k,queueSync:j,isSignedIn:n,gapiLoaded:a};return(0,He.jsx)(yt.Provider,{value:w,children:t})}function St(){return(0,l.useCallback)(()=>{window.dispatchEvent(new CustomEvent("local-data-changed"))},[])}const Nt=(0,l.createContext)(null),Ct="research-dashboard-backup-settings",Et="research-dashboard-last-backup",It="Research Dashboard Backups",Dt=()=>{const e=navigator.userAgent;let t="Unknown";e.includes("Edg/")?t="Edge":e.includes("Chrome/")?t="Chrome":e.includes("Firefox/")?t="Firefox":e.includes("Safari/")&&!e.includes("Chrome")?t="Safari":(e.includes("Opera")||e.includes("OPR/"))&&(t="Opera");let n="Unknown";return e.includes("Windows")?n="Windows":e.includes("Mac OS")?n="Mac":e.includes("Linux")?n="Linux":e.includes("Android")?n="Android":e.includes("iPhone")||e.includes("iPad")?n="iOS":e.includes("CrOS")&&(n="ChromeOS"),{browser:t,machine:n}},Tt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pt,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;window.dispatchEvent(new CustomEvent("show-toast",{detail:{message:e,type:t,duration:n}}))},At=["research-dashboard-custom-projects","research-dashboard-tasks","research-dashboard-lab-notebook","research-dashboard-literature","research-dashboard-recurring","research-dashboard-templates","research-dashboard-activity","research-dashboard-archived","research-dashboard-theme","research-dashboard-trash","research-dashboard-project-order","research-dashboard-project-overrides"],Pt=["research-dashboard-research-notes-","research-dashboard-protocols-","research-dashboard-results-","research-dashboard-lab-notebook-"],Ot=()=>{const e={exportVersion:"1.0",exportDate:(new Date).toISOString(),appName:"Research Dashboard",data:{}};At.forEach(t=>{try{const n=localStorage.getItem(t);n&&(e.data[t]=JSON.parse(n))}catch(Fr){console.warn("Failed to export ".concat(t,":"),Fr)}});for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);if(Pt.some(e=>n.startsWith(e)))try{const t=localStorage.getItem(n);t&&(e.data[n]=JSON.parse(t))}catch(Fr){console.warn("Failed to export ".concat(n,":"),Fr)}}return e},Lt=e=>{if(!e.data||"object"!==typeof e.data)throw new Error("Invalid backup file format");let t=0;return Object.entries(e.data).forEach(e=>{let[n,a]=e;try{localStorage.setItem(n,JSON.stringify(a)),t++}catch(Fr){console.error("Failed to import ".concat(n,":"),Fr)}}),t};function Rt(e){let{children:t}=e;const{isSignedIn:n,gapiLoaded:a,uploadFileToDrive:r,openFilePicker:o}=lt(),[i,s]=(0,l.useState)(()=>{try{const e=localStorage.getItem(Ct);if(e)return JSON.parse(e)}catch(e){}return{enabled:!0,intervalMinutes:5,backupOnExit:!0,maxAutoBackups:12}}),[c,d]=(0,l.useState)(()=>{try{const e=localStorage.getItem(Et);if(e)return new Date(e)}catch(e){}return null}),[u,p]=(0,l.useState)(!1),[m,h]=(0,l.useState)(null),g=(0,l.useRef)(null);(0,l.useEffect)(()=>{localStorage.setItem(Ct,JSON.stringify(i))},[i]);const f=(0,l.useCallback)(e=>{s(t=>Je(Je({},t),e))},[]),v=(0,l.useCallback)(async()=>{if(!a||!n)return null;try{const e=(await window.gapi.client.drive.files.list({q:"name = '".concat(It,"' and mimeType = 'application/vnd.google-apps.folder' and trashed = false"),spaces:"drive",fields:"files(id, name)"})).result.files||[];if(e.length>0)return h(e[0].id),e[0].id;const t=(await window.gapi.client.drive.files.create({resource:{name:It,mimeType:"application/vnd.google-apps.folder"},fields:"id"})).result.id;return h(t),t}catch(e){return console.error("Error getting/creating backup folder:",e),null}},[a,n]),y=(0,l.useCallback)(()=>{const e=Ot(),{browser:t,machine:n}=Dt(),a=(new Date).toISOString().replace(/[:.]/g,"-").slice(0,19),r="MANUAL-".concat(a,"-").concat(t,"-").concat(n,".json"),o=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),i=URL.createObjectURL(o),l=document.createElement("a");l.setAttribute("href",i),l.setAttribute("download",r),l.click(),URL.revokeObjectURL(i);const s=new Date;return d(s),localStorage.setItem(Et,s.toISOString()),!0},[]),b=(0,l.useCallback)(async e=>{if(a&&n&&e)try{const t=(await window.gapi.client.drive.files.list({q:"'".concat(e,"' in parents and name contains 'AUTO-' and mimeType = 'application/json' and trashed = false"),spaces:"drive",fields:"files(id, name, createdTime)",orderBy:"createdTime desc",pageSize:100})).result.files||[],n=i.maxAutoBackups||12;if(t.length>n){const e=t.slice(n);console.log("Cleaning up ".concat(e.length," old auto-backups..."));for(const t of e)try{await window.gapi.client.drive.files.delete({fileId:t.id})}catch(Fr){console.error("Failed to delete old backup ".concat(t.name,":"),Fr)}}}catch(t){console.error("Error cleaning up old backups:",t)}},[a,n,i.maxAutoBackups]),x=(0,l.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!a||!n)return e||Tt("Please sign in to Google to backup to Drive",ut),!1;p(!0);try{const n=await v(),a=Ot(),{browser:o,machine:i}=Dt(),l=t?"AUTO":"MANUAL",s=(new Date).toISOString().replace(/[:.]/g,"-").slice(0,19),c="".concat(l,"-").concat(s,"-").concat(o,"-").concat(i,".json"),u=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),p=new File([u],c,{type:"application/json"}),m=await r(p,n);if(m){const a=new Date;return d(a),localStorage.setItem(Et,a.toISOString()),e||Tt("Backup saved to Google Drive",ct),window.dispatchEvent(new CustomEvent("backup-completed",{detail:{location:"google-drive",filename:c,fileId:m.id,isAuto:t}})),t&&await b(n),m}throw new Error("Upload failed")}catch(o){return console.error("Error exporting to Google Drive:",o),e||Tt("Backup failed: ".concat(o.message),dt),!1}finally{p(!1)}},[a,n,v,r,b]),k=(0,l.useCallback)(async()=>{if(!a||!n)return Tt("Please sign in to Google to import from Drive",ut),!1;try{const e=await o({mimeTypes:["application/json"],multiSelect:!1});if(!e)return!1;const t=(await window.gapi.client.drive.files.get({fileId:e.id,alt:"media"})).result;if(!t.appName||"Research Dashboard"!==t.appName)return Tt("Invalid backup file. Please select a valid Research Dashboard backup.",dt),!1;const n=Object.keys(t.data).length,a=new Date(t.exportDate).toLocaleDateString(),r="Import ".concat(n," data entries from backup dated ").concat(a,"?\n\nExisting data will be merged with the backup.");if(!window.confirm(r))return!1;const i=Lt(t);return Tt("Successfully imported ".concat(i," entries from Google Drive. Reloading..."),ct),setTimeout(()=>{window.location.reload()},1500),!0}catch(e){return console.error("Error importing from Google Drive:",e),Tt("Import failed: ".concat(e.message),dt),!1}},[a,n,o]),j=(0,l.useCallback)(async()=>{if(!a||!n)return[];try{const e=await v();if(!e)return[];return(await window.gapi.client.drive.files.list({q:"'".concat(e,"' in parents and mimeType = 'application/json' and trashed = false"),spaces:"drive",fields:"files(id, name, createdTime, modifiedTime, size)",orderBy:"createdTime desc",pageSize:20})).result.files||[]}catch(e){return console.error("Error listing Drive backups:",e),[]}},[a,n,v]),w=(0,l.useCallback)(async(e,t)=>{if(!a||!n)return!1;try{const n=(await window.gapi.client.drive.files.get({fileId:e,alt:"media"})).result;if(!n.appName||"Research Dashboard"!==n.appName)return Tt("Invalid backup file format",dt),!1;const a=Object.keys(n.data).length;if(!window.confirm('Restore from "'.concat(t,'"?\n\nThis will import ').concat(a," data entries.")))return!1;const r=Lt(n);return Tt("Restored ".concat(r," entries. Reloading..."),ct),setTimeout(()=>{window.location.reload()},1500),!0}catch(r){return console.error("Error restoring from Drive backup:",r),Tt("Restore failed: ".concat(r.message),dt),!1}},[a,n]),S=(0,l.useCallback)(async e=>{if(!a||!n)return!1;try{return await window.gapi.client.drive.files.delete({fileId:e}),Tt("Backup deleted from Google Drive",ct),!0}catch(t){return console.error("Error deleting Drive backup:",t),Tt("Delete failed: ".concat(t.message),dt),!1}},[a,n]);(0,l.useEffect)(()=>{if(!i.enabled||i.intervalMinutes<=0)return void(g.current&&(clearInterval(g.current),g.current=null));const e=async()=>{const e=new Date;if(c){if((e-c)/6e4<i.intervalMinutes)return}n&&a&&(console.log("Running auto-backup to Google Drive..."),await x(!0,!0))};return e(),g.current=setInterval(e,60*i.intervalMinutes*1e3),()=>{g.current&&clearInterval(g.current)}},[i.enabled,i.intervalMinutes,n,a,c,x]),(0,l.useEffect)(()=>{if(!i.backupOnExit)return;const e=()=>{const e=new Date;if(c){if((e-c)/6e4<5)return}localStorage.setItem("research-dashboard-needs-backup","true")};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[i.backupOnExit,c]),(0,l.useEffect)(()=>{"true"===localStorage.getItem("research-dashboard-needs-backup")&&n&&a&&(localStorage.removeItem("research-dashboard-needs-backup"),setTimeout(()=>{x(!0,!0)},3e3))},[n,a,x]);const N={settings:i,updateSettings:f,lastBackup:c,isBackingUp:u,createLocalBackup:y,exportToGoogleDrive:x,importFromGoogleDrive:k,listDriveBackups:j,restoreFromDriveBackup:w,deleteDriveBackup:S,isSignedIn:n,gapiLoaded:a};return(0,He.jsx)(Nt.Provider,{value:N,children:t})}function Mt(){const e=(0,l.useContext)(Nt);if(!e)throw new Error("useAutoBackup must be used within an AutoBackupProvider");return e}const Ft="research-dashboard-literature",Ut=(0,l.createContext)();function _t(e){let{children:t}=e;const[n,a]=(0,l.useState)({});(0,l.useEffect)(()=>{const e=()=>{const e=localStorage.getItem(Ft);if(e)try{a(JSON.parse(e))}catch(Fr){console.error("Failed to load references:",Fr)}};e();const t=t=>{t.key===Ft&&e()};window.addEventListener("storage",t);const n=()=>e();return window.addEventListener("references-updated",n),()=>{window.removeEventListener("storage",t),window.removeEventListener("references-updated",n)}},[]);const r=e=>n[e]||[];return(0,He.jsx)(Ut.Provider,{value:{allReferences:n,getProjectReferences:r,getAllReferences:()=>Object.entries(n).flatMap(e=>{let[t,n]=e;return n.map(e=>Je(Je({},e),{},{projectId:t}))}),formatCitation:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a="";if(e.authors){const t=e.authors.split(", ");t.length>3?a+="".concat(t.slice(0,3).join(", "),", et al"):a+=e.authors,a+=". "}return e.title&&(a+=e.title,e.title.endsWith(".")||e.title.endsWith("?")||(a+="."),a+=" "),e.journal&&(a+="".concat(e.journal,". ")),e.year&&(a+=e.year,e.volume&&(a+=";".concat(e.volume),e.pages&&(a+=":".concat(e.pages))),a+="."),e.doi&&(a+=" doi:".concat(e.doi)),t&&null!==n?"".concat(n,". ").concat(a.trim()):a.trim()},searchReferences:(e,t)=>{const n=r(e);if(!t.trim())return n;const a=t.toLowerCase();return n.filter(e=>{var n,r,o,i;return(null===(n=e.title)||void 0===n?void 0:n.toLowerCase().includes(a))||(null===(r=e.authors)||void 0===r?void 0:r.toLowerCase().includes(a))||(null===(o=e.year)||void 0===o?void 0:o.includes(t))||(null===(i=e.pmid)||void 0===i?void 0:i.includes(t))})},notifyUpdate:()=>{window.dispatchEvent(new Event("references-updated"))}},children:t})}const zt=(0,l.createContext)(),Bt="research-dashboard-api-keys",Gt="research-dashboard-ai-providers",Wt={CLAUDE:"claude",OPENAI:"openai",GEMINI:"gemini"},Vt={[Wt.CLAUDE]:"Claude",[Wt.OPENAI]:"ChatGPT (OpenAI)",[Wt.GEMINI]:"Gemini"},qt={[Wt.CLAUDE]:{summarization:!0,embeddings:!1},[Wt.OPENAI]:{summarization:!0,embeddings:!0},[Wt.GEMINI]:{summarization:!0,embeddings:!0}};function Kt(e){let{children:t}=e;const[n,a]=(0,l.useState)(()=>{const e=localStorage.getItem(Bt);try{return e?JSON.parse(e):{claudeApiKey:"",openaiApiKey:"",geminiApiKey:""}}catch(t){return{claudeApiKey:"",openaiApiKey:"",geminiApiKey:""}}}),[r,o]=(0,l.useState)(()=>{const e=localStorage.getItem(Gt);try{return e?JSON.parse(e):{summarization:Wt.CLAUDE,embeddings:Wt.OPENAI}}catch(t){return{summarization:Wt.CLAUDE,embeddings:Wt.OPENAI}}}),[i,s]=(0,l.useState)(!1);(0,l.useEffect)(()=>{localStorage.setItem(Bt,JSON.stringify(n))},[n]),(0,l.useEffect)(()=>{localStorage.setItem(Gt,JSON.stringify(r))},[r]);const c=(0,l.useCallback)(e=>{a(t=>Je(Je({},t),{},{claudeApiKey:e}))},[]),d=(0,l.useCallback)(e=>{a(t=>Je(Je({},t),{},{openaiApiKey:e}))},[]),u=(0,l.useCallback)(e=>{a(t=>Je(Je({},t),{},{geminiApiKey:e}))},[]),p=(0,l.useCallback)(()=>{a({claudeApiKey:"",openaiApiKey:"",geminiApiKey:""})},[]),m=Boolean(n.claudeApiKey),h=Boolean(n.openaiApiKey),g=Boolean(n.geminiApiKey),f=(0,l.useCallback)(e=>{switch(e){case Wt.CLAUDE:return n.claudeApiKey;case Wt.OPENAI:return n.openaiApiKey;case Wt.GEMINI:return n.geminiApiKey;default:return""}},[n]),v=(0,l.useCallback)(e=>Boolean(f(e)),[f]),y=(0,l.useCallback)(e=>{var t;null!==(t=qt[e])&&void 0!==t&&t.summarization&&o(t=>Je(Je({},t),{},{summarization:e}))},[]),b=(0,l.useCallback)(e=>{var t;null!==(t=qt[e])&&void 0!==t&&t.embeddings&&o(t=>Je(Je({},t),{},{embeddings:e}))},[]),x=(0,l.useCallback)(()=>Object.values(Wt).filter(e=>{var t;return(null===(t=qt[e])||void 0===t?void 0:t.summarization)&&v(e)}),[v]),k=(0,l.useCallback)(()=>Object.values(Wt).filter(e=>{var t;return(null===(t=qt[e])||void 0===t?void 0:t.embeddings)&&v(e)}),[v]),j=(0,l.useCallback)(()=>s(!0),[]),w=(0,l.useCallback)(()=>s(!1),[]),S=(0,l.useCallback)(e=>e?e.startsWith("sk-ant-")?{valid:!0,message:""}:{valid:!1,message:"Claude API key should start with sk-ant-"}:{valid:!1,message:"API key is required"},[]),N=(0,l.useCallback)(e=>e?e.startsWith("sk-")?{valid:!0,message:""}:{valid:!1,message:"OpenAI API key should start with sk-"}:{valid:!1,message:"API key is required"},[]),C=(0,l.useCallback)(e=>e?e.length<20?{valid:!1,message:"Gemini API key appears too short"}:{valid:!0,message:""}:{valid:!1,message:"API key is required"},[]);return(0,He.jsx)(zt.Provider,{value:{claudeApiKey:n.claudeApiKey,openaiApiKey:n.openaiApiKey,geminiApiKey:n.geminiApiKey,setClaudeApiKey:c,setOpenaiApiKey:d,setGeminiApiKey:u,clearApiKeys:p,hasClaudeKey:m,hasOpenaiKey:h,hasGeminiKey:g,getApiKeyForProvider:f,hasKeyForProvider:v,summarizationProvider:r.summarization,embeddingsProvider:r.embeddings,setSummarizationProvider:y,setEmbeddingsProvider:b,getAvailableProvidersForSummarization:x,getAvailableProvidersForEmbeddings:k,isSettingsOpen:i,openSettings:j,closeSettings:w,validateClaudeKey:S,validateOpenaiKey:N,validateGeminiKey:C},children:t})}function Jt(){const e=(0,l.useContext)(zt);if(!e)throw new Error("useApiKeys must be used within ApiKeysProvider");return e}const Ht="https://api.openai.com/v1/embeddings",Qt="https://api.openai.com/v1/chat/completions",$t="text-embedding-3-small",Yt="gpt-4o-mini";async function Xt(e,t){if(!e)throw new Error("OpenAI API key is required");if(!t||"string"!==typeof t)throw new Error("Text is required for embedding");const n=t.slice(0,3e4);try{const t=await fetch(Ht,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({model:$t,input:n})});if(!t.ok){var a;const e=await t.json().catch(()=>({}));if(401===t.status)throw new Error("Invalid API key. Please check your OpenAI API key.");if(429===t.status)throw new Error("Rate limit exceeded. Please try again in a moment.");throw new Error((null===(a=e.error)||void 0===a?void 0:a.message)||"API error: ".concat(t.status))}return(await t.json()).data[0].embedding}catch(r){if("TypeError"===r.name&&r.message.includes("fetch"))throw new Error("Network error. Please check your internet connection.");throw r}}async function Zt(e,t,n){if(!e)throw new Error("OpenAI API key is required");if(!t||!Array.isArray(t)||0===t.length)throw new Error("Texts array is required");const a=[];for(let i=0;i<t.length;i+=20){const l=t.slice(i,i+20).map(e=>e.slice(0,3e4));n&&n(Math.min(i+20,t.length),t.length);try{const n=await fetch(Ht,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({model:$t,input:l})});if(!n.ok){var r;const e=await n.json().catch(()=>({}));throw new Error((null===(r=e.error)||void 0===r?void 0:r.message)||"API error: ".concat(n.status))}const o=(await n.json()).data.sort((e,t)=>e.index-t.index).map(e=>e.embedding);a.push(...o),i+20<t.length&&await new Promise(e=>setTimeout(e,100))}catch(o){for(let e=0;e<l.length;e++)a.push(null);console.error("Batch embedding error:",o)}}return a}function en(e,t){if(!e||!t||e.length!==t.length)return 0;let n=0,a=0,r=0;for(let o=0;o<e.length;o++)n+=e[o]*t[o],a+=e[o]*e[o],r+=t[o]*t[o];return 0===a||0===r?0:n/(Math.sqrt(a)*Math.sqrt(r))}function tn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.3;if(!e||!t||0===t.length)return[];return t.filter(e=>e.embedding&&Array.isArray(e.embedding)).map(t=>Je(Je({},t),{},{similarity:en(e,t.embedding)})).filter(e=>e.similarity>=a).sort((e,t)=>t.similarity-e.similarity).slice(0,n)}function nn(e){if(!e)return"";let t=0;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t.toString(16)}async function an(e){if(!e)throw new Error("API key is required");try{const t=await fetch(Ht,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({model:$t,input:"test"})});if(401===t.status)throw new Error("Invalid API key");return t.ok}catch(t){if("Invalid API key"===t.message)throw t;throw new Error("Could not validate API key. Please check your connection.")}}async function rn(e,t){if(!e)throw new Error("OpenAI API key is required");if(!t.abstract)throw new Error("Paper abstract is required for summarization");const n="You are a research assistant helping to summarize scientific papers. Analyze the following paper and provide:\n1. A concise summary (2-3 sentences) of the main findings and significance\n2. 3-5 key findings or takeaways as bullet points\n\nPaper Details:\nTitle: ".concat(t.title||"Unknown","\nAuthors: ").concat(t.authors||"Unknown","\nJournal: ").concat(t.journal||"Unknown"," (").concat(t.year||"Unknown",")\n\nAbstract:\n").concat(t.abstract,'\n\nRespond in JSON format only, no additional text:\n{\n  "summary": "Your 2-3 sentence summary here",\n  "keyFindings": ["Finding 1", "Finding 2", "Finding 3"]\n}');try{var a,r,o;const t=await fetch(Qt,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({model:Yt,messages:[{role:"user",content:n}],max_tokens:1024,temperature:.3})});if(!t.ok){var i;const e=await t.json().catch(()=>({}));if(401===t.status)throw new Error("Invalid API key. Please check your OpenAI API key.");if(429===t.status)throw new Error("Rate limit exceeded. Please try again in a moment.");throw new Error((null===(i=e.error)||void 0===i?void 0:i.message)||"API error: ".concat(t.status))}const s=null===(a=(await t.json()).choices)||void 0===a||null===(r=a[0])||void 0===r||null===(o=r.message)||void 0===o?void 0:o.content;if(!s)throw new Error("No response from OpenAI API");try{const e=s.match(/\{[\s\S]*\}/);if(!e)throw new Error("Could not parse response");const t=JSON.parse(e[0]);return{summary:t.summary||"",keyFindings:t.keyFindings||[],generatedAt:(new Date).toISOString(),modelUsed:Yt}}catch(l){return{summary:s.trim(),keyFindings:[],generatedAt:(new Date).toISOString(),modelUsed:Yt}}}catch(s){if("TypeError"===s.name&&s.message.includes("fetch"))throw new Error("Network error. Please check your internet connection.");throw s}}async function on(e,t,n){const a=[];for(let o=0;o<t.length;o++){const i=t[o];n&&n(o+1,t.length);try{const t=await rn(e,i);a.push({id:i.id,success:!0,summary:t})}catch(r){a.push({id:i.id,success:!1,error:r.message})}o<t.length-1&&await new Promise(e=>setTimeout(e,300))}return a}function ln(){return 1536}function sn(){return!0}const cn="https://generativelanguage.googleapis.com/v1beta",dn="gemini-1.5-flash",un="text-embedding-004";async function pn(e,t){if(!e)throw new Error("Gemini API key is required");if(!t.abstract)throw new Error("Paper abstract is required for summarization");const n="You are a research assistant helping to summarize scientific papers. Analyze the following paper and provide:\n1. A concise summary (2-3 sentences) of the main findings and significance\n2. 3-5 key findings or takeaways as bullet points\n\nPaper Details:\nTitle: ".concat(t.title||"Unknown","\nAuthors: ").concat(t.authors||"Unknown","\nJournal: ").concat(t.journal||"Unknown"," (").concat(t.year||"Unknown",")\n\nAbstract:\n").concat(t.abstract,'\n\nRespond in JSON format only, no additional text:\n{\n  "summary": "Your 2-3 sentence summary here",\n  "keyFindings": ["Finding 1", "Finding 2", "Finding 3"]\n}');try{var a,r,o,i,l;const t=await fetch("".concat(cn,"/models/").concat(dn,":generateContent?key=").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:n}]}],generationConfig:{temperature:.3,maxOutputTokens:1024}})});if(!t.ok){var s,c,d;const e=await t.json().catch(()=>({}));if(400===t.status&&null!==(s=e.error)&&void 0!==s&&null!==(c=s.message)&&void 0!==c&&c.includes("API key"))throw new Error("Invalid API key. Please check your Gemini API key.");if(429===t.status)throw new Error("Rate limit exceeded. Please try again in a moment.");throw new Error((null===(d=e.error)||void 0===d?void 0:d.message)||"API error: ".concat(t.status))}const p=null===(a=(await t.json()).candidates)||void 0===a||null===(r=a[0])||void 0===r||null===(o=r.content)||void 0===o||null===(i=o.parts)||void 0===i||null===(l=i[0])||void 0===l?void 0:l.text;if(!p)throw new Error("No response from Gemini API");try{const e=p.match(/\{[\s\S]*\}/);if(!e)throw new Error("Could not parse response");const t=JSON.parse(e[0]);return{summary:t.summary||"",keyFindings:t.keyFindings||[],generatedAt:(new Date).toISOString(),modelUsed:dn}}catch(u){return{summary:p.trim(),keyFindings:[],generatedAt:(new Date).toISOString(),modelUsed:dn}}}catch(p){if("TypeError"===p.name&&p.message.includes("fetch"))throw new Error("Network error. Please check your internet connection.");throw p}}async function mn(e,t,n){const a=[];for(let o=0;o<t.length;o++){const i=t[o];n&&n(o+1,t.length);try{const t=await pn(e,i);a.push({id:i.id,success:!0,summary:t})}catch(r){a.push({id:i.id,success:!1,error:r.message})}o<t.length-1&&await new Promise(e=>setTimeout(e,300))}return a}async function hn(e,t){if(!e)throw new Error("Gemini API key is required");if(!t||"string"!==typeof t)throw new Error("Text is required for embedding");const n=t.slice(0,25e3);try{var a;const t=await fetch("".concat(cn,"/models/").concat(un,":embedContent?key=").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"models/".concat(un),content:{parts:[{text:n}]}})});if(!t.ok){var r,o,i;const e=await t.json().catch(()=>({}));if(400===t.status&&null!==(r=e.error)&&void 0!==r&&null!==(o=r.message)&&void 0!==o&&o.includes("API key"))throw new Error("Invalid API key. Please check your Gemini API key.");if(429===t.status)throw new Error("Rate limit exceeded. Please try again in a moment.");throw new Error((null===(i=e.error)||void 0===i?void 0:i.message)||"API error: ".concat(t.status))}return(null===(a=(await t.json()).embedding)||void 0===a?void 0:a.values)||[]}catch(l){if("TypeError"===l.name&&l.message.includes("fetch"))throw new Error("Network error. Please check your internet connection.");throw l}}async function gn(e,t,n){if(!e)throw new Error("Gemini API key is required");if(!t||!Array.isArray(t)||0===t.length)throw new Error("Texts array is required");const a=[];for(let o=0;o<t.length;o+=10){const i=t.slice(o,o+10);n&&n(Math.min(o+10,t.length),t.length);for(const t of i){try{const n=await hn(e,t);a.push(n)}catch(r){a.push(null),console.error("Gemini embedding error:",r)}await new Promise(e=>setTimeout(e,50))}o+10<t.length&&await new Promise(e=>setTimeout(e,100))}return a}async function fn(e){if(!e)throw new Error("API key is required");try{const t=await fetch("".concat(cn,"/models?key=").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(400===t.status||403===t.status)throw new Error("Invalid API key");return t.ok}catch(t){if("Invalid API key"===t.message)throw t;throw new Error("Could not validate API key. Please check your connection.")}}function vn(){return 768}function yn(){return!0}const bn="embeddings";let xn=null;async function kn(){return xn||new Promise((e,t)=>{const n=indexedDB.open("research-dashboard-embeddings",1);n.onerror=()=>{console.error("Failed to open IndexedDB:",n.error),t(n.error)},n.onsuccess=()=>{xn=n.result,e(xn)},n.onupgradeneeded=e=>{const t=e.target.result;if(!t.objectStoreNames.contains(bn)){const e=t.createObjectStore(bn,{keyPath:"id"});e.createIndex("contentType","contentType",{unique:!1}),e.createIndex("contentId","contentId",{unique:!1}),e.createIndex("projectId","projectId",{unique:!1}),e.createIndex("lastUpdated","lastUpdated",{unique:!1})}}})}async function jn(){const e=await kn();return new Promise((t,n)=>{const a=e.transaction([bn],"readwrite").objectStore(bn).clear();a.onsuccess=()=>t(),a.onerror=()=>n(a.error)})}async function wn(){const e=await kn();return new Promise((t,n)=>{const a=e.transaction([bn],"readonly").objectStore(bn).getAll();a.onsuccess=()=>{const e=a.result||[],n={totalCount:e.length,byType:{},lastUpdated:null};e.forEach(e=>{n.byType[e.contentType]=(n.byType[e.contentType]||0)+1,(!n.lastUpdated||e.lastUpdated>n.lastUpdated)&&(n.lastUpdated=e.lastUpdated)}),t(n)},a.onerror=()=>n(a.error)})}async function Sn(e,t){const n=await async function(e){const t=await kn();return new Promise((n,a)=>{const r=t.transaction([bn],"readonly").objectStore(bn).get(e);r.onsuccess=()=>n(r.result||null),r.onerror=()=>a(r.error)})}(e);return n&&n.checksum===t}const Nn=e=>{const t=new Date;return t.setDate(t.getDate()+e),t.toISOString().split("T")[0]},Cn=[{id:"cart",title:"CAR-T Cell Optimization",subtitle:"Adoptive Cell Therapy",color:"#2E7D32",icon:"cart",description:"Engineering next-generation CAR-T cells with enhanced persistence and reduced exhaustion for solid tumor targeting.",hypothesis:"Incorporation of a 4-1BB costimulatory domain combined with IL-15 cytokine support will enhance CAR-T cell persistence and anti-tumor efficacy in solid tumor models.",aims:["Aim 1: Design and validate novel CAR constructs with modified signaling domains","Aim 2: Evaluate CAR-T expansion protocols using IL-15 vs IL-2 supplementation","Aim 3: Assess anti-tumor efficacy in xenograft models of pancreatic adenocarcinoma"],approaches:["Lentiviral Transduction","Flow Cytometry","Xenograft Models","Cytokine Analysis"],tasks:{backlog:[{id:"cart-1",title:"Design 3rd generation CAR construct with 4-1BB/CD28 domains",priority:"high",description:"Clone new CAR construct into lentiviral backbone"},{id:"cart-2",title:"Order IL-15 superagonist (ALT-803)",priority:"medium",description:"Contact vendor for quote and delivery timeline"},{id:"cart-3",title:"Establish PANC-1 xenograft model in NSG mice",priority:"high",description:"Tumor implantation and growth kinetics"}],inProgress:[{id:"cart-4",title:"T-cell isolation from healthy donor PBMCs",priority:"high",dueDate:Nn(3),description:"Ficoll separation and CD3+ enrichment"},{id:"cart-5",title:"Lentivirus production for CAR transduction",priority:"high",dueDate:Nn(7),description:"293T transfection with packaging plasmids"}],review:[{id:"cart-6",title:"Flow cytometry panel for T-cell exhaustion markers",priority:"medium",dueDate:Nn(5),description:"PD-1, TIM-3, LAG-3, TOX staining protocol"}],done:[{id:"cart-7",title:"IRB approval for healthy donor blood collection",priority:"high",description:"Protocol #2024-0892 approved"},{id:"cart-8",title:"CAR construct sequence verification",priority:"medium",description:"Sanger sequencing confirmed correct insert"}]}},{id:"crispr",title:"CRISPR Screen for Drug Resistance",subtitle:"Functional Genomics",color:"#1565C0",icon:"crispr",description:"Genome-wide CRISPR knockout screen to identify genetic determinants of chemotherapy resistance in triple-negative breast cancer.",hypothesis:"Systematic CRISPR-Cas9 knockout screening will reveal novel synthetic lethal interactions that can be exploited to overcome paclitaxel resistance.",aims:["Aim 1: Perform genome-wide CRISPR screen in paclitaxel-treated MDA-MB-231 cells","Aim 2: Validate top candidate genes using individual sgRNA knockouts","Aim 3: Characterize mechanism of resistance for lead candidates"],approaches:["CRISPR-Cas9","NGS Analysis","Drug Synergy Assays","Western Blot"],tasks:{backlog:[{id:"crispr-1",title:"Optimize Cas9 delivery efficiency in MDA-MB-231",priority:"high",description:"Test electroporation vs lentiviral delivery"},{id:"crispr-2",title:"Establish IC50 for paclitaxel selection",priority:"medium",description:"Dose-response curve over 72h"},{id:"crispr-3",title:"Plan validation experiments for top 50 hits",priority:"medium",description:"Individual sgRNA cloning strategy"}],inProgress:[{id:"crispr-4",title:"Brunello library amplification",priority:"high",dueDate:Nn(2),description:"Electroporate into electrocompetent cells"},{id:"crispr-5",title:"NGS sample prep for screen readout",priority:"high",dueDate:Nn(10),description:"PCR amplify sgRNA from genomic DNA"}],review:[{id:"crispr-6",title:"MAGeCK analysis pipeline setup",priority:"medium",dueDate:Nn(14),description:"Configure analysis parameters for hit calling"}],done:[{id:"crispr-7",title:"Brunello library QC (plasmid representation)",priority:"high",description:"NGS confirmed >90% guide representation"},{id:"crispr-8",title:"Cas9-stable MDA-MB-231 cell line generation",priority:"high",description:"Clonal selection complete, confirmed editing"},{id:"crispr-9",title:"Bioinformatics pipeline installation",priority:"medium",description:"MAGeCK and STARS installed on cluster"}]}},{id:"tme",title:"Tumor Microenvironment Profiling",subtitle:"Spatial Transcriptomics",color:"#7B1FA2",icon:"tme",description:"Characterizing immune cell spatial organization in the tumor microenvironment using multiplexed imaging and spatial transcriptomics.",hypothesis:"Spatial proximity of CD8+ T-cells to tumor cells predicts response to immune checkpoint blockade in melanoma patients.",aims:["Aim 1: Develop 40-plex CODEX antibody panel for TME characterization","Aim 2: Perform spatial transcriptomics on pre-treatment melanoma biopsies","Aim 3: Correlate spatial features with clinical response to anti-PD-1 therapy"],approaches:["CODEX Imaging","10x Visium","Digital Pathology","Machine Learning"],tasks:{backlog:[{id:"tme-1",title:"Validate CODEX antibody panel on tonsil controls",priority:"high",description:"Test each antibody for specificity and signal"},{id:"tme-2",title:"Coordinate sample acquisition with pathology",priority:"medium",description:"FFPE blocks from melanoma biobank"},{id:"tme-3",title:"Set up QuPath analysis pipeline",priority:"medium",description:"Cell segmentation and phenotyping workflow"}],inProgress:[{id:"tme-4",title:"CODEX antibody conjugation",priority:"high",dueDate:Nn(5),description:"Conjugate 20 antibodies to metal-tagged oligos"},{id:"tme-5",title:"Visium spatial transcriptomics - first cohort",priority:"high",dueDate:Nn(12),description:"10 samples, permeabilization optimization"}],review:[{id:"tme-6",title:"Spatial analysis R package evaluation",priority:"low",dueDate:Nn(8),description:"Compare Seurat vs Giotto vs squidpy"}],done:[{id:"tme-7",title:"IRB amendment for archival tissue use",priority:"high",description:"Amendment approved for retrospective analysis"},{id:"tme-8",title:"CODEX instrument training completed",priority:"medium",description:"Core facility certification obtained"}]}},{id:"scrna",title:"Single-Cell Atlas of Leukemia",subtitle:"Computational Biology",color:"#E65100",icon:"scrna",description:"Building a comprehensive single-cell transcriptomic atlas of acute myeloid leukemia to identify therapy-resistant cell populations.",hypothesis:"Leukemic stem cells with a distinct transcriptional signature persist after chemotherapy and drive relapse.",aims:["Aim 1: Generate scRNA-seq profiles from 50 AML patient samples at diagnosis","Aim 2: Identify and characterize therapy-resistant cell populations","Aim 3: Develop gene signature for predicting relapse risk"],approaches:["10x Chromium","Scanpy/Seurat","Trajectory Analysis","Gene Signature Modeling"],tasks:{backlog:[{id:"scrna-1",title:"Establish sample processing SOP for bone marrow",priority:"high",description:"Viability and doublet rate optimization"},{id:"scrna-2",title:"Set up CellRanger pipeline on HPC cluster",priority:"medium",description:"Request allocation and install software"},{id:"scrna-3",title:"Design CITE-seq antibody panel for surface markers",priority:"medium",description:"CD34, CD38, CD123, CD45RA panel"}],inProgress:[{id:"scrna-4",title:"Process first batch of 10 AML samples",priority:"high",dueDate:Nn(4),description:"10x library prep and QC"},{id:"scrna-5",title:"Develop Scanpy analysis pipeline",priority:"high",dueDate:Nn(9),description:"QC, clustering, annotation workflow"}],review:[{id:"scrna-6",title:"Literature review on AML LSC signatures",priority:"medium",dueDate:Nn(6),description:"Compile published gene sets for validation"},{id:"scrna-7",title:"Statistical analysis plan for relapse prediction",priority:"high",dueDate:Nn(11),description:"Machine learning approach selection"}],done:[{id:"scrna-8",title:"Patient consent and sample collection protocol",priority:"high",description:"IRB-approved, accrual initiated"},{id:"scrna-9",title:"10x Chromium training completed",priority:"medium",description:"Certified for independent use"},{id:"scrna-10",title:"Reference dataset download (van Galen AML atlas)",priority:"low",description:"Downloaded for integration analysis"}]}}],En=(0,l.createContext)(null),In="research-dashboard-custom-projects",Dn="research-dashboard-embeddings-provider",Tn={PROJECT:"project",TASK:"task",NOTEBOOK:"notebook",REFERENCE:"reference",PROTOCOL:"protocol",RESULT:"result",NOTE:"note"},An=e=>{switch(e){case Wt.OPENAI:return a;case Wt.GEMINI:return r;default:return a}};function Pn(e){let{children:t}=e;const{getApiKeyForProvider:n,hasKeyForProvider:a,embeddingsProvider:r,getAvailableProvidersForEmbeddings:o}=Jt(),[i,s]=(0,l.useState)(()=>localStorage.getItem(Dn)||Wt.OPENAI),c=(0,l.useCallback)(()=>o().length>0,[o]),[d,u]=(0,l.useState)({isIndexing:!1,progress:0,total:0,currentType:""}),[p,m]=(0,l.useState)(null),[h,g]=(0,l.useState)(0),[f,v]=(0,l.useState)(!1),y=(0,l.useRef)(!1);(0,l.useEffect)(()=>{(async()=>{try{await kn();const e=await wn();g(e.totalCount),m(e.lastUpdated?new Date(e.lastUpdated):null),v(!0)}catch(e){console.error("Failed to initialize embeddings database:",e),v(!0)}})()},[]);const b=(0,l.useCallback)(function(e,t){var n;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";switch(e){case Tn.PROJECT:return"".concat(t.title," ").concat(t.subtitle||""," ").concat(t.description||"").trim();case Tn.TASK:return"".concat(t.title," ").concat(t.description||""," Project: ").concat(a).trim();case Tn.NOTEBOOK:return"".concat(t.title," ").concat(t.content||""," Tags: ").concat((t.tags||[]).join(" ")).trim();case Tn.REFERENCE:return"".concat(t.title," ").concat(t.authors||""," ").concat(t.abstract||""," ").concat(t.notes||""," ").concat((null===(n=t.aiSummary)||void 0===n?void 0:n.summary)||""," Tags: ").concat((t.tags||[]).join(" ")).trim();case Tn.PROTOCOL:case Tn.RESULT:return"".concat(t.title," ").concat(t.description||""," Tags: ").concat((t.tags||[]).join(" ")).trim();case Tn.NOTE:return"".concat(t.title||""," ").concat(t.content||t.description||""," ").concat(t.rationale||""," ").concat(t.hypothesis||""," ").concat(t.approach||""," ").concat(t.expectedOutcomes||"").trim();default:return""}},[]),x=(0,l.useCallback)(()=>{const e=[];let t=[];try{const e=localStorage.getItem(In);e&&(t=JSON.parse(e))}catch(o){}const n=[...Cn,...t],a=new Set(t.map(e=>e.id));n.forEach(t=>{e.push({id:"project-".concat(t.id),contentType:Tn.PROJECT,contentId:t.id,projectId:t.id,title:t.title,text:b(Tn.PROJECT,t)})});let r={};try{const e=localStorage.getItem("research-dashboard-tasks");e&&(r=JSON.parse(e))}catch(i){}n.forEach(t=>{let n;n=a.has(t.id)?t.tasks:r[t.id]||t.tasks,n&&Object.entries(n).forEach(n=>{let[a,r]=n;Array.isArray(r)&&r.forEach(n=>{e.push({id:"task-".concat(n.id),contentType:Tn.TASK,contentId:n.id,projectId:t.id,title:n.title,column:a,text:b(Tn.TASK,n,t.title)})})})});try{const t=localStorage.getItem("research-dashboard-lab-notebook");if(t){JSON.parse(t).forEach(t=>{t.isArchived||e.push({id:"notebook-".concat(t.id),contentType:Tn.NOTEBOOK,contentId:t.id,projectId:t.projectId,title:t.title,text:b(Tn.NOTEBOOK,t)})})}}catch(l){}try{const t=localStorage.getItem("research-dashboard-literature");if(t){const n=JSON.parse(t);Object.entries(n).forEach(t=>{let[n,a]=t;Array.isArray(a)&&a.forEach(t=>{e.push({id:"reference-".concat(t.id),contentType:Tn.REFERENCE,contentId:t.id,projectId:n,title:t.title,text:b(Tn.REFERENCE,t)})})})}}catch(s){}try{const t=localStorage.getItem("research-dashboard-protocols");if(t){const n=JSON.parse(t);Object.entries(n).forEach(t=>{let[n,a]=t;Array.isArray(a)&&a.forEach(t=>{e.push({id:"protocol-".concat(t.id),contentType:Tn.PROTOCOL,contentId:t.id,projectId:n,title:t.title,text:b(Tn.PROTOCOL,t)})})})}}catch(c){}try{const t=localStorage.getItem("research-dashboard-results");if(t){const n=JSON.parse(t);Object.entries(n).forEach(t=>{let[n,a]=t;Array.isArray(a)&&a.forEach(t=>{e.push({id:"result-".concat(t.id),contentType:Tn.RESULT,contentId:t.id,projectId:n,title:t.title,text:b(Tn.RESULT,t)})})})}}catch(d){}try{const t=localStorage.getItem("research-dashboard-research-notes");if(t){const n=JSON.parse(t);Object.entries(n).forEach(t=>{let[n,a]=t;a.background&&e.push({id:"note-background-".concat(n),contentType:Tn.NOTE,contentId:"background-".concat(n),projectId:n,title:"Background",text:b(Tn.NOTE,{content:a.background})}),Array.isArray(a.specificAims)&&a.specificAims.forEach(t=>{e.push({id:"note-aim-".concat(t.id),contentType:Tn.NOTE,contentId:t.id,projectId:n,title:t.title,text:b(Tn.NOTE,t)})}),Array.isArray(a.miscNotes)&&a.miscNotes.forEach(t=>{e.push({id:"note-misc-".concat(t.id),contentType:Tn.NOTE,contentId:t.id,projectId:n,title:t.title,text:b(Tn.NOTE,t)})})})}}catch(u){}return e},[b]),k=(0,l.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||r;if(!a(t)||y.current)return;t===i||e||(e=!0,await jn()),y.current=!0;const o=x(),l=[];for(const n of o){const t=nn(n.text),a=await Sn(n.id,t);!e&&a||l.push(Je(Je({},n),{},{checksum:t}))}if(0===l.length)return y.current=!1,void u({isIndexing:!1,progress:0,total:0,currentType:""});const c=Vt[t]||t;u({isIndexing:!0,progress:0,total:l.length,currentType:"Preparing with ".concat(c,"...")});try{const e=n(t),a=An(t),r=l.map(e=>e.text),o=await a.generateBatchEmbeddings(e,r,(e,t)=>{u(n=>Je(Je({},n),{},{progress:e,currentType:"Indexing ".concat(e,"/").concat(t," items with ").concat(c)}))}),i=l.map((e,n)=>({id:e.id,contentType:e.contentType,contentId:e.contentId,projectId:e.projectId,title:e.title,text:e.text,checksum:e.checksum,embedding:o[n],provider:t})).filter(e=>null!==e.embedding);i.length>0&&await async function(e){const t=await kn();return new Promise((n,a)=>{const r=t.transaction([bn],"readwrite"),o=r.objectStore(bn),i=(new Date).toISOString();e.forEach(e=>{o.put(Je(Je({},e),{},{lastUpdated:i}))}),r.oncomplete=()=>n(),r.onerror=()=>a(r.error)})}(i),s(t),localStorage.setItem(Dn,t);const d=await wn();g(d.totalCount),m(new Date),u({isIndexing:!1,progress:l.length,total:l.length,currentType:"Complete"})}catch(d){console.error("Indexing error:",d),u({isIndexing:!1,progress:0,total:0,currentType:"Error"})}y.current=!1},[r,a,n,i,x]),j=(0,l.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{contentTypes:r=null,projectId:o=null,limit:l=20,threshold:s=.35}=t,c=i;if(!e||!a(c))return[];try{const t=n(c),a=An(c),i=await a.generateEmbedding(t,e);let u=await async function(){const e=await kn();return new Promise((t,n)=>{const a=e.transaction([bn],"readonly").objectStore(bn).getAll();a.onsuccess=()=>t(a.result||[]),a.onerror=()=>n(a.error)})}();r&&r.length>0&&(u=u.filter(e=>r.includes(e.contentType))),o&&(u=u.filter(e=>e.projectId===o));const p=tn(i,u,l,s);let m=[];try{const e=localStorage.getItem(In);e&&(m=JSON.parse(e))}catch(d){}const h=[...Cn,...m],g=new Map(h.map(e=>[e.id,e.title]));return p.map(e=>Je(Je({},e),{},{projectTitle:g.get(e.projectId)||"Unknown Project"}))}catch(u){return console.error("Search error:",u),[]}},[i,a,n]),w=(0,l.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;await jn(),g(0),m(null),await k(!0,e)},[k]);(0,l.useEffect)(()=>{f&&c()&&0===h&&k()},[f,c,h,k]);const S={indexingStatus:d,lastIndexed:p,embeddingsCount:h,isInitialized:f,hasAnyEmbeddingsProvider:c,currentEmbeddingsProvider:i,indexAllContent:k,reindexAll:w,search:j,CONTENT_TYPES:Tn,PROVIDER_NAMES:Vt,AI_PROVIDERS:Wt};return(0,He.jsx)(En.Provider,{value:S,children:t})}const On=(0,l.createContext)(null),Ln="research-dashboard-trash",Rn={PROJECT:"project",TASK:"task",REFERENCE:"reference",NOTEBOOK_ENTRY:"notebook_entry",PROTOCOL:"protocol",RESULT:"result",NOTE:"note"};function Mn(e){let{children:t}=e;const n=St(),[a,r]=(0,l.useState)([]),[o,i]=(0,l.useState)(!1);(0,l.useEffect)(()=>{try{const e=localStorage.getItem(Ln);if(e){const t=JSON.parse(e),n=new Date,a=t.filter(e=>{const t=new Date(e.deletedAt);return(n-t)/864e5<30});r(a),a.length!==t.length&&localStorage.setItem(Ln,JSON.stringify(a))}}catch(Fr){console.error("Failed to load trash:",Fr)}},[]);const s=(0,l.useCallback)(e=>{try{localStorage.setItem(Ln,JSON.stringify(e)),r(e),n()}catch(Fr){console.error("Failed to save trash:",Fr)}},[n]),c=(0,l.useCallback)(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={id:"trash-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e,originalId:t.id,data:t,metadata:Je(Je({},n),{},{originalLocation:n.projectId||n.location||"unknown"}),deletedAt:(new Date).toISOString()};return s([r,...a]),r.id},[a,s]),d=(0,l.useCallback)(e=>{const t=a.find(t=>t.id===e);if(!t)return null;const n=a.filter(t=>t.id!==e);return s(n),t},[a,s]),u=(0,l.useCallback)(e=>{const t=a.filter(t=>t.id!==e);s(t)},[a,s]),p=(0,l.useCallback)(()=>{s([])},[s]),m=(0,l.useCallback)(e=>a.filter(t=>t.type===e),[a]),h=(0,l.useCallback)(e=>{const t=new Date(e),n=(new Date-t)/864e5;return Math.max(0,Math.ceil(30-n))},[]),g=(0,l.useCallback)(()=>i(!0),[]),f=(0,l.useCallback)(()=>i(!1),[]),v={trashedItems:a,isTrashOpen:o,moveToTrash:c,restoreFromTrash:d,permanentlyDelete:u,emptyTrash:p,getTrashByType:m,getDaysUntilExpiry:h,openTrash:g,closeTrash:f,TRASH_ITEM_TYPES:Rn};return(0,He.jsx)(On.Provider,{value:v,children:t})}function Fn(){const e=(0,l.useContext)(On);if(!e)throw new Error("useTrash must be used within TrashProvider");return e}class Un extends l.Component{constructor(e){super(e),this.handleReload=()=>{window.location.reload()},this.handleClearAndReload=()=>{if(window.confirm("This will clear cached data and reload the app. Your synced data in Google Drive will be preserved. Continue?")){const e={};["research-dashboard-api-keys","research-dashboard-ai-providers","research-dashboard-google-auth"].forEach(t=>{const n=localStorage.getItem(t);n&&(e[t]=n)}),localStorage.clear(),Object.entries(e).forEach(e=>{let[t,n]=e;localStorage.setItem(t,n)}),window.location.reload()}},this.handleExportData=()=>{try{const t={};for(let o=0;o<localStorage.length;o++){const n=localStorage.key(o);if(n.startsWith("research-dashboard-"))try{t[n]=JSON.parse(localStorage.getItem(n))}catch(e){t[n]=localStorage.getItem(n)}}const n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),a=URL.createObjectURL(n),r=document.createElement("a");r.href=a,r.download="research-dashboard-emergency-backup-".concat((new Date).toISOString().split("T")[0],".json"),r.click(),URL.revokeObjectURL(a)}catch(Fr){alert("Failed to export data: "+Fr.message)}},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),console.error("ErrorBoundary caught an error:",e,t);try{const n={timestamp:(new Date).toISOString(),error:e.toString(),componentStack:t.componentStack,url:window.location.href},a=JSON.parse(localStorage.getItem("research-dashboard-error-logs")||"[]");a.unshift(n),localStorage.setItem("research-dashboard-error-logs",JSON.stringify(a.slice(0,5)))}catch(Fr){console.error("Failed to log error:",Fr)}}render(){return this.state.hasError?(0,He.jsx)("div",{className:"error-boundary-container",children:(0,He.jsxs)("div",{className:"error-boundary-content",children:[(0,He.jsx)("div",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,He.jsx)("h1",{children:"Something went wrong"}),(0,He.jsx)("p",{className:"error-message",children:"The application encountered an unexpected error. Your data should be safe."}),(0,He.jsxs)("div",{className:"error-actions",children:[(0,He.jsx)("button",{className:"error-btn primary",onClick:this.handleReload,children:"Reload Application"}),(0,He.jsx)("button",{className:"error-btn secondary",onClick:this.handleExportData,children:"Export Data Backup"}),(0,He.jsx)("button",{className:"error-btn danger",onClick:this.handleClearAndReload,children:"Clear Cache & Reload"})]}),!1,(0,He.jsx)("p",{className:"error-help",children:'If this problem persists, try exporting your data backup first, then use "Clear Cache & Reload". Your Google Drive synced data will be restored.'})]})}):this.props.children}}const _n=Un,zn={project:{label:"Projects",icon:"\ud83d\udcc1",color:"#3498db"},task:{label:"Tasks",icon:"\u2713",color:"#27ae60"},notebook:{label:"Lab Notebook",icon:"\ud83d\udcd3",color:"#9b59b6"},reference:{label:"Literature",icon:"\ud83d\udcda",color:"#e67e22"},protocol:{label:"Protocols",icon:"\ud83d\udccb",color:"#1abc9c"},result:{label:"Results",icon:"\ud83d\udcca",color:"#e74c3c"},note:{label:"Notes",icon:"\ud83d\udcdd",color:"#f39c12"}};const Bn=function(e){let{isOpen:t,onClose:n}=e;const[a,r]=(0,l.useState)(""),[o,i]=(0,l.useState)("all"),[s,c]=(0,l.useState)("all"),[d,u]=(0,l.useState)({keyword:[],semantic:[]}),[p,m]=(0,l.useState)("semantic"),[h,g]=(0,l.useState)(!1),f=(0,l.useRef)(null),v=(0,l.useRef)(null),y=se(),{openSettings:b,hasKeyForProvider:x,getAvailableProvidersForEmbeddings:k,embeddingsProvider:j}=Jt(),{search:w,indexingStatus:S,embeddingsCount:N,indexAllContent:C,reindexAll:E,CONTENT_TYPES:I,hasAnyEmbeddingsProvider:D,currentEmbeddingsProvider:T}=function(){const e=(0,l.useContext)(En);if(!e)throw new Error("useSemanticSearch must be used within SemanticSearchProvider");return e}(),[A,P]=(0,l.useState)(j),O=D();(0,l.useEffect)(()=>{t&&f.current&&f.current.focus()},[t]);const L=(0,l.useCallback)(e=>{if(!e.trim())return[];const t=e.toLowerCase(),n=[];let a=[];try{const e=localStorage.getItem("research-dashboard-custom-projects");e&&(a=JSON.parse(e))}catch(l){}const r=new Set(a.map(e=>e.id)),i=[...Cn,...a];if("all"!==o&&"project"!==o||i.forEach(e=>{var a,r;(e.title.toLowerCase().includes(t)||null!==(a=e.subtitle)&&void 0!==a&&a.toLowerCase().includes(t)||null!==(r=e.description)&&void 0!==r&&r.toLowerCase().includes(t))&&n.push({id:"project-".concat(e.id),contentType:"project",contentId:e.id,projectId:e.id,title:e.title,subtitle:e.subtitle,projectTitle:e.title,color:e.color})}),"all"===o||"task"===o){let e={};try{const t=localStorage.getItem("research-dashboard-tasks");t&&(e=JSON.parse(t))}catch(c){}i.forEach(a=>{let o;o=r.has(a.id)?a.tasks:e[a.id]||a.tasks,o&&Object.entries(o).forEach(e=>{let[r,o]=e;Array.isArray(o)&&o.forEach(e=>{var o;const i=e.title.toLowerCase().includes(t)||(null===(o=e.description)||void 0===o?void 0:o.toLowerCase().includes(t)),l="all"===s||e.priority===s;i&&l&&n.push({id:"task-".concat(e.id),contentType:"task",contentId:e.id,projectId:a.id,title:e.title,projectTitle:a.title,column:r,priority:e.priority})})})})}return n},[o,s]),R=(0,l.useCallback)(async e=>{if(!e.trim()||!O)return[];let t=null;"all"!==o&&(t=[o]),g(!0);try{return await w(e,{contentTypes:t,limit:30,threshold:.3})}catch(n){return console.error("Semantic search error:",n),[]}finally{g(!1)}},[o,O,w]);(0,l.useEffect)(()=>{if(!a.trim())return void u({keyword:[],semantic:[]});const e=L(a);return v.current&&clearTimeout(v.current),"semantic"===p&&O?(u({keyword:e,semantic:[]}),v.current=setTimeout(async()=>{const t=await R(a);u({keyword:e,semantic:t})},500)):u({keyword:e,semantic:[]}),()=>{v.current&&clearTimeout(v.current)}},[a,p,O,L,R]);const M="semantic"===p&&O&&d.semantic.length>0?d.semantic:d.keyword;return t?(0,He.jsx)("div",{className:"search-overlay",onClick:n,children:(0,He.jsxs)("div",{className:"search-modal semantic-search-modal",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"search-header",children:[(0,He.jsxs)("div",{className:"search-input-wrapper",children:[(0,He.jsx)("span",{className:"search-icon",children:"\ud83d\udd0d"}),(0,He.jsx)("input",{ref:f,type:"text",className:"search-input",placeholder:"semantic"===p?"Search semantically across all content...":"Search by keyword...",value:a,onChange:e=>r(e.target.value)}),a&&(0,He.jsx)("button",{className:"search-clear",onClick:()=>r(""),children:"\xd7"})]}),(0,He.jsx)("button",{className:"search-close",onClick:n,children:"ESC"})]}),(0,He.jsxs)("div",{className:"search-mode-toggle",children:[(0,He.jsx)("button",{className:"mode-btn ".concat("keyword"===p?"active":""),onClick:()=>m("keyword"),children:"Keyword"}),(0,He.jsxs)("button",{className:"mode-btn ".concat("semantic"===p?"active":""),onClick:()=>{O?m("semantic"):b()},title:O?"AI-powered semantic search":"Configure an API key for semantic search",children:["Semantic",!O&&(0,He.jsx)("span",{className:"mode-badge",children:"Setup"})]}),"semantic"===p&&O&&(0,He.jsx)("div",{className:"indexing-status",children:S.isIndexing?(0,He.jsx)("span",{className:"indexing-active",children:S.currentType||"Indexing ".concat(S.progress,"/").concat(S.total,"...")}):(0,He.jsxs)("span",{className:"indexing-count",children:[N," items (",Vt[T]||"Unknown",")",(0,He.jsxs)("div",{className:"provider-reindex-group",children:[(0,He.jsx)("select",{className:"provider-select-mini",value:A,onChange:e=>P(e.target.value),title:"Select embeddings provider",children:Object.values(Wt).filter(e=>{var t;return null===(t=qt[e])||void 0===t?void 0:t.embeddings}).map(e=>(0,He.jsx)("option",{value:e,disabled:!x(e),children:Vt[e]},e))}),(0,He.jsx)("button",{className:"reindex-btn",onClick:()=>E(A),disabled:S.isIndexing||!x(A),title:"Reindex with ".concat(Vt[A]),children:"\u21bb"})]})]})})]}),(0,He.jsxs)("div",{className:"search-filters",children:[(0,He.jsxs)("div",{className:"filter-group content-type-filters",children:[(0,He.jsx)("button",{className:"filter-btn ".concat("all"===o?"active":""),onClick:()=>i("all"),children:"All"}),Object.entries(zn).map(e=>{let[t,n]=e;return(0,He.jsx)("button",{className:"filter-btn ".concat(o===t?"active":""),onClick:()=>i(t),title:n.label,children:n.icon},t)})]}),("all"===o||"task"===o)&&(0,He.jsx)("div",{className:"filter-group",children:(0,He.jsxs)("select",{className:"priority-filter",value:s,onChange:e=>c(e.target.value),children:[(0,He.jsx)("option",{value:"all",children:"All Priorities"}),(0,He.jsx)("option",{value:"high",children:"High"}),(0,He.jsx)("option",{value:"medium",children:"Medium"}),(0,He.jsx)("option",{value:"low",children:"Low"})]})})]}),(0,He.jsxs)("div",{className:"search-results",children:[!a&&(0,He.jsxs)("div",{className:"search-placeholder",children:[(0,He.jsx)("p",{children:"semantic"===p?"Search by meaning across all your research content":"Start typing to search by keyword"}),(0,He.jsx)("div",{className:"search-tips",children:"semantic"===p?(0,He.jsx)("span",{children:'\ud83d\udca1 Try: "experiments about cell proliferation" or "papers on immunotherapy"'}):(0,He.jsx)("span",{children:"\ud83d\udca1 Search by task title, project name, or description"})})]}),h&&(0,He.jsxs)("div",{className:"search-loading",children:[(0,He.jsx)("span",{className:"loading-spinner",children:"\u27f3"}),(0,He.jsx)("span",{children:"Searching..."})]}),a&&!h&&0===M.length&&(0,He.jsxs)("div",{className:"search-no-results",children:[(0,He.jsxs)("p",{children:['No results found for "',a,'"']}),"semantic"===p&&0===N&&(0,He.jsxs)("p",{className:"no-results-hint",children:["No content indexed yet.",(0,He.jsx)("button",{onClick:()=>C(),children:"Index now"})]})]}),M.length>0&&(0,He.jsxs)("div",{className:"results-section semantic-results",children:[(0,He.jsxs)("h3",{children:["semantic"===p&&O?"Semantic Results (".concat(Vt[T]||"AI",")"):"Results","(",M.length,")"]}),M.map((e,t)=>{const a=zn[e.contentType]||{};return(0,He.jsxs)("div",{className:"search-result-item",onClick:()=>(e=>{"project"===e.contentType?y("/project/".concat(e.contentId)):y("/project/".concat(e.projectId)),n()})(e),children:[(0,He.jsx)("div",{className:"result-type-icon",style:{backgroundColor:a.color||"#666"},title:a.label,children:a.icon||"?"}),(0,He.jsxs)("div",{className:"result-content",children:[(0,He.jsx)("span",{className:"result-title",children:e.title}),(0,He.jsxs)("span",{className:"result-meta",children:[e.projectTitle,e.column&&" \u2022 ".concat(e.column),e.priority&&(0,He.jsx)("span",{className:"priority-badge ".concat(e.priority),children:e.priority})]})]}),void 0!==e.similarity&&(0,He.jsxs)("div",{className:"similarity-score",title:"Relevance score",children:[Math.round(100*e.similarity),"%"]})]},e.id||t)})]})]})]})}):null},Gn="research-dashboard-gist-config";const Wn=function(e){let{isOpen:t,onClose:n,tasks:a}=e;const[r,o]=(0,l.useState)(""),[i,s]=(0,l.useState)(null),[c,d]=(0,l.useState)(!1),[u,p]=(0,l.useState)({message:"",type:""}),[m,h]=(0,l.useState)(!1);(0,l.useEffect)(()=>{const e=localStorage.getItem(Gn);if(e)try{const t=JSON.parse(e);s(t),t.token&&o(t.token)}catch(Fr){console.error("Failed to load gist config:",Fr)}},[]);const g=(0,l.useCallback)(async()=>{if(!r)return p({message:"Please enter your GitHub token first",type:"error"}),void h(!0);d(!0),p({message:"Publishing calendar...",type:"info"});const e=(e=>{const t=new Date,n=e=>e.replace(/\\/g,"\\\\").replace(/;/g,"\\;").replace(/,/g,"\\,").replace(/\n/g,"\\n");let a=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//KanLab//Tasks//EN","CALSCALE:GREGORIAN","METHOD:PUBLISH","X-WR-CALNAME:KanLab Tasks","X-WR-TIMEZONE:UTC","REFRESH-INTERVAL;VALUE=DURATION:PT1H","X-PUBLISHED-TTL:PT1H"];return e.forEach(e=>{if(!e.dueDate)return;const r="".concat(e.id,"@research-dashboard"),o=t.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z",i=e.dueDate.replace(/-/g,""),l=n(e.title),s=n("Project: ".concat(e.projectTitle,"\\nStatus: ").concat(e.column,"\\nPriority: ").concat(e.priority||"medium"));a.push("BEGIN:VEVENT"),a.push("UID:".concat(r)),a.push("DTSTAMP:".concat(o)),a.push("DTSTART;VALUE=DATE:".concat(i)),a.push("DTEND;VALUE=DATE:".concat(i)),a.push("SUMMARY:".concat(l)),a.push("DESCRIPTION:".concat(s)),a.push("CATEGORIES:".concat(n(e.projectTitle))),"high"===e.priority?a.push("PRIORITY:1"):"low"===e.priority?a.push("PRIORITY:9"):a.push("PRIORITY:5"),a.push("END:VEVENT")}),a.push("END:VCALENDAR"),a.join("\r\n")})(a);try{let t;const n={description:"KanLab Tasks Calendar",public:!1,files:{"research-dashboard-tasks.ics":{content:e}}};if(t=null!==i&&void 0!==i&&i.gistId?await fetch("https://api.github.com/gists/".concat(i.gistId),{method:"PATCH",headers:{Authorization:"token ".concat(r),"Content-Type":"application/json",Accept:"application/vnd.github.v3+json"},body:JSON.stringify(n)}):await fetch("https://api.github.com/gists",{method:"POST",headers:{Authorization:"token ".concat(r),"Content-Type":"application/json",Accept:"application/vnd.github.v3+json"},body:JSON.stringify(n)}),!t.ok){const e=await t.json();throw new Error(e.message||"Failed to publish to GitHub")}const a=await t.json(),o=a.files["research-dashboard-tasks.ics"].raw_url.replace(/\/raw\/[a-f0-9]+\//,"/raw/"),l=o.replace("https://","webcal://"),c={gistId:a.id,gistUrl:a.html_url,rawUrl:o,webcalUrl:l,token:r,lastPublished:(new Date).toISOString()};localStorage.setItem(Gn,JSON.stringify(c)),s(c),p({message:null!==i&&void 0!==i&&i.gistId?"Calendar updated successfully!":"Calendar published successfully!",type:"success"})}catch(t){if(console.error("Publish error:",t),t.message.includes("401")||t.message.includes("Bad credentials"))p({message:"Invalid GitHub token. Please check your token and try again.",type:"error"}),h(!0);else if(t.message.includes("404")){s(null),localStorage.removeItem(Gn),p({message:"Previous gist not found. Click Publish to create a new one.",type:"warning"})}else p({message:"Error: ".concat(t.message),type:"error"})}finally{d(!1)}},[r,i,a]),f=(0,l.useCallback)((e,t)=>{navigator.clipboard.writeText(e).then(()=>{p({message:"".concat(t," copied to clipboard!"),type:"success"}),setTimeout(()=>p({message:"",type:""}),2e3)})},[]),v=(0,l.useCallback)(()=>{window.confirm("This will disconnect the calendar subscription. You will need to set it up again. Continue?")&&(localStorage.removeItem(Gn),s(null),o(""),p({message:"Calendar subscription disconnected",type:"info"}))},[]);return t?(0,He.jsx)("div",{className:"calendar-publish-overlay",onClick:n,children:(0,He.jsxs)("div",{className:"calendar-publish-modal",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"publish-header",children:[(0,He.jsx)("h3",{children:"Publish Calendar for Subscription"}),(0,He.jsx)("button",{className:"modal-close",onClick:n,children:"\xd7"})]}),(0,He.jsxs)("div",{className:"publish-content",children:[i?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsxs)("div",{className:"publish-connected",children:[(0,He.jsxs)("div",{className:"connection-badge",children:[(0,He.jsx)("span",{className:"status-dot connected"}),"Calendar Published"]}),(0,He.jsxs)("p",{className:"last-published",children:["Last updated: ",new Date(i.lastPublished).toLocaleString()]})]}),(0,He.jsxs)("div",{className:"subscription-urls",children:[(0,He.jsxs)("div",{className:"url-group",children:[(0,He.jsx)("label",{children:"Webcal Subscription URL (for Google Calendar):"}),(0,He.jsxs)("div",{className:"url-display",children:[(0,He.jsx)("input",{type:"text",value:i.webcalUrl,readOnly:!0,className:"url-input"}),(0,He.jsx)("button",{className:"btn-copy",onClick:()=>f(i.webcalUrl,"Webcal URL"),children:"Copy"})]})]}),(0,He.jsxs)("div",{className:"url-group",children:[(0,He.jsx)("label",{children:"Direct .ics URL:"}),(0,He.jsxs)("div",{className:"url-display",children:[(0,He.jsx)("input",{type:"text",value:i.rawUrl,readOnly:!0,className:"url-input"}),(0,He.jsx)("button",{className:"btn-copy",onClick:()=>f(i.rawUrl,"ICS URL"),children:"Copy"})]})]})]}),(0,He.jsxs)("div",{className:"subscription-instructions",children:[(0,He.jsx)("h4",{children:"Subscribe in Google Calendar:"}),(0,He.jsxs)("ol",{children:[(0,He.jsxs)("li",{children:["Open ",(0,He.jsx)("a",{href:"https://calendar.google.com",target:"_blank",rel:"noopener noreferrer",children:"Google Calendar"})]}),(0,He.jsx)("li",{children:'Click the "+" next to "Other calendars" in the left sidebar'}),(0,He.jsx)("li",{children:'Select "From URL"'}),(0,He.jsx)("li",{children:"Paste the Webcal URL above"}),(0,He.jsx)("li",{children:'Click "Add calendar"'})]}),(0,He.jsxs)("p",{className:"sync-note",children:[(0,He.jsx)("strong",{children:"Note:"}),' Google Calendar syncs external calendars every 12-24 hours. Click "Update Calendar" after making changes to publish them.']})]}),(0,He.jsxs)("div",{className:"publish-actions",children:[(0,He.jsx)("button",{className:"btn-update",onClick:g,disabled:c,children:c?"Updating...":"Update Calendar"}),m&&(0,He.jsx)("div",{className:"token-update",children:(0,He.jsx)("input",{type:"password",value:r,onChange:e=>o(e.target.value),placeholder:"Enter new GitHub token",className:"token-input small"})}),(0,He.jsx)("button",{className:"btn-view-gist",onClick:()=>window.open(i.gistUrl,"_blank"),children:"View Gist"}),(0,He.jsx)("button",{className:"btn-disconnect",onClick:v,children:"Disconnect"})]}),(0,He.jsxs)("div",{className:"task-summary",children:[a.length," task",1!==a.length?"s":""," with due dates will be included"]})]}):(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("div",{className:"publish-intro",children:(0,He.jsx)("p",{children:'Publish your tasks to a GitHub Gist to get a webcal URL that Google Calendar can subscribe to. Changes are synced when you click "Publish".'})}),(0,He.jsxs)("div",{className:"token-setup",children:[(0,He.jsx)("h4",{children:"Step 1: Create a GitHub Personal Access Token"}),(0,He.jsxs)("ol",{children:[(0,He.jsxs)("li",{children:["Go to ",(0,He.jsx)("a",{href:"https://github.com/settings/tokens/new",target:"_blank",rel:"noopener noreferrer",children:"GitHub Token Settings"})]}),(0,He.jsx)("li",{children:'Give it a name like "KanLab Calendar"'}),(0,He.jsxs)("li",{children:["Select the ",(0,He.jsx)("code",{children:"gist"})," scope"]}),(0,He.jsx)("li",{children:'Click "Generate token" and copy it'})]}),(0,He.jsxs)("div",{className:"token-input-group",children:[(0,He.jsx)("label",{children:"GitHub Personal Access Token:"}),(0,He.jsx)("input",{type:"password",value:r,onChange:e=>o(e.target.value),placeholder:"ghp_xxxxxxxxxxxx",className:"token-input"}),(0,He.jsx)("p",{className:"token-note",children:"Your token is stored locally and only used to publish your calendar."})]}),(0,He.jsx)("h4",{children:"Step 2: Publish Your Calendar"}),(0,He.jsx)("button",{className:"btn-publish",onClick:g,disabled:c||!r,children:c?"Publishing...":"Publish Calendar"})]})]}),u.message&&(0,He.jsx)("div",{className:"publish-status ".concat(u.type),children:u.message})]})]})}):null},Vn="research-dashboard-calendar-events",qn=[{id:"blue",color:"#3498db",name:"Blue"},{id:"green",color:"#27ae60",name:"Green"},{id:"purple",color:"#9b59b6",name:"Purple"},{id:"orange",color:"#f39c12",name:"Orange"},{id:"red",color:"#e74c3c",name:"Red"},{id:"teal",color:"#00bcd4",name:"Teal"},{id:"pink",color:"#e91e63",name:"Pink"}],Kn=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=new Date,a=e=>e.replace(/-/g,""),r=e=>e.replace(/\\/g,"\\\\").replace(/;/g,"\\;").replace(/,/g,"\\,").replace(/\n/g,"\\n"),o=e=>e.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z",i=(e,t)=>{const n=a(e);if(t){const e=t.replace(/:/g,"")+"00";return"".concat(n,"T").concat(e)}return n};let l=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Research Dashboard//Tasks//EN","CALSCALE:GREGORIAN","METHOD:PUBLISH","X-WR-CALNAME:Research Dashboard Tasks","X-WR-TIMEZONE:UTC"];return e.forEach(e=>{if(!e.dueDate)return;const t="task-".concat(e.id,"@research-dashboard"),s=o(n),c=r(e.title),d=r("Project: ".concat(e.projectTitle,"\\nStatus: ").concat(e.column,"\\nPriority: ").concat(e.priority||"medium"));if(l.push("BEGIN:VEVENT"),l.push("UID:".concat(t)),l.push("DTSTAMP:".concat(s)),e.dueTime){const t=i(e.dueDate,e.dueTime);l.push("DTSTART:".concat(t)),l.push("DTEND:".concat(t))}else{const t=a(e.dueDate);l.push("DTSTART;VALUE=DATE:".concat(t)),l.push("DTEND;VALUE=DATE:".concat(t))}l.push("SUMMARY:[Task] ".concat(c)),l.push("DESCRIPTION:".concat(d)),l.push("CATEGORIES:".concat(r(e.projectTitle))),"high"===e.priority?l.push("PRIORITY:1"):"low"===e.priority?l.push("PRIORITY:9"):l.push("PRIORITY:5"),l.push("END:VEVENT")}),t.forEach(e=>{if(!e.date)return;const t="event-".concat(e.id,"@research-dashboard"),s=o(n),c=r(e.title),d=e.description?r(e.description):"";if(l.push("BEGIN:VEVENT"),l.push("UID:".concat(t)),l.push("DTSTAMP:".concat(s)),e.startTime){const t=i(e.date,e.startTime);if(l.push("DTSTART:".concat(t)),e.endTime){const t=i(e.date,e.endTime);l.push("DTEND:".concat(t))}else l.push("DTEND:".concat(t))}else{const t=a(e.date);l.push("DTSTART;VALUE=DATE:".concat(t)),l.push("DTEND;VALUE=DATE:".concat(t))}l.push("SUMMARY:".concat(c)),d&&l.push("DESCRIPTION:".concat(d)),l.push("CATEGORIES:Calendar Event"),l.push("END:VEVENT")}),l.push("END:VCALENDAR"),l.join("\r\n")},Jn=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Hn=["January","February","March","April","May","June","July","August","September","October","November","December"];const Qn=function(e){let{isOpen:t,onClose:n}=e;const[a,r]=(0,l.useState)(new Date),[o,i]=(0,l.useState)([]),[s,c]=(0,l.useState)([]),[d,u]=(0,l.useState)(null),[p,m]=(0,l.useState)(!1),[h,g]=(0,l.useState)(!1),[f,v]=(0,l.useState)(""),[y,b]=(0,l.useState)(!1),[x,k]=(0,l.useState)(null),[j,w]=(0,l.useState)({title:"",date:"",startTime:"",endTime:"",description:"",color:"blue"}),S=se(),N=(0,l.useCallback)(()=>{const e=Kn(o,s),t=new Blob([e],{type:"text/calendar;charset=utf-8"}),n=URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download="research-dashboard-calendar.ics",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(n),v("Downloaded! Import this file into Google Calendar."),setTimeout(()=>v(""),3e3)},[o,s]),C=(0,l.useCallback)(()=>{const e=Kn(o,s);navigator.clipboard.writeText(e).then(()=>{v("iCal content copied to clipboard!"),setTimeout(()=>v(""),3e3)})},[o,s]);(0,l.useEffect)(()=>{try{const e=localStorage.getItem(Vn);e&&c(JSON.parse(e))}catch(e){}},[]);const E=e=>{c(e),localStorage.setItem(Vn,JSON.stringify(e))};if((0,l.useEffect)(()=>{if(!t)return;let e=[];try{const t=localStorage.getItem("research-dashboard-custom-projects");t&&(e=JSON.parse(t))}catch(l){}const n=new Set(e.map(e=>e.id)),a=[...Cn,...e];let r={};try{const e=localStorage.getItem("research-dashboard-tasks");e&&(r=JSON.parse(e))}catch(s){}const o=[];a.forEach(e=>{let t;t=n.has(e.id)?e.tasks:r[e.id]||e.tasks,t&&Object.entries(t).forEach(t=>{let[n,a]=t;Array.isArray(a)&&a.forEach(t=>{t.dueDate&&o.push(Je(Je({},t),{},{projectId:e.id,projectTitle:e.title,projectColor:e.color,column:n}))})})}),i(o)},[t]),!t)return null;const I=a.getFullYear(),D=a.getMonth(),T=new Date(I,D,1).getDay(),A=new Date(I,D+1,0).getDate(),P=new Date,O=e=>{const t="".concat(I,"-").concat(String(D+1).padStart(2,"0"),"-").concat(String(e).padStart(2,"0"));return o.filter(e=>e.dueDate===t)},L=e=>{const t="".concat(I,"-").concat(String(D+1).padStart(2,"0"),"-").concat(String(e).padStart(2,"0"));return s.filter(e=>e.date===t)},R=e=>P.getFullYear()===I&&P.getMonth()===D&&P.getDate()===e,M=e=>{if(!e)return"";const[t,n]=e.split(":"),a=parseInt(t),r=a>=12?"pm":"am";return"".concat(a%12||12,":").concat(n).concat(r)},F=d?O(d):[],U=d?L(d):[];return(0,He.jsxs)("div",{className:"calendar-overlay",onClick:n,children:[(0,He.jsxs)("div",{className:"calendar-modal",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"calendar-header",children:[(0,He.jsx)("h2",{children:"Calendar View"}),(0,He.jsxs)("div",{className:"calendar-header-actions",children:[(0,He.jsxs)("button",{className:"btn-export-cal ".concat(p?"expanded":""),onClick:()=>m(!p),title:"Export to Calendar",children:["Export ",p?"\u25b2":"\u25bc"]}),(0,He.jsx)("button",{className:"modal-close",onClick:n,children:"\xd7"})]})]}),p&&(0,He.jsxs)("div",{className:"ical-export-section",children:[(0,He.jsxs)("div",{className:"ical-export-header",children:[(0,He.jsx)("h4",{children:"Calendar Export Options"}),(0,He.jsx)("button",{className:"collapse-export-btn",onClick:()=>m(!1),title:"Collapse",children:"\u2715"})]}),(0,He.jsxs)("div",{className:"export-option subscribe-option",children:[(0,He.jsxs)("div",{className:"option-header",children:[(0,He.jsx)("span",{className:"option-icon",children:"\ud83d\udd04"}),(0,He.jsxs)("div",{children:[(0,He.jsx)("strong",{children:"Subscribe (Recommended)"}),(0,He.jsx)("p",{children:"Create a subscription URL that Google Calendar can auto-update"})]})]}),(0,He.jsx)("button",{className:"btn-subscribe",onClick:()=>g(!0),children:"Set Up Subscription"})]}),(0,He.jsx)("div",{className:"export-divider",children:(0,He.jsx)("span",{children:"or"})}),(0,He.jsxs)("div",{className:"export-option download-option",children:[(0,He.jsxs)("div",{className:"option-header",children:[(0,He.jsx)("span",{className:"option-icon",children:"\ud83d\udce5"}),(0,He.jsxs)("div",{children:[(0,He.jsx)("strong",{children:"One-time Download"}),(0,He.jsx)("p",{children:"Download .ics file to manually import (won't auto-update)"})]})]}),(0,He.jsxs)("div",{className:"ical-export-actions",children:[(0,He.jsx)("button",{className:"btn-download-ical",onClick:N,children:"Download .ics File"}),(0,He.jsx)("button",{className:"btn-copy-ical-content",onClick:C,children:"Copy iCal Data"})]})]}),f&&(0,He.jsx)("div",{className:"ical-export-status",children:f}),(0,He.jsxs)("details",{className:"import-instructions",children:[(0,He.jsx)("summary",{children:"How to manually import into Google Calendar"}),(0,He.jsxs)("ol",{children:[(0,He.jsx)("li",{children:'Click "Download .ics File" above'}),(0,He.jsxs)("li",{children:["Open ",(0,He.jsx)("a",{href:"https://calendar.google.com",target:"_blank",rel:"noopener noreferrer",children:"Google Calendar"})]}),(0,He.jsx)("li",{children:"Click the gear icon \u2192 Settings"}),(0,He.jsx)("li",{children:'Select "Import & Export" from the left menu'}),(0,He.jsx)("li",{children:'Click "Select file from your computer" and choose the downloaded file'}),(0,He.jsx)("li",{children:'Select the calendar to add events to and click "Import"'})]})]}),(0,He.jsxs)("div",{className:"ical-task-count",children:[o.length," task",1!==o.length?"s":""," with due dates",s.length>0&&" \u2022 ".concat(s.length," event").concat(1!==s.length?"s":"")]})]}),(0,He.jsx)("div",{className:"calendar-actions-bar",children:(0,He.jsx)("button",{className:"btn-add-event",onClick:()=>{w({title:"",date:"",startTime:"",endTime:"",description:"",color:"blue"}),k(null),b(!0)},children:"+ Add Event"})}),(0,He.jsxs)("div",{className:"calendar-nav",children:[(0,He.jsx)("button",{onClick:()=>{r(new Date(I,D-1,1)),u(null)},children:"<"}),(0,He.jsxs)("h3",{children:[Hn[D]," ",I]}),(0,He.jsx)("button",{onClick:()=>{r(new Date(I,D+1,1)),u(null)},children:">"}),(0,He.jsx)("button",{className:"today-btn",onClick:()=>{r(new Date),u(null)},children:"Today"})]}),(0,He.jsxs)("div",{className:"calendar-grid",children:[(0,He.jsx)("div",{className:"calendar-weekdays",children:Jn.map(e=>(0,He.jsx)("div",{className:"weekday",children:e},e))}),(0,He.jsx)("div",{className:"calendar-days",children:(()=>{const e=[];for(let t=0;t<T;t++)e.push((0,He.jsx)("div",{className:"calendar-day empty"},"empty-".concat(t)));for(let t=1;t<=A;t++){const n=O(t),a=L(t),r=n.length+a.length,o=n.some(e=>new Date(e.dueDate)<P&&"done"!==e.column);e.push((0,He.jsxs)("div",{className:"calendar-day ".concat(R(t)?"today":""," ").concat(d===t?"selected":""," ").concat(r>0?"has-tasks":""," ").concat(o?"has-overdue":""),onClick:()=>u(t),children:[(0,He.jsx)("span",{className:"day-number",children:t}),r>0&&(0,He.jsxs)("div",{className:"day-tasks-preview",children:[a.slice(0,2).map(e=>{var t;return(0,He.jsx)("div",{className:"event-dot",style:{backgroundColor:(null===(t=qn.find(t=>t.id===e.color))||void 0===t?void 0:t.color)||"#3498db"}},"event-".concat(e.id))}),n.slice(0,3-Math.min(a.length,2)).map(e=>(0,He.jsx)("div",{className:"task-dot",style:{backgroundColor:e.projectColor}},"task-".concat(e.id))),r>3&&(0,He.jsxs)("span",{className:"more-tasks",children:["+",r-3]})]})]},t))}return e})()})]}),d&&(0,He.jsxs)("div",{className:"calendar-day-detail",children:[(0,He.jsxs)("div",{className:"day-detail-header",children:[(0,He.jsxs)("h4",{children:[Hn[D]," ",d,", ",I,(F.length>0||U.length>0)&&" (".concat(F.length," task").concat(1!==F.length?"s":"",", ").concat(U.length," event").concat(1!==U.length?"s":"",")")]}),(0,He.jsx)("button",{className:"btn-add-event-day",onClick:()=>(e=>{const t=a.getFullYear(),n=a.getMonth(),r="".concat(t,"-").concat(String(n+1).padStart(2,"0"),"-").concat(String(e).padStart(2,"0"));w({title:"",date:r,startTime:"",endTime:"",description:"",color:"blue"}),k(null),b(!0)})(d),title:"Add event for this day",children:"+"})]}),U.length>0&&(0,He.jsxs)("div",{className:"day-events-list",children:[(0,He.jsx)("h5",{children:"Events"}),U.map(e=>{var t;return(0,He.jsxs)("div",{className:"calendar-event-item",children:[(0,He.jsx)("div",{className:"event-color",style:{backgroundColor:(null===(t=qn.find(t=>t.id===e.color))||void 0===t?void 0:t.color)||"#3498db"}}),(0,He.jsxs)("div",{className:"event-info",children:[(0,He.jsx)("span",{className:"event-name",children:e.title}),e.startTime&&(0,He.jsxs)("span",{className:"event-time",children:[M(e.startTime),e.endTime&&" - ".concat(M(e.endTime))]}),e.description&&(0,He.jsx)("span",{className:"event-desc",children:e.description})]}),(0,He.jsxs)("div",{className:"event-actions",children:[(0,He.jsx)("button",{onClick:()=>(e=>{w(Je({},e)),k(e),b(!0)})(e),title:"Edit",children:"\u270f\ufe0f"}),(0,He.jsx)("button",{onClick:()=>{return t=e.id,void(window.confirm("Delete this event?")&&E(s.filter(e=>e.id!==t)));var t},title:"Delete",children:"\ud83d\uddd1\ufe0f"})]})]},e.id)})]}),F.length>0&&(0,He.jsxs)("div",{className:"day-tasks-list",children:[(0,He.jsx)("h5",{children:"Tasks"}),F.map(e=>(0,He.jsxs)("div",{className:"calendar-task-item",onClick:()=>(e=>{S("/project/".concat(e.projectId)),n()})(e),children:[(0,He.jsx)("div",{className:"task-color",style:{backgroundColor:e.projectColor}}),(0,He.jsxs)("div",{className:"task-info",children:[(0,He.jsx)("span",{className:"task-name",children:e.title}),(0,He.jsx)("span",{className:"task-project",children:e.projectTitle}),e.dueTime&&(0,He.jsx)("span",{className:"task-time",children:M(e.dueTime)})]}),(0,He.jsx)("span",{className:"task-priority-dot ".concat(e.priority)})]},e.id))]}),0===F.length&&0===U.length&&(0,He.jsx)("p",{className:"no-tasks",children:"No tasks or events on this day"})]})]}),(0,He.jsx)(Wn,{isOpen:h,onClose:()=>g(!1),tasks:o}),y&&(0,He.jsx)("div",{className:"event-form-overlay",onClick:()=>b(!1),children:(0,He.jsxs)("div",{className:"event-form-modal",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"event-form-header",children:[(0,He.jsx)("h3",{children:x?"Edit Event":"New Event"}),(0,He.jsx)("button",{className:"modal-close",onClick:()=>b(!1),children:"\xd7"})]}),(0,He.jsxs)("div",{className:"event-form-body",children:[(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Title *"}),(0,He.jsx)("input",{type:"text",value:j.title,onChange:e=>w(Je(Je({},j),{},{title:e.target.value})),placeholder:"Event title...",autoFocus:!0})]}),(0,He.jsxs)("div",{className:"form-row",children:[(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Date *"}),(0,He.jsx)("input",{type:"date",value:j.date,onChange:e=>w(Je(Je({},j),{},{date:e.target.value}))})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Color"}),(0,He.jsx)("div",{className:"color-picker",children:qn.map(e=>(0,He.jsx)("button",{className:"color-option ".concat(j.color===e.id?"selected":""),style:{backgroundColor:e.color},onClick:()=>w(Je(Je({},j),{},{color:e.id})),title:e.name},e.id))})]})]}),(0,He.jsxs)("div",{className:"form-row",children:[(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Start Time"}),(0,He.jsx)("input",{type:"time",value:j.startTime,onChange:e=>w(Je(Je({},j),{},{startTime:e.target.value}))})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"End Time"}),(0,He.jsx)("input",{type:"time",value:j.endTime,onChange:e=>w(Je(Je({},j),{},{endTime:e.target.value}))})]})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Description"}),(0,He.jsx)("textarea",{value:j.description,onChange:e=>w(Je(Je({},j),{},{description:e.target.value})),placeholder:"Event description (optional)...",rows:3})]})]}),(0,He.jsxs)("div",{className:"event-form-footer",children:[(0,He.jsx)("button",{className:"btn-cancel",onClick:()=>b(!1),children:"Cancel"}),(0,He.jsxs)("button",{className:"btn-save",onClick:()=>{if(j.title.trim()&&j.date){if(x){const e=s.map(e=>e.id===x.id?Je(Je({},j),{},{id:x.id}):e);E(e)}else{const e=Je(Je({},j),{},{id:Date.now().toString()});E([...s,e])}w({title:"",date:"",startTime:"",endTime:"",description:"",color:"blue"}),k(null),b(!1)}},disabled:!j.title.trim()||!j.date,children:[x?"Update":"Create"," Event"]})]})]})})]})},$n="research-dashboard-custom-projects",Yn="research-dashboard-tasks";const Xn=function(e){let{isOpen:t,onClose:n}=e;const{logActivity:a,isProjectArchived:r}=et(),o=St(),[i,s]=(0,l.useState)([]),[c,d]=(0,l.useState)(new Set),[u,p]=(0,l.useState)(""),[m,h]=(0,l.useState)("backlog"),[g,f]=(0,l.useState)(""),[v,y]=(0,l.useState)("medium"),[b,x]=(0,l.useState)("");return(0,l.useEffect)(()=>{if(!t)return;let e=[];try{const t=localStorage.getItem($n);t&&(e=JSON.parse(t))}catch(o){}const n=new Set(e.map(e=>e.id));d(n);const a=[...Cn,...e].filter(e=>!r(e.id));s(a),a.length>0&&!u&&p(a[0].id)},[t,r,u]),t?(0,He.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,He.jsxs)("div",{className:"quick-add-modal",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"modal-header",children:[(0,He.jsx)("h2",{children:"Quick Add Task"}),(0,He.jsx)("button",{className:"modal-close",onClick:n,children:"\xd7"})]}),(0,He.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!g.trim()||!u)return;const t=i.find(e=>e.id===u),r=c.has(u),l={id:"".concat(u,"-").concat(Date.now()),title:g.trim(),priority:v,dueDate:b||void 0,description:"",labels:[],checklist:[],links:[]};if(r)try{const e=localStorage.getItem($n);if(e){const t=JSON.parse(e).map(e=>{if(e.id===u){const t=e.tasks||{backlog:[],inProgress:[],review:[],done:[]};return Je(Je({},e),{},{tasks:Je(Je({},t),{},{[m]:[...t[m]||[],l]})})}return e});localStorage.setItem($n,JSON.stringify(t)),o()}}catch(s){console.error("Failed to save task to custom project:",s)}else{let e={};try{const t=localStorage.getItem(Yn);t&&(e=JSON.parse(t))}catch(d){}const n=e[u]||(null===t||void 0===t?void 0:t.tasks)||{backlog:[],inProgress:[],review:[],done:[]};n[m]=[...n[m]||[],l],e[u]=n,localStorage.setItem(Yn,JSON.stringify(e)),o()}a("task_created",{taskId:l.id,taskTitle:l.title,projectId:u,projectTitle:null===t||void 0===t?void 0:t.title,column:m}),f(""),y("medium"),x(""),n()},className:"quick-add-form",children:[(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Task Title"}),(0,He.jsx)("input",{type:"text",value:g,onChange:e=>f(e.target.value),placeholder:"What needs to be done?",autoFocus:!0})]}),(0,He.jsxs)("div",{className:"form-row",children:[(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Project"}),(0,He.jsx)("select",{value:u,onChange:e=>p(e.target.value),children:i.map(e=>(0,He.jsx)("option",{value:e.id,children:e.title},e.id))})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Column"}),(0,He.jsxs)("select",{value:m,onChange:e=>h(e.target.value),children:[(0,He.jsx)("option",{value:"backlog",children:"Backlog"}),(0,He.jsx)("option",{value:"inProgress",children:"In Progress"}),(0,He.jsx)("option",{value:"review",children:"Review"}),(0,He.jsx)("option",{value:"done",children:"Done"})]})]})]}),(0,He.jsxs)("div",{className:"form-row",children:[(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Priority"}),(0,He.jsx)("div",{className:"priority-buttons",children:["low","medium","high"].map(e=>(0,He.jsx)("button",{type:"button",className:"priority-btn ".concat(e," ").concat(v===e?"active":""),onClick:()=>y(e),children:e},e))})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Due Date"}),(0,He.jsx)("input",{type:"date",value:b,onChange:e=>x(e.target.value)})]})]}),(0,He.jsxs)("div",{className:"form-actions",children:[(0,He.jsx)("button",{type:"button",className:"btn-cancel",onClick:n,children:"Cancel"}),(0,He.jsx)("button",{type:"submit",className:"btn-submit",disabled:!g.trim(),children:"Add Task"})]})]})]})}):null},Zn={task_created:"\u2795",task_moved:"\u2194\ufe0f",task_updated:"\u270f\ufe0f",task_deleted:"\ud83d\uddd1\ufe0f",project_created:"\ud83d\udcc1",archive_project:"\ud83d\udce6",unarchive_project:"\ud83d\udcc2",protocol_added:"\ud83d\udccb",result_added:"\ud83d\udcca",default:"\u2022"},ea={task_created:"Task created",task_moved:"Task moved",task_updated:"Task updated",task_deleted:"Task deleted",project_created:"Project created",archive_project:"Project archived",unarchive_project:"Project unarchived",protocol_added:"Protocol added",result_added:"Result added"};const ta=function(e){let{isOpen:t,onClose:n}=e;const{activities:a}=et();if(!t)return null;const r=e=>{const t=new Date(e),n=new Date,a=n-t;if(a<6e4)return"Just now";if(a<36e5){const e=Math.floor(a/6e4);return"".concat(e," min").concat(e>1?"s":""," ago")}if(a<864e5){const e=Math.floor(a/36e5);return"".concat(e," hour").concat(e>1?"s":""," ago")}if(a<6048e5){const e=Math.floor(a/864e5);return"".concat(e," day").concat(e>1?"s":""," ago")}return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==n.getFullYear()?"numeric":void 0})},o=e=>{switch(e.action){case"task_created":case"task_updated":return'"'.concat(e.taskTitle,'" in ').concat(e.projectTitle);case"task_moved":return'"'.concat(e.taskTitle,'" from ').concat(e.fromColumn," to ").concat(e.toColumn);case"task_deleted":return'"'.concat(e.taskTitle,'" from ').concat(e.projectTitle);case"project_created":return'"'.concat(e.projectTitle,'"');case"archive_project":case"unarchive_project":return"Project ".concat(e.projectId);case"protocol_added":return'"'.concat(e.protocolTitle,'" to ').concat(e.projectTitle);case"result_added":return'"'.concat(e.resultTitle,'" to ').concat(e.projectTitle);default:return e.details||""}},i=a.reduce((e,t)=>{const n=new Date(t.timestamp).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"});return e[n]||(e[n]=[]),e[n].push(t),e},{});return(0,He.jsx)("div",{className:"activity-overlay",onClick:n,children:(0,He.jsxs)("div",{className:"activity-panel",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"activity-header",children:[(0,He.jsx)("h2",{children:"Activity Timeline"}),(0,He.jsx)("button",{className:"modal-close",onClick:n,children:"\xd7"})]}),(0,He.jsx)("div",{className:"activity-content",children:0===a.length?(0,He.jsxs)("div",{className:"no-activity",children:[(0,He.jsx)("p",{children:"No activity yet"}),(0,He.jsx)("span",{children:"Your actions will appear here"})]}):Object.entries(i).map(e=>{let[t,n]=e;return(0,He.jsxs)("div",{className:"activity-day",children:[(0,He.jsx)("h3",{className:"activity-date",children:t}),(0,He.jsx)("div",{className:"activity-list",children:n.map(e=>(0,He.jsxs)("div",{className:"activity-item",children:[(0,He.jsx)("span",{className:"activity-icon",children:Zn[e.action]||Zn.default}),(0,He.jsxs)("div",{className:"activity-details",children:[(0,He.jsx)("span",{className:"activity-action",children:ea[e.action]||e.action}),(0,He.jsx)("span",{className:"activity-description",children:o(e)})]}),(0,He.jsx)("span",{className:"activity-time",children:r(e.timestamp)})]},e.id))})]},t)})})]})})};function na(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const aa=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"short";const n={short:{month:"numeric",day:"numeric",year:"numeric"},long:{weekday:"long",month:"long",day:"numeric",year:"numeric"},iso:null};return"iso"===t?e.toISOString().split("T")[0]:e.toLocaleDateString("en-US",n[t]||n.short)},ra=function(e){return"24h"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"12h")?e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}):e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},oa=e=>{const t=new Date;return t.setDate(t.getDate()+e),t},ia=[{trigger:"@today",label:"Today's date",category:"dates",icon:"\ud83d\udcc5",getValue:()=>aa(new Date)},{trigger:"@tomorrow",label:"Tomorrow's date",category:"dates",icon:"\ud83d\udcc5",getValue:()=>aa(oa(1))},{trigger:"@yesterday",label:"Yesterday's date",category:"dates",icon:"\ud83d\udcc5",getValue:()=>aa(oa(-1))},{trigger:"@date-iso",label:"Today (ISO format)",category:"dates",icon:"\ud83d\udcc5",getValue:()=>aa(new Date,"iso")},{trigger:"@date-long",label:"Today (long format)",category:"dates",icon:"\ud83d\udcc5",getValue:()=>aa(new Date,"long")},{trigger:"@now",label:"Current time",category:"time",icon:"\ud83d\udd50",getValue:()=>ra(new Date)},{trigger:"@time-24",label:"Current time (24h)",category:"time",icon:"\ud83d\udd50",getValue:()=>ra(new Date,"24h")},{trigger:"@datetime",label:"Date and time",category:"time",icon:"\ud83d\udd50",getValue:()=>"".concat(aa(new Date)," ").concat(ra(new Date))},{trigger:"@timestamp",label:"ISO timestamp",category:"time",icon:"\ud83d\udd50",getValue:()=>(new Date).toISOString()},{trigger:"@week",label:"Week number",category:"calendar",icon:"\ud83d\udcc6",getValue:()=>{const e=new Date,t=new Date(e.getFullYear(),0,1),n=e-t;return"Week ".concat(Math.ceil(n/6048e5))}},{trigger:"@month",label:"Current month",category:"calendar",icon:"\ud83d\udcc6",getValue:()=>(new Date).toLocaleDateString("en-US",{month:"long"})},{trigger:"@year",label:"Current year",category:"calendar",icon:"\ud83d\udcc6",getValue:()=>(new Date).getFullYear().toString()},{trigger:"@quarter",label:"Current quarter",category:"calendar",icon:"\ud83d\udcc6",getValue:()=>"Q".concat(Math.ceil(((new Date).getMonth()+1)/3))},{trigger:"@this-week",label:"This week range",category:"ranges",icon:"\ud83d\udcca",getValue:()=>"".concat(aa((()=>{const e=new Date,t=e.getDay();return e.setDate(e.getDate()-t),e})())," - ").concat(aa((()=>{const e=new Date,t=e.getDay();return e.setDate(e.getDate()+(6-t)),e})()))},{trigger:"@this-month",label:"This month range",category:"ranges",icon:"\ud83d\udcca",getValue:()=>"".concat(aa((()=>{const e=new Date;return e.setDate(1),e})())," - ").concat(aa((()=>{const e=new Date;return e.setMonth(e.getMonth()+1),e.setDate(0),e})()))},{trigger:"@next-week",label:"Next week date",category:"ranges",icon:"\ud83d\udcca",getValue:()=>aa(oa(7))},{trigger:"@next-month",label:"Next month date",category:"ranges",icon:"\ud83d\udcca",getValue:()=>{const e=new Date;return e.setMonth(e.getMonth()+1),aa(e)}},{trigger:"@exp-id",label:"Experiment ID",category:"research",icon:"\ud83e\uddea",getValue:()=>"EXP-".concat(aa(new Date,"iso").replace(/-/g,""),"-").concat(Math.random().toString(36).substr(2,4).toUpperCase())},{trigger:"@sample-id",label:"Sample ID",category:"research",icon:"\ud83e\uddeb",getValue:()=>"S".concat(Date.now().toString(36).toUpperCase())},{trigger:"@batch",label:"Batch number",category:"research",icon:"\ud83d\udce6",getValue:()=>"BATCH-".concat(aa(new Date,"iso"),"-").concat(String(Math.floor(1e3*Math.random())).padStart(3,"0"))},{trigger:"@protocol-ver",label:"Protocol version",category:"research",icon:"\ud83d\udccb",getValue:()=>"v".concat((new Date).getFullYear(),".").concat((new Date).getMonth()+1,".1")},{trigger:"@uuid",label:"Generate UUID",category:"utility",icon:"\ud83d\udd11",getValue:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},{trigger:"@random",label:"Random number",category:"utility",icon:"\ud83c\udfb2",getValue:()=>Math.floor(1e4*Math.random()).toString()},{trigger:"@checkbox",label:"Empty checkbox",category:"utility",icon:"\u2611\ufe0f",getValue:()=>"[ ] "},{trigger:"@checked",label:"Checked checkbox",category:"utility",icon:"\u2705",getValue:()=>"[x] "},{trigger:"@bullet",label:"Bullet point",category:"utility",icon:"\u2022",getValue:()=>"\u2022 "},{trigger:"@divider",label:"Section divider",category:"utility",icon:"\u2796",getValue:()=>"\n---\n"}],la=[{id:"dates",label:"Dates",icon:"\ud83d\udcc5"},{id:"time",label:"Time",icon:"\ud83d\udd50"},{id:"calendar",label:"Calendar",icon:"\ud83d\udcc6"},{id:"ranges",label:"Date Ranges",icon:"\ud83d\udcca"},{id:"research",label:"Research",icon:"\ud83e\uddea"},{id:"utility",label:"Utility",icon:"\ud83d\udd27"}];function sa(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const[r,o]=(0,l.useState)(!1),[i,s]=(0,l.useState)({top:0,left:0}),[c,d]=(0,l.useState)(""),[u,p]=(0,l.useState)(0),m=(0,l.useMemo)(()=>{const e=[];return a.userName&&e.push({trigger:"@me",label:"Your name",category:"utility",icon:"\ud83d\udc64",getValue:()=>a.userName}),a.userEmail&&e.push({trigger:"@email",label:"Your email",category:"utility",icon:"\ud83d\udce7",getValue:()=>a.userEmail}),a.projectName&&e.push({trigger:"@project",label:"Project name",category:"utility",icon:"\ud83d\udcc1",getValue:()=>a.projectName}),[...e,...ia]},[a]),h=(0,l.useMemo)(()=>{if(!c)return m;const e=c.toLowerCase();return m.filter(t=>t.trigger.toLowerCase().includes(e)||t.label.toLowerCase().includes(e))},[c,m]),g=(0,l.useCallback)(t=>{const a=t.target.value,r=t.target.selectionStart,i=a.slice(0,r),l=i.match(/@(\w*)$/);if(l){if(d(l[0]),o(!0),p(0),e.current){const t=e.current.getBoundingClientRect(),n=24,a=8,r=i.split("\n"),o=r.length-1,l=r[r.length-1].length;s({top:t.top+o*n+n+window.scrollY,left:t.left+l*a+window.scrollX})}}else o(!1),d("");n(a)},[n,e]),f=(0,l.useCallback)(e=>{if(r)switch(e.key){case"ArrowDown":e.preventDefault(),p(e=>Math.min(e+1,h.length-1));break;case"ArrowUp":e.preventDefault(),p(e=>Math.max(e-1,0));break;case"Enter":case"Tab":h.length>0&&(e.preventDefault(),v(h[u]));break;case"Escape":o(!1)}},[r,h,u]),v=(0,l.useCallback)(a=>{if(!e.current)return;const r=e.current,i=r.selectionStart,l=t.slice(0,i),s=t.slice(i),c=l.match(/@\w*$/);if(!c)return;const u=i-c[0].length,p=a.getValue(),m=t.slice(0,u)+p+s;n(m),setTimeout(()=>{const e=u+p.length;r.setSelectionRange(e,e),r.focus()},0),o(!1),d("")},[t,n,e]),y=(0,l.useCallback)(e=>{v(e)},[v]);return{showDropdown:r,setShowDropdown:o,dropdownPosition:i,filteredMacros:h,selectedIndex:u,setSelectedIndex:p,handleInputChange:g,handleKeyDown:f,handleMacroClick:y,macrosWithContext:m}}const ca=["value","onChange","placeholder","className","rows","projectName","onPaste"];function da(e){let{filteredMacros:t,selectedIndex:n,onSelect:a,onMouseEnter:r,position:o}=e;const i=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(i.current){const e=i.current.querySelector(".macro-item.selected");e&&e.scrollIntoView({block:"nearest"})}},[n]);const s=la.map(e=>Je(Je({},e),{},{macros:t.filter(t=>t.category===e.id)})).filter(e=>e.macros.length>0),c=t.length<20;return(0,He.jsxs)("div",{className:"macro-dropdown",ref:i,style:{position:"fixed",top:Math.min(o.top,window.innerHeight-300),left:Math.min(o.left,window.innerWidth-250),zIndex:1e4},children:[(0,He.jsxs)("div",{className:"macro-dropdown-header",children:[(0,He.jsx)("span",{className:"macro-dropdown-title",children:"@ Commands"}),(0,He.jsx)("span",{className:"macro-dropdown-hint",children:"\u2191\u2193 navigate \u2022 Enter select \u2022 Esc close"})]}),(0,He.jsxs)("div",{className:"macro-dropdown-content",children:[c?t.map((e,t)=>(0,He.jsxs)("div",{className:"macro-item ".concat(t===n?"selected":""),onClick:()=>a(e),onMouseEnter:()=>r(t),children:[(0,He.jsx)("span",{className:"macro-icon",children:e.icon}),(0,He.jsx)("span",{className:"macro-trigger",children:e.trigger}),(0,He.jsx)("span",{className:"macro-label",children:e.label})]},e.trigger)):s.map(e=>(0,He.jsxs)("div",{className:"macro-category",children:[(0,He.jsxs)("div",{className:"macro-category-header",children:[(0,He.jsx)("span",{className:"macro-category-icon",children:e.icon}),(0,He.jsx)("span",{className:"macro-category-label",children:e.label})]}),e.macros.map(e=>{const o=t.indexOf(e);return(0,He.jsxs)("div",{className:"macro-item ".concat(o===n?"selected":""),onClick:()=>a(e),onMouseEnter:()=>r(o),children:[(0,He.jsx)("span",{className:"macro-icon",children:e.icon}),(0,He.jsx)("span",{className:"macro-trigger",children:e.trigger}),(0,He.jsx)("span",{className:"macro-label",children:e.label})]},e.trigger)})]},e.id)),0===t.length&&(0,He.jsx)("div",{className:"macro-empty",children:"No matching commands"})]})]})}const ua=function(e){let{value:t,onChange:n,placeholder:a,className:r="",rows:o=4,projectName:i=null,onPaste:s}=e,c=na(e,ca);const d=(0,l.useRef)(null),{user:u}=lt(),p={userName:null===u||void 0===u?void 0:u.name,userEmail:null===u||void 0===u?void 0:u.email,projectName:i},{showDropdown:m,setShowDropdown:h,dropdownPosition:g,filteredMacros:f,selectedIndex:v,setSelectedIndex:y,handleInputChange:b,handleKeyDown:x,handleMacroClick:k}=sa(d,t,n,p);return(0,l.useEffect)(()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&h(!1)};if(m)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[m,h]),(0,He.jsxs)("div",{className:"macro-textarea-wrapper",children:[(0,He.jsx)("textarea",Je({ref:d,value:t,onChange:b,onKeyDown:x,onPaste:e=>{!s||(s(e),e.defaultPrevented)},placeholder:a||"Type @ for commands...",className:"macro-textarea ".concat(r),rows:o},c)),m&&f.length>0&&(0,He.jsx)(da,{filteredMacros:f,selectedIndex:v,onSelect:k,onMouseEnter:y,position:g})]})},pa=["value","onChange","projectId","projectName","placeholder","rows","className","onPaste"];const ma=function(e){let{value:t,onChange:n,projectId:a,projectName:r,placeholder:o,rows:i=4,className:s="",onPaste:c}=e,d=na(e,pa);const{getProjectReferences:u,formatCitation:p}=function(){const e=(0,l.useContext)(Ut);if(!e)throw new Error("useReferences must be used within a ReferencesProvider");return e}(),{user:m}=lt(),[h,g]=(0,l.useState)(!1),[f,v]=(0,l.useState)([]),[y,b]=(0,l.useState)(0),[x,k]=(0,l.useState)({top:0,left:0}),[j,w]=(0,l.useState)(""),[S,N]=(0,l.useState)(null),C=(0,l.useRef)(null),E=(0,l.useRef)(null),I=u(a),D=(0,l.useMemo)(()=>{const e=[];return null!==m&&void 0!==m&&m.name&&e.push({trigger:"@me",label:"Your name",category:"utility",icon:"\ud83d\udc64",getValue:()=>m.name}),null!==m&&void 0!==m&&m.email&&e.push({trigger:"@email",label:"Your email",category:"utility",icon:"\ud83d\udce7",getValue:()=>m.email}),r&&e.push({trigger:"@project",label:"Project name",category:"utility",icon:"\ud83d\udcc1",getValue:()=>r}),[...e,...ia]},[m,r]),T=(0,l.useMemo)(()=>{if(!t)return{order:[],refToNum:{},numToRef:{}};const e=/\[refId:([^\]]+)\]/g,n=[],a={};let r;for(;null!==(r=e.exec(t));){const e=r[1];a[e]||(n.push(e),a[e]=n.length)}const o={};return n.forEach((e,t)=>{o[t+1]=e}),{order:n,refToNum:a,numToRef:o}},[t]),A=e=>T.refToNum[e]?T.refToNum[e]:T.order.length+1,P=(e,t)=>{const n=e.substring(0,t),a=n.match(/@refs?$/i)||n.match(/@references?$/i);if(a)return{type:"refs",query:"",fullMatch:a[0]};const r=n.match(/@cite:(\S*)$/i),o=n.match(/\[@(\S*)$/);if(r)return{type:"cite",query:r[1],fullMatch:r[0]};if(o)return{type:"bracket",query:o[1],fullMatch:o[0]};const i=n.match(/@(\w*)$/);return!i||n.match(/@cite:?\w*$/i)||n.match(/@refs?\w*$/i)?null:{type:"macro",query:i[1],fullMatch:i[0]}},O=e=>{const a=C.current;if(!a)return;const r=a.selectionStart,o=t,i=P(o,r);if(!i)return;const l=o.substring(0,r-i.fullMatch.length),s=o.substring(r),c=A(e.id),d="[".concat(c,"][refId:").concat(e.id,"]"),u=l+d+s,p=l.length+d.length;n({target:{value:u,selectionStart:p}}),g(!1),setTimeout(()=>{a&&(a.selectionStart=p,a.selectionEnd=p,a.focus())},0)},L=e=>{const a=C.current;if(!a)return;const r=a.selectionStart,o=t,i=P(o,r);if(!i)return;const l=o.substring(0,r-i.fullMatch.length),s=o.substring(r),c=e.getValue(),d=l+c+s,u=l.length+c.length;n({target:{value:d,selectionStart:u}}),g(!1),setTimeout(()=>{a&&(a.selectionStart=u,a.selectionEnd=u,a.focus())},0)},R=()=>{const e=C.current;if(!e)return;const a=e.selectionStart,r=t,o=P(r,a);if(!o)return;const i=r.substring(0,a-o.fullMatch.length),l=r.substring(a);let s="\n\nReferences:\n";0===T.order.length?s+="(No citations in this text yet)\n":T.order.forEach((e,t)=>{const n=I.find(t=>t.id===e);n&&(s+="".concat(t+1,". ").concat(p(n),"\n"))});const c=i+s+l,d=i.length+s.length;n({target:{value:c,selectionStart:d}}),g(!1),setTimeout(()=>{e&&(e.selectionStart=d,e.selectionEnd=d,e.focus())},0)};(0,l.useEffect)(()=>{const e=e=>{E.current&&!E.current.contains(e.target)&&C.current&&!C.current.contains(e.target)&&g(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const M=e=>{if(!e)return"Unknown";const t=e.split(",")[0].trim();return t.length>20?t.substring(0,20)+"...":t};return null===t||void 0===t||t.replace(/\[refId:[^\]]+\]/g,""),(0,He.jsxs)("div",{className:"citable-textarea-wrapper",children:[(0,He.jsx)("textarea",Je({ref:C,value:t,onChange:e=>{const t=e.target.value,a=e.target.selectionStart;n(e);const r=P(t,a);if(r){if(N(r.type),"refs"===r.type)v([{type:"insert-refs",label:"Insert Reference List"}]),b(0),g(!0),w("");else if("macro"===r.type){const e=(e=>{if(!e)return D.slice(0,10);const t=e.toLowerCase();return D.filter(e=>e.trigger.toLowerCase().includes("@"+t)||e.label.toLowerCase().includes(t)).slice(0,10)})(r.query);v(e),w(r.query),b(0),g(e.length>0)}else if(I.length>0){const e=(e=>{if(!e)return I.slice(0,10);const t=e.toLowerCase();return I.filter(n=>{var a,r,o,i;return(null===(a=n.title)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(r=n.authors)||void 0===r?void 0:r.toLowerCase().includes(t))||(null===(o=n.year)||void 0===o?void 0:o.includes(e))||(null===(i=n.pmid)||void 0===i?void 0:i.includes(e))}).slice(0,10)})(r.query);v(e),w(r.query),b(0),g(e.length>0)}if(C.current){const e=C.current,n=e.getBoundingClientRect(),r=parseInt(getComputedStyle(e).lineHeight)||20,o=t.substring(0,a).split("\n").length-1;k({top:n.top+o*r+r+window.scrollY,left:n.left+10})}}else g(!1),N(null)},onKeyDown:e=>{if(h)switch(e.key){case"ArrowDown":e.preventDefault(),b(e=>e<f.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),b(e=>e>0?e-1:f.length-1);break;case"Enter":case"Tab":e.preventDefault(),"refs"===S?R():"macro"===S&&f[y]?L(f[y]):f[y]&&O(f[y]);break;case"Escape":g(!1)}},onPaste:e=>{!c||(c(e),e.defaultPrevented)},placeholder:o||"Type @cite: or [@ to insert a citation, @refs to insert reference list...",rows:i,className:"citable-textarea ".concat(s)},d)),(0,He.jsxs)("div",{className:"citation-hint",children:[(0,He.jsx)("code",{children:"@"})," for commands",I.length>0&&(0,He.jsxs)(He.Fragment,{children:[" \u2022 ",(0,He.jsx)("code",{children:"@cite:"})," or ",(0,He.jsx)("code",{children:"[@"})," to cite \u2022 ",(0,He.jsx)("code",{children:"@refs"})," for reference list"]}),T.order.length>0&&(0,He.jsxs)("span",{className:"citation-count",children:[" \u2022 ",T.order.length," citation",1!==T.order.length?"s":""]})]}),h&&f.length>0&&(0,He.jsx)("div",{ref:E,className:"citation-suggestions",style:{position:"fixed",top:x.top,left:x.left,zIndex:9999},children:"refs"===S?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("div",{className:"suggestions-header",children:"Insert Reference List"}),(0,He.jsxs)("div",{className:"suggestion-item selected refs-insert",onClick:R,children:[(0,He.jsx)("span",{className:"suggestion-icon",children:"\ud83d\udcda"}),(0,He.jsx)("div",{className:"suggestion-content",children:(0,He.jsxs)("span",{className:"suggestion-title",children:["Insert ",T.order.length," reference",1!==T.order.length?"s":""," in citation order"]})})]}),(0,He.jsx)("div",{className:"suggestions-footer",children:"Enter to insert \u2022 Esc to cancel"})]}):"macro"===S?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsxs)("div",{className:"suggestions-header",children:["Insert macro ",j&&'(matching "'.concat(j,'")')]}),f.map((e,t)=>(0,He.jsxs)("div",{className:"suggestion-item ".concat(t===y?"selected":""),onClick:()=>L(e),onMouseEnter:()=>b(t),children:[(0,He.jsx)("span",{className:"suggestion-icon",children:e.icon}),(0,He.jsxs)("div",{className:"suggestion-content",children:[(0,He.jsx)("span",{className:"suggestion-trigger",children:e.trigger}),(0,He.jsx)("span",{className:"suggestion-label",children:e.label})]})]},e.trigger)),(0,He.jsx)("div",{className:"suggestions-footer",children:"\u2191\u2193 Navigate \u2022 Enter/Tab Select \u2022 Esc Close"})]}):(0,He.jsxs)(He.Fragment,{children:[(0,He.jsxs)("div",{className:"suggestions-header",children:["Select reference ",j&&'(matching "'.concat(j,'")')]}),f.map((e,t)=>{var n,a;const r=A(e.id),o=T.refToNum[e.id];return(0,He.jsxs)("div",{className:"suggestion-item ".concat(t===y?"selected":""," ").concat(o?"already-cited":""),onClick:()=>O(e),onMouseEnter:()=>b(t),children:[(0,He.jsxs)("span",{className:"suggestion-number",children:["[",r,"]"]}),(0,He.jsxs)("div",{className:"suggestion-content",children:[(0,He.jsx)("span",{className:"suggestion-author",children:M(e.authors)}),e.year&&(0,He.jsxs)("span",{className:"suggestion-year",children:["(",e.year,")"]}),(0,He.jsxs)("span",{className:"suggestion-title",children:[null===(n=e.title)||void 0===n?void 0:n.substring(0,60),(null===(a=e.title)||void 0===a?void 0:a.length)>60?"...":""]})]}),o&&(0,He.jsx)("span",{className:"already-cited-badge",children:"cited"})]},e.id)}),(0,He.jsx)("div",{className:"suggestions-footer",children:"\u2191\u2193 Navigate \u2022 Enter/Tab Select \u2022 Esc Close"})]})})]})};const ha=function(e){let{attachments:t=[],onRemove:n,onInsert:a,compact:r=!1}=e;const o=t.filter(e=>{var t;return e.isImage||(null===(t=e.mimeType)||void 0===t?void 0:t.startsWith("image/"))});return 0===o.length?null:(0,He.jsx)("div",{className:"image-thumbnail-strip ".concat(r?"compact":""),children:o.map(e=>(0,He.jsxs)("div",{className:"thumbnail-item",children:[(0,He.jsx)("img",{src:e.thumbnailLink||e.downloadUrl||e.url,alt:e.name,title:e.name,onClick:()=>(e=>{e.url?window.open(e.url,"_blank"):e.downloadUrl&&window.open(e.downloadUrl,"_blank")})(e)}),(0,He.jsxs)("div",{className:"thumbnail-actions",children:[a&&(0,He.jsx)("button",{type:"button",className:"btn-insert",onClick:t=>{t.stopPropagation(),a(e)},title:"Insert in text",children:"+"}),n&&(0,He.jsx)("button",{type:"button",className:"btn-remove",onClick:t=>{t.stopPropagation(),n(e.id)},title:"Remove",children:"\xd7"})]}),(0,He.jsx)("span",{className:"thumbnail-name",children:e.name})]},e.id))})};const ga=function(e){let{content:t="",attachments:n=[],className:a=""}=e;const r=(0,l.useMemo)(()=>{const e={};return n.forEach(t=>{e[t.id]=t}),e},[n]),o=(0,l.useMemo)(()=>{if(!t)return null;return t.split(/(!\[[^\]]*\]\(attachment:[^)]+\))/g).map((e,t)=>{const n=e.match(/!\[([^\]]*)\]\(attachment:([^)]+)\)/);if(n){var a;const[,e,o]=n,i=r[o];if(i&&(i.isImage||null!==(a=i.mimeType)&&void 0!==a&&a.startsWith("image/"))){const n=i.thumbnailLink||i.downloadUrl||i.url;return(0,He.jsx)("span",{className:"inline-image-wrapper",children:(0,He.jsx)("img",{src:n,alt:e||i.name,className:"inline-image",onClick:()=>window.open(i.url||i.downloadUrl,"_blank"),title:"".concat(i.name," - Click to open full size")})},t)}return(0,He.jsxs)("span",{className:"missing-attachment",children:["[Image: ",e||"Unknown","]"]},t)}return e?(0,He.jsx)("span",{children:e.split("\n").map((e,t,n)=>(0,He.jsxs)(l.Fragment,{children:[e,t<n.length-1&&(0,He.jsx)("br",{})]},t))},t):null})},[t,r]);return(0,He.jsx)("div",{className:"markdown-preview ".concat(a),children:o||(0,He.jsx)("span",{className:"empty-content",children:"No content"})})};function fa(){let{onFilesUploaded:e,onUploadProgress:t,maxFiles:n=10,acceptedTypes:a=null,imageOnly:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{isSignedIn:o,uploadFileToDrive:i}=lt(),[s,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)(!1),[p,m]=(0,l.useState)(""),h=(0,l.useRef)(null),g=(0,l.useRef)(0),f=(0,l.useCallback)(e=>{if(!e||0===e.length)return[];let t=Array.from(e);return r&&(t=t.filter(e=>e.type.startsWith("image/"))),a&&a.length>0&&(t=t.filter(e=>a.some(t=>{if(t.endsWith("/*")){const n=t.slice(0,-2);return e.type.startsWith(n)}return e.type===t}))),t.slice(0,n)},[a,r,n]),v=(0,l.useCallback)(async n=>{if(!o)return console.warn("Cannot upload files: not signed in to Google"),[];const a=f(n);if(0===a.length)return[];u(!0);const r=[];for(let e=0;e<a.length;e++){const n=a[e],o="Uploading ".concat(e+1,"/").concat(a.length,": ").concat(n.name);m(o),t&&t(o);try{const e=await i(n);var l;if(e)r.push({id:e.id,name:e.name,mimeType:e.mimeType,url:e.webViewLink,downloadUrl:e.webContentLink,thumbnailLink:e.thumbnailLink,iconUrl:e.iconLink,uploadedAt:(new Date).toISOString(),source:"upload",isImage:null===(l=e.mimeType)||void 0===l?void 0:l.startsWith("image/"),size:n.size})}catch(s){console.error("Error uploading ".concat(n.name,":"),s)}}return u(!1),m(""),t&&t(""),r.length>0&&e&&e(r),r},[o,f,i,e,t]),y=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),g.current++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&c(!0)},[]),b=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation()},[]),x=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),g.current--,0===g.current&&c(!1)},[]),k=(0,l.useCallback)(async e=>{var t;e.preventDefault(),e.stopPropagation(),c(!1),g.current=0;const n=null===(t=e.dataTransfer)||void 0===t?void 0:t.files;n&&n.length>0&&await v(n)},[v]),j=(0,l.useCallback)(async e=>{var t;const n=null===(t=e.clipboardData)||void 0===t?void 0:t.items;if(!n)return;const a=[];for(const r of n)if("file"===r.kind){const e=r.getAsFile();e&&a.push(e)}a.length>0&&(e.preventDefault(),await v(a))},[v]),w=(0,l.useCallback)(async e=>{const t=e.target.files;t&&t.length>0&&await v(t),h.current&&(h.current.value="")},[v]),S=(0,l.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;h.current&&(h.current.accept=e||(r?"image/*":a?a.join(","):""),h.current.click())},[r,a]),N=(0,l.useCallback)(()=>(0,He.jsx)("input",{ref:h,type:"file",multiple:!0,style:{display:"none"},onChange:w}),[w]);return{isDragging:s,isUploading:d,uploadProgress:p,isSignedIn:o,dragHandlers:{onDragEnter:y,onDragOver:b,onDragLeave:x,onDrop:k},pasteHandler:j,triggerFileDialog:S,FileInput:N,fileInputRef:h,processFiles:v}}const va=["value","onChange","attachments","onAttachmentsChange","variant","showThumbnails","enableInlineImages","showPreviewToggle","projectId","projectName","placeholder","rows","className","disabled"];const ya=function(e){let{value:t="",onChange:n,attachments:a=[],onAttachmentsChange:r,variant:o="macro",showThumbnails:i=!0,enableInlineImages:s=!0,showPreviewToggle:c=!0,projectId:d,projectName:u,placeholder:p,rows:m=4,className:h="",disabled:g=!1}=e,f=na(e,va);const{isSignedIn:v}=lt(),[y,b]=(0,l.useState)(!1),x=(0,l.useRef)(null),k=(0,l.useRef)(null),j=(0,l.useCallback)(e=>{if(!r)return;const t=[...a,...e];if(r(t),s){const t=e.filter(e=>e.isImage);if(t.length>0){const e=t.map(e=>"![".concat(e.name,"](attachment:").concat(e.id,")")).join("\n");T(e+"\n")}}},[a,r,s]),{isDragging:w,isUploading:S,uploadProgress:N,dragHandlers:C,pasteHandler:E,triggerFileDialog:I,FileInput:D}=fa({onFilesUploaded:j,maxFiles:10}),T=(0,l.useCallback)(e=>{let a=k.current;var r;a||(a=null===(r=x.current)||void 0===r?void 0:r.querySelector("textarea"));if(!a)return;const i=a.selectionStart||0,l=a.selectionEnd||0,s=t||"",c=s.substring(0,i)+e+s.substring(l);n("plain"===o?{target:{value:c}}:c),setTimeout(()=>{if(a){a.focus();const t=i+e.length;a.setSelectionRange(t,t)}},0)},[t,n,o]),A=(0,l.useCallback)(e=>{if(!r)return;const i=a.filter(t=>t.id!==e);r(i);const l=new RegExp("!\\[[^\\]]*\\]\\(attachment:".concat(e,"\\)\\n?"),"g"),s=(t||"").replace(l,"");s!==t&&n("plain"===o?{target:{value:s}}:s)},[a,r,t,n,o]),P=(0,l.useCallback)(e=>{const t="![".concat(e.name,"](attachment:").concat(e.id,")\n");T(t)},[T]),O=(0,l.useCallback)(e=>{n(e)},[n,o]),L=a.filter(e=>{var t;return e.isImage||(null===(t=e.mimeType)||void 0===t?void 0:t.startsWith("image/"))});return(0,He.jsxs)("div",Je(Je({ref:x,className:"file-upload-textarea-wrapper ".concat(w?"drag-active":""," ").concat(g?"disabled":"")},C),{},{children:[c&&a.some(e=>e.isImage)&&(0,He.jsxs)("div",{className:"textarea-mode-toggle",children:[(0,He.jsx)("button",{type:"button",className:y?"":"active",onClick:()=>b(!1),children:"Edit"}),(0,He.jsx)("button",{type:"button",className:y?"active":"",onClick:()=>b(!0),children:"Preview"})]}),w&&(0,He.jsx)("div",{className:"drop-overlay",children:(0,He.jsxs)("div",{className:"drop-overlay-content",children:[(0,He.jsx)("span",{className:"drop-icon",children:"\ud83d\udcce"}),(0,He.jsx)("span",{children:"Drop files to upload"})]})}),y?(0,He.jsx)(ga,{content:t,attachments:a,className:"preview-content"}):(()=>{const e=Je({value:t,placeholder:p||"Type here... (drag files to upload, Ctrl+V to paste images)",rows:m,className:"upload-textarea ".concat(h),disabled:g||S,onPaste:E},f);switch(o){case"citable":return(0,He.jsx)(ma,Je(Je({},e),{},{onChange:O,projectId:d,projectName:u}));case"plain":return(0,He.jsx)("textarea",Je(Je({ref:k},e),{},{onChange:O}));default:return(0,He.jsx)(ua,Je(Je({},e),{},{onChange:O,projectName:u}))}})(),S&&(0,He.jsxs)("div",{className:"upload-indicator",children:[(0,He.jsx)("span",{className:"spinner"}),(0,He.jsx)("span",{children:N})]}),i&&L.length>0&&!y&&(0,He.jsx)(ha,{attachments:L,onRemove:A,onInsert:P}),(0,He.jsxs)("div",{className:"upload-textarea-actions",children:[v?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("button",{type:"button",className:"btn-upload-file",onClick:()=>I(),disabled:S||g,title:"Add file attachment",children:"\ud83d\udcce Add File"}),(0,He.jsx)("button",{type:"button",className:"btn-upload-image",onClick:()=>I("image/*"),disabled:S||g,title:"Add image",children:"\ud83d\uddbc\ufe0f Add Image"})]}):(0,He.jsx)("span",{className:"upload-disabled-hint",children:"Connect Google Drive to add files"}),a.length>0&&(0,He.jsxs)("span",{className:"attachment-count",children:[a.length," file",1!==a.length?"s":""," attached"]})]}),(0,He.jsx)(D,{})]}))},ba="create",xa="update",ka="lock",ja="archive",wa="restore";function Sa(e){if(!e)return"";let t=0;const n="string"===typeof e?e:JSON.stringify(e);for(let a=0;a<n.length;a++){t=(t<<5)-t+n.charCodeAt(a),t&=t}return Math.abs(t).toString(16).padStart(8,"0")}function Na(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{id:"audit-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),timestamp:(new Date).toISOString(),changeType:e,changes:t,userId:(null===n||void 0===n?void 0:n.id)||null,userName:(null===n||void 0===n?void 0:n.name)||(null===n||void 0===n?void 0:n.email)||"Anonymous",checksum:a?Sa(a):null}}const Ca="research-dashboard-lab-notebook",Ea="research-dashboard-eln-settings",Ia={autoLockEnabled:!0,autoLockHours:24,showArchivedEntries:!1};const Da=function(e){let{isOpen:t,onClose:n}=e;const{isSignedIn:a,user:r,createDoc:o,syncToDoc:i,importFromDoc:s,createSheet:c,syncToSheet:d,importFromSheet:u}=lt(),p=St(),[m,h]=(0,l.useState)([]),[g,f]=(0,l.useState)(!1),[v,y]=(0,l.useState)({title:"",content:"",projectId:"",tags:[],attachments:[]}),[b,x]=(0,l.useState)(""),[k,j]=(0,l.useState)("all"),[w,S]=(0,l.useState)(""),[N,C]=(0,l.useState)(null),[E,I]=(0,l.useState)({message:"",type:""}),[D,T]=(0,l.useState)(Ia),[A,P]=(0,l.useState)(null),[O,L]=(0,l.useState)(!1),[R,M]=(0,l.useState)([]);(0,l.useEffect)(()=>{try{const e=localStorage.getItem("research-dashboard-custom-projects");e&&M(JSON.parse(e))}catch(Fr){}},[]);const F=[...Cn,...R];(0,l.useEffect)(()=>{try{const e=localStorage.getItem(Ea);e&&T(Je(Je({},Ia),JSON.parse(e)))}catch(Fr){}},[]),(0,l.useCallback)(e=>{localStorage.setItem(Ea,JSON.stringify(e)),T(e),p()},[p]),(0,l.useEffect)(()=>{const e=localStorage.getItem(Ca);if(e)try{let t=JSON.parse(e),n=!1;t=t.map(e=>{if(function(e,t){var n,a;if(null===t||void 0===t||!t.autoLockEnabled||e.isLocked)return!1;const r=null!==(n=null!==(a=e.lockAfterHours)&&void 0!==a?a:t.autoLockHours)&&void 0!==n?n:24,o=new Date(e.createdAt).getTime();return(Date.now()-o)/36e5>=r}(e,D)&&!e.isLocked){n=!0;const t=Na(ka,[],{name:"System (Auto-Lock)"},e.content);return Je(Je({},e),{},{isLocked:!0,lockedAt:(new Date).toISOString(),lockedBy:"System (Auto-Lock)",auditTrail:[...e.auditTrail||[],t]})}return e}),h(t),n&&localStorage.setItem(Ca,JSON.stringify(t))}catch(Fr){console.error("Failed to load notebook entries:",Fr)}},[D]);const U=(0,l.useCallback)(e=>{localStorage.setItem(Ca,JSON.stringify(e)),h(e),p()},[p]),_=e=>new Date(e).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),z=e=>{const t=new Date(e),n=new Date,a=new Date(n);return a.setDate(a.getDate()-1),t.toDateString()===n.toDateString()?"Today":t.toDateString()===a.toDateString()?"Yesterday":t.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},B=(e,t)=>{const n=m.find(t=>t.id===e),a=["googleDocId","googleDocUrl","googleSheetId","googleSheetUrl"],o=Object.keys(t).every(e=>a.includes(e));if(null!==n&&void 0!==n&&n.isLocked&&!o)return I({message:"Cannot modify locked entry",type:"error"}),void setTimeout(()=>I({message:"",type:""}),3e3);const i=function(e,t){const n=[];return e&&t?(((arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)||[...new Set([...Object.keys(e),...Object.keys(t)])]).forEach(a=>{if(a.startsWith("_")||"auditTrail"===a||"updatedAt"===a)return;const r=e[a],o=t[a];("object"===typeof r?JSON.stringify(r):r)!==("object"===typeof o?JSON.stringify(o):o)&&n.push({field:a,oldValue:r,newValue:o})}),n):n}(n,Je(Je({},n),t),["title","content","tags","projectId"]),l=i.length>0?Na(xa,i,{name:(null===r||void 0===r?void 0:r.name)||(null===r||void 0===r?void 0:r.email)},t.content||n.content):null,s=m.map(n=>n.id===e?Je(Je(Je({},n),t),{},{updatedAt:(new Date).toISOString(),auditTrail:l?[...n.auditTrail||[],l]:n.auditTrail}):n);U(s),(null===N||void 0===N?void 0:N.id)===e&&C(Je(Je({},N),t))},G=()=>{b.trim()&&!v.tags.includes(b.trim())&&(y(Je(Je({},v),{},{tags:[...v.tags,b.trim()]})),x(""))},W=m.filter(e=>{var t;return!e.projectId||(null===(t=e.tags)||void 0===t?void 0:t.includes("inbox"))||e.isQuickCapture}).length,V=m.filter(e=>{var t;if(e.isArchived&&!D.showArchivedEntries)return!1;let n="all"===k;if("inbox"===k){var a;n=!e.projectId||(null===(a=e.tags)||void 0===a?void 0:a.includes("inbox"))||e.isQuickCapture}else{if("archived"===k)return e.isArchived;""===k?n=!e.projectId:"all"!==k&&(n=e.projectId===k)}const r=!w||e.title.toLowerCase().includes(w.toLowerCase())||e.content.toLowerCase().includes(w.toLowerCase())||(null===(t=e.tags)||void 0===t?void 0:t.some(e=>e.toLowerCase().includes(w.toLowerCase())));return n&&r}),q=m.filter(e=>e.isArchived).length,K=V.reduce((e,t)=>{const n=new Date(t.createdAt).toDateString();return e[n]||(e[n]=[]),e[n].push(t),e},{}),J=e=>{const t=F.find(t=>t.id===e);return(null===t||void 0===t?void 0:t.color)||"#888"};return t?(0,He.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,He.jsxs)("div",{className:"notebook-modal-content",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"notebook-header",children:[(0,He.jsxs)("div",{className:"notebook-title-row",children:[(0,He.jsx)("h2",{children:"Lab Notebook"}),(0,He.jsx)("div",{className:"notebook-google-status",children:a?(0,He.jsx)("span",{className:"google-status-text connected",children:"Google Connected"}):(0,He.jsx)("span",{className:"google-status-text",children:"Sign in via navbar for Google Docs"})})]}),(0,He.jsx)("button",{className:"modal-close",onClick:n,children:"\xd7"})]}),E.message&&(0,He.jsxs)("div",{className:"notebook-sync-status ".concat(E.type),children:[E.message,(0,He.jsx)("button",{onClick:()=>I({message:"",type:""}),children:"x"})]}),(0,He.jsxs)("div",{className:"notebook-toolbar",children:[(0,He.jsx)("button",{className:"new-entry-btn",onClick:()=>f(!0),children:"+ New Entry"}),(0,He.jsxs)("div",{className:"notebook-filters",children:[(0,He.jsx)("input",{type:"text",className:"notebook-search",placeholder:"Search entries...",value:w,onChange:e=>S(e.target.value)}),(0,He.jsxs)("select",{className:"notebook-project-filter",value:k,onChange:e=>j(e.target.value),children:[(0,He.jsx)("option",{value:"all",children:"All Entries"}),(0,He.jsxs)("option",{value:"inbox",children:["Inbox (",W,")"]}),(0,He.jsx)("option",{value:"",children:"Unassigned"}),q>0&&(0,He.jsxs)("option",{value:"archived",children:["Archived (",q,")"]}),F.map(e=>(0,He.jsx)("option",{value:e.id,children:e.title},e.id))]})]})]}),(0,He.jsxs)("div",{className:"notebook-body",children:[g&&(0,He.jsxs)("div",{className:"new-entry-form",children:[(0,He.jsx)("input",{type:"text",className:"entry-title-input",placeholder:"Entry title...",value:v.title,onChange:e=>y(Je(Je({},v),{},{title:e.target.value})),autoFocus:!0}),(0,He.jsx)(ya,{className:"entry-content-input",placeholder:"Write your lab notes here... (type @ for commands, drag files to upload)",value:v.content,onChange:e=>y(Je(Je({},v),{},{content:e})),attachments:v.attachments,onAttachmentsChange:e=>y(Je(Je({},v),{},{attachments:e})),variant:"macro",rows:8}),(0,He.jsxs)("div",{className:"entry-meta-row",children:[(0,He.jsxs)("select",{className:"entry-project-select",value:v.projectId,onChange:e=>y(Je(Je({},v),{},{projectId:e.target.value})),children:[(0,He.jsx)("option",{value:"",children:"Link to project (optional)"}),F.map(e=>(0,He.jsx)("option",{value:e.id,children:e.title},e.id))]}),(0,He.jsxs)("div",{className:"entry-tags-input",children:[(0,He.jsx)("input",{type:"text",placeholder:"Add tag...",value:b,onChange:e=>x(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),G())}),(0,He.jsx)("button",{onClick:G,children:"+"})]})]}),v.tags.length>0&&(0,He.jsx)("div",{className:"entry-tags",children:v.tags.map(e=>(0,He.jsxs)("span",{className:"entry-tag",children:[e,(0,He.jsx)("button",{onClick:()=>y(Je(Je({},v),{},{tags:v.tags.filter(t=>t!==e)})),children:"x"})]},e))}),(0,He.jsxs)("div",{className:"entry-form-actions",children:[(0,He.jsx)("button",{className:"btn-cancel",onClick:()=>{f(!1),y({title:"",content:"",projectId:"",tags:[],attachments:[]})},children:"Cancel"}),(0,He.jsx)("button",{className:"btn-submit",onClick:()=>{if(!v.title.trim()&&!v.content.trim())return;const e=Na(ba,[],{name:(null===r||void 0===r?void 0:r.name)||(null===r||void 0===r?void 0:r.email)},v.content),t={id:"entry-".concat(Date.now()),title:v.title.trim()||"Untitled Entry",content:v.content,projectId:v.projectId||null,tags:v.tags,attachments:v.attachments||[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),googleDocId:null,googleDocUrl:null,googleSheetId:null,googleSheetUrl:null,auditTrail:[e],isLocked:!1,lockedAt:null,lockedBy:null,isArchived:!1,archivedAt:null,archivedBy:null};U([t,...m]),y({title:"",content:"",projectId:"",tags:[],attachments:[]}),f(!1)},children:"Save Entry"})]})]}),(0,He.jsx)("div",{className:"notebook-entries",children:0===Object.keys(K).length?(0,He.jsxs)("div",{className:"notebook-empty",children:[(0,He.jsx)("p",{children:"No notebook entries yet."}),(0,He.jsx)("p",{className:"hint",children:'Start documenting your research by clicking "+ New Entry"'})]}):Object.entries(K).map(e=>{let[t,n]=e;return(0,He.jsxs)("div",{className:"notebook-day-group",children:[(0,He.jsx)("h3",{className:"day-header",children:z(n[0].createdAt)}),n.map(e=>{var t;return(0,He.jsxs)("div",{className:"notebook-entry ".concat((null===N||void 0===N?void 0:N.id)===e.id?"selected":""," ").concat(e.isArchived?"archived":""," ").concat(e.isLocked?"locked":""),children:[(0,He.jsxs)("div",{className:"entry-main",onClick:()=>C((null===N||void 0===N?void 0:N.id)===e.id?null:e),children:[(0,He.jsxs)("div",{className:"entry-header",children:[(0,He.jsx)("span",{className:"entry-time",children:new Date(e.createdAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}),e.projectId?(0,He.jsx)("span",{className:"entry-project-badge",style:{backgroundColor:J(e.projectId)},children:(null===(t=F.find(t=>t.id===e.projectId))||void 0===t?void 0:t.title)||"Project"}):(0,He.jsx)("span",{className:"entry-inbox-badge",title:"In inbox - assign to project",children:"Inbox"}),e.isQuickCapture&&(0,He.jsx)("span",{className:"quick-capture-badge",title:"Quick Capture",children:"Quick"}),e.googleDocId&&(0,He.jsx)("span",{className:"google-doc-badge",title:"Linked to Google Doc",children:"G"}),e.googleSheetId&&(0,He.jsx)("span",{className:"google-sheet-badge",title:"Linked to Google Sheet",children:"S"}),e.isLocked&&(0,He.jsx)("span",{className:"eln-locked-badge",title:"Locked by ".concat(e.lockedBy," on ").concat(_(e.lockedAt)),children:"Locked"}),e.isArchived&&(0,He.jsx)("span",{className:"eln-archived-badge",title:"Archived by ".concat(e.archivedBy," on ").concat(_(e.archivedAt)),children:"Archived"})]}),(0,He.jsx)("h4",{className:"entry-title",children:e.title}),(0,He.jsxs)("p",{className:"entry-preview",children:[e.content.slice(0,150),e.content.length>150&&"..."]}),e.tags.length>0&&(0,He.jsx)("div",{className:"entry-tags-display",children:e.tags.map(e=>(0,He.jsx)("span",{className:"entry-tag-badge",children:e},e))})]}),(null===N||void 0===N?void 0:N.id)===e.id&&(0,He.jsxs)("div",{className:"entry-expanded",children:[e.isLocked&&(0,He.jsxs)("div",{className:"eln-locked-notice",children:["This entry is locked and cannot be edited.",e.lockedBy&&" (Locked by ".concat(e.lockedBy,")")]}),(0,He.jsx)("div",{className:"entry-full-content",children:(0,He.jsx)(ya,{value:e.content,onChange:t=>B(e.id,{content:t}),attachments:e.attachments||[],onAttachmentsChange:t=>B(e.id,{attachments:t}),variant:"macro",rows:10,disabled:e.isLocked})}),(0,He.jsxs)("div",{className:"entry-assignment",children:[(0,He.jsx)("label",{children:"Assign to Project:"}),(0,He.jsxs)("select",{className:"entry-project-assign",value:e.projectId||"",disabled:e.isLocked,onChange:t=>{var n;const a=t.target.value||null,r=a?(null===(n=e.tags)||void 0===n?void 0:n.filter(e=>"inbox"!==e))||[]:e.tags||[];B(e.id,{projectId:a,tags:r,isQuickCapture:!a&&e.isQuickCapture})},children:[(0,He.jsx)("option",{value:"",children:"No Project (Inbox)"}),F.map(e=>(0,He.jsx)("option",{value:e.id,children:e.title},e.id))]}),!e.projectId&&(0,He.jsx)("span",{className:"assignment-hint",children:"Select a project to organize this entry"})]}),(0,He.jsxs)("div",{className:"entry-actions",children:[a&&(0,He.jsxs)(He.Fragment,{children:[(0,He.jsxs)("div",{className:"google-actions-row",children:[(0,He.jsx)("span",{className:"google-action-label",children:"Docs:"}),e.googleDocId?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("a",{href:e.googleDocUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-action small",children:"Open"}),(0,He.jsx)("button",{className:"btn-action small",onClick:()=>(async e=>{var t;if(!e.googleDocId)return void I({message:"No Google Doc linked to this entry",type:"error"});I({message:"Syncing to Google Doc...",type:"info"});const n=e.projectId?(null===(t=F.find(t=>t.id===e.projectId))||void 0===t?void 0:t.title)||"Unknown Project":"No Project",a="Lab Notebook Entry\n\nTitle: ".concat(e.title,"\nDate: ").concat(_(e.createdAt),"\nLast Updated: ").concat(_(e.updatedAt),"\nProject: ").concat(n,"\nTags: ").concat(e.tags.join(", ")||"None","\n\n---\n\n").concat(e.content),r=await i(e.googleDocId,a);I(r?{message:"Synced to Google Doc!",type:"success"}:{message:"Failed to sync to Google Doc",type:"error"}),setTimeout(()=>I({message:"",type:""}),3e3)})(e),title:"Push to Google Doc",children:"\u2b06"}),(0,He.jsx)("button",{className:"btn-action small",onClick:()=>(async e=>{if(!e.googleDocId)return void I({message:"No Google Doc linked to this entry",type:"error"});I({message:"Importing from Google Doc...",type:"info"});const t=await s(e.googleDocId);if(t){let n=t.content;const a=n.indexOf("---");-1!==a&&(n=n.substring(a+3).trim()),B(e.id,{content:n}),I({message:"Imported from Google Doc!",type:"success"})}else I({message:"Failed to import from Google Doc",type:"error"});setTimeout(()=>I({message:"",type:""}),3e3)})(e),title:"Pull from Google Doc",children:"\u2b07"})]}):(0,He.jsx)("button",{className:"btn-action small primary",onClick:()=>(async e=>{var t;if(!a)return I({message:"Please sign in to Google first (use navbar button)",type:"error"}),void setTimeout(()=>I({message:"",type:""}),3e3);I({message:"Creating Google Doc...",type:"info"});const n=e.projectId?(null===(t=F.find(t=>t.id===e.projectId))||void 0===t?void 0:t.title)||"Unknown Project":"No Project",r="Lab Notebook Entry\n\nTitle: ".concat(e.title,"\nDate: ").concat(_(e.createdAt),"\nProject: ").concat(n,"\nTags: ").concat(e.tags.join(", ")||"None","\n\n---\n\n").concat(e.content),i=await o("[Lab Notebook] ".concat(e.title),r);i?(B(e.id,{googleDocId:i.docId,googleDocUrl:i.docUrl}),I({message:"Google Doc created successfully!",type:"success"}),window.open(i.docUrl,"_blank")):I({message:"Failed to create Google Doc",type:"error"}),setTimeout(()=>I({message:"",type:""}),3e3)})(e),children:"+ Create"})]}),(0,He.jsxs)("div",{className:"google-actions-row",children:[(0,He.jsx)("span",{className:"google-action-label",children:"Sheets:"}),e.googleSheetId?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("a",{href:e.googleSheetUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-action small",children:"Open"}),(0,He.jsx)("button",{className:"btn-action small",onClick:()=>(async e=>{var t;if(!e.googleSheetId)return void I({message:"No Google Sheet linked to this entry",type:"error"});I({message:"Syncing to Google Sheet...",type:"info"});const n=e.projectId?(null===(t=F.find(t=>t.id===e.projectId))||void 0===t?void 0:t.title)||"Unknown Project":"No Project",a=[["Title",e.title],["Date",_(e.createdAt)],["Project",n],["Tags",e.tags.join(", ")||"None"],["Content",e.content],["Last Updated",_(e.updatedAt)]],r=await d(e.googleSheetId,["Field","Value"],a);I(r?{message:"Synced to Google Sheet!",type:"success"}:{message:"Failed to sync to Google Sheet",type:"error"}),setTimeout(()=>I({message:"",type:""}),3e3)})(e),title:"Push to Google Sheet",children:"\u2b06"}),(0,He.jsx)("button",{className:"btn-action small",onClick:()=>(async e=>{if(!e.googleSheetId)return void I({message:"No Google Sheet linked to this entry",type:"error"});I({message:"Importing from Google Sheet...",type:"info"});const t=await u(e.googleSheetId);if(t&&t.data){const n={};t.data.forEach(e=>{var t;const a=null===(t=e[0])||void 0===t?void 0:t.toLowerCase(),r=e[1]||"";"content"===a&&(n.content=r),"tags"===a&&(n.tags=r.split(",").map(e=>e.trim()).filter(Boolean))}),Object.keys(n).length>0&&B(e.id,n),I({message:"Imported from Google Sheet!",type:"success"})}else I({message:"Failed to import from Google Sheet",type:"error"});setTimeout(()=>I({message:"",type:""}),3e3)})(e),title:"Pull from Google Sheet",children:"\u2b07"})]}):(0,He.jsx)("button",{className:"btn-action small primary",onClick:()=>(async e=>{var t;if(!a)return I({message:"Please sign in to Google first (use navbar button)",type:"error"}),void setTimeout(()=>I({message:"",type:""}),3e3);I({message:"Creating Google Sheet...",type:"info"});const n=e.projectId?(null===(t=F.find(t=>t.id===e.projectId))||void 0===t?void 0:t.title)||"Unknown Project":"No Project",r=[["Title",e.title],["Date",_(e.createdAt)],["Project",n],["Tags",e.tags.join(", ")||"None"],["Content",e.content],["Last Updated",_(e.updatedAt)]],o=await c("[Lab Notebook] ".concat(e.title),["Field","Value"],r);o?(B(e.id,{googleSheetId:o.spreadsheetId,googleSheetUrl:o.sheetUrl}),I({message:"Google Sheet created!",type:"success"}),window.open(o.sheetUrl,"_blank")):I({message:"Failed to create Google Sheet",type:"error"}),setTimeout(()=>I({message:"",type:""}),3e3)})(e),children:"+ Create"})]})]}),!e.isLocked&&!e.isArchived&&(0,He.jsx)("button",{className:"btn-action",onClick:()=>(e=>{if(window.confirm("Lock this entry? Locked entries cannot be edited.")){const t=Na(ka,[],{name:(null===r||void 0===r?void 0:r.name)||(null===r||void 0===r?void 0:r.email)}),n=m.map(n=>n.id===e?Je(Je({},n),{},{isLocked:!0,lockedAt:(new Date).toISOString(),lockedBy:(null===r||void 0===r?void 0:r.name)||(null===r||void 0===r?void 0:r.email)||"Unknown",auditTrail:[...n.auditTrail||[],t]}):n);U(n),(null===N||void 0===N?void 0:N.id)===e&&C(Je(Je({},N),{},{isLocked:!0})),I({message:"Entry locked",type:"success"}),setTimeout(()=>I({message:"",type:""}),2e3)}})(e.id),title:"Lock entry to prevent further edits",children:"Lock"}),(0,He.jsx)("button",{className:"btn-action",onClick:()=>P(e.id),title:"View version history",children:"History"}),e.isArchived?(0,He.jsx)("button",{className:"btn-action",onClick:()=>(e=>{const t=Na(wa,[],{name:(null===r||void 0===r?void 0:r.name)||(null===r||void 0===r?void 0:r.email)}),n=m.map(n=>n.id===e?Je(Je({},n),{},{isArchived:!1,archivedAt:null,archivedBy:null,auditTrail:[...n.auditTrail||[],t]}):n);U(n)})(e.id),children:"Restore"}):(0,He.jsx)("button",{className:"btn-action danger",onClick:()=>(e=>{const t=m.find(t=>t.id===e);if(null!==t&&void 0!==t&&t.isLocked)return I({message:"Cannot archive locked entry",type:"error"}),void setTimeout(()=>I({message:"",type:""}),3e3);if(window.confirm("Archive this notebook entry? It can be restored later.")){const t=Na(ja,[],{name:(null===r||void 0===r?void 0:r.name)||(null===r||void 0===r?void 0:r.email)}),n=m.map(n=>n.id===e?Je(Je({},n),{},{isArchived:!0,archivedAt:(new Date).toISOString(),archivedBy:(null===r||void 0===r?void 0:r.name)||(null===r||void 0===r?void 0:r.email)||"Unknown",auditTrail:[...n.auditTrail||[],t]}):n);U(n),(null===N||void 0===N?void 0:N.id)===e&&C(null)}})(e.id),disabled:e.isLocked,title:e.isLocked?"Cannot archive locked entry":"Archive entry",children:"Archive"})]}),(0,He.jsxs)("div",{className:"entry-meta-info",children:[(0,He.jsxs)("span",{children:["Created: ",_(e.createdAt)]}),e.updatedAt!==e.createdAt&&(0,He.jsxs)("span",{children:["Updated: ",_(e.updatedAt)]})]})]})]},e.id)})]},t)})})]}),A&&(0,He.jsx)("div",{className:"eln-version-history-overlay",onClick:()=>P(null),children:(0,He.jsxs)("div",{className:"eln-version-history-modal",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"version-history-header",children:[(0,He.jsx)("h3",{children:"Version History"}),(0,He.jsx)("button",{className:"modal-close",onClick:()=>P(null),children:"\xd7"})]}),(0,He.jsx)("div",{className:"version-history-content",children:(()=>{const e=m.find(e=>e.id===A);return e&&e.auditTrail&&0!==e.auditTrail.length?(0,He.jsx)("div",{className:"audit-timeline",children:[...e.auditTrail].reverse().map((e,t)=>(0,He.jsxs)("div",{className:"audit-entry ".concat(e.changeType),children:[(0,He.jsx)("div",{className:"audit-marker"}),(0,He.jsxs)("div",{className:"audit-details",children:[(0,He.jsxs)("div",{className:"audit-header",children:[(0,He.jsx)("span",{className:"audit-type-badge ".concat(e.changeType),children:e.changeType}),(0,He.jsx)("span",{className:"audit-time",children:_(e.timestamp)})]}),(0,He.jsxs)("div",{className:"audit-user",children:["By: ",e.userName||"Unknown"]}),e.changes&&e.changes.length>0&&(0,He.jsx)("div",{className:"audit-changes",children:e.changes.map((e,t)=>(0,He.jsxs)("div",{className:"audit-change",children:[(0,He.jsxs)("strong",{children:[e.field,":"]}),"string"===typeof e.oldValue&&e.oldValue.length>50?(0,He.jsx)("span",{className:"change-text",children:" (content modified)"}):(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("span",{className:"old-value",children:JSON.stringify(e.oldValue)}),(0,He.jsx)("span",{className:"change-arrow",children:" \u2192 "}),(0,He.jsx)("span",{className:"new-value",children:JSON.stringify(e.newValue)})]})]},t))}),e.checksum&&(0,He.jsxs)("div",{className:"audit-checksum",children:["Checksum: ",(0,He.jsx)("code",{children:e.checksum})]})]})]},e.id||t))}):(0,He.jsx)("p",{className:"no-history",children:"No version history available"})})()})]})})]})}):null};const Ta=function(e){let{isOpen:t,onClose:n}=e;const{settings:a,updateSettings:r,lastBackup:o,isBackingUp:i,exportToGoogleDrive:s,listDriveBackups:c,restoreFromDriveBackup:d,deleteDriveBackup:u,isSignedIn:p}=Mt(),{signIn:m}=lt(),[h,g]=(0,l.useState)([]),[f,v]=(0,l.useState)(!1),[y,b]=(0,l.useState)("settings");(0,l.useEffect)(()=>{t&&p&&"backups"===y&&x()},[t,p,y]);const x=async()=>{v(!0);const e=await c();g(e),v(!1)};return t?(0,He.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,He.jsxs)("div",{className:"backup-settings-modal",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"modal-header",children:[(0,He.jsx)("h2",{children:"Backup Settings"}),(0,He.jsx)("button",{className:"close-btn",onClick:n,children:"\xd7"})]}),(0,He.jsxs)("div",{className:"backup-tabs",children:[(0,He.jsx)("button",{className:"tab-btn ".concat("settings"===y?"active":""),onClick:()=>b("settings"),children:"Settings"}),(0,He.jsx)("button",{className:"tab-btn ".concat("backups"===y?"active":""),onClick:()=>b("backups"),children:"Google Drive Backups"})]}),(0,He.jsxs)("div",{className:"modal-content",children:["settings"===y&&(0,He.jsxs)("div",{className:"settings-tab",children:[(0,He.jsxs)("div",{className:"setting-group",children:[(0,He.jsxs)("label",{className:"setting-label",children:[(0,He.jsx)("input",{type:"checkbox",checked:a.enabled,onChange:e=>r({enabled:e.target.checked})}),"Enable Auto-Backup"]}),(0,He.jsx)("p",{className:"setting-description",children:"Automatically backup your data to Google Drive at regular intervals"})]}),(0,He.jsxs)("div",{className:"setting-group",children:[(0,He.jsx)("label",{className:"setting-label",children:"Backup Interval"}),(0,He.jsxs)("select",{value:a.intervalMinutes,onChange:e=>r({intervalMinutes:parseInt(e.target.value)}),disabled:!a.enabled,children:[(0,He.jsx)("option",{value:5,children:"Every 5 minutes"}),(0,He.jsx)("option",{value:10,children:"Every 10 minutes"}),(0,He.jsx)("option",{value:15,children:"Every 15 minutes"}),(0,He.jsx)("option",{value:30,children:"Every 30 minutes"}),(0,He.jsx)("option",{value:60,children:"Every hour"}),(0,He.jsx)("option",{value:120,children:"Every 2 hours"}),(0,He.jsx)("option",{value:240,children:"Every 4 hours"}),(0,He.jsx)("option",{value:480,children:"Every 8 hours"}),(0,He.jsx)("option",{value:1440,children:"Once a day"})]})]}),(0,He.jsxs)("div",{className:"setting-group",children:[(0,He.jsxs)("label",{className:"setting-label",children:[(0,He.jsx)("input",{type:"checkbox",checked:a.backupOnExit,onChange:e=>r({backupOnExit:e.target.checked})}),"Backup on Exit"]}),(0,He.jsx)("p",{className:"setting-description",children:"Attempt to backup when you close or leave the page"})]}),(0,He.jsxs)("div",{className:"backup-status",children:[(0,He.jsx)("h3",{children:"Status"}),o?(0,He.jsxs)("p",{children:["Last backup: ",(0,He.jsx)("strong",{children:o.toLocaleString()})]}):(0,He.jsx)("p",{children:"No backups yet"}),!p&&(0,He.jsxs)("div",{className:"sign-in-prompt",children:[(0,He.jsx)("p",{children:"Sign in to Google to enable cloud backups"}),(0,He.jsx)("button",{className:"sign-in-btn",onClick:m,children:"Sign in with Google"})]})]}),(0,He.jsx)("div",{className:"backup-actions",children:(0,He.jsx)("button",{className:"primary-btn",onClick:()=>s(),disabled:!p||i,children:i?"Backing up...":"Backup Now"})})]}),"backups"===y&&(0,He.jsx)("div",{className:"backups-tab",children:p?f?(0,He.jsx)("div",{className:"loading",children:"Loading backups..."}):0===h.length?(0,He.jsxs)("div",{className:"no-backups",children:[(0,He.jsx)("p",{children:"No backups found in Google Drive"}),(0,He.jsx)("button",{className:"primary-btn",onClick:()=>s(),disabled:i,children:"Create First Backup"})]}):(0,He.jsxs)(He.Fragment,{children:[(0,He.jsxs)("div",{className:"backups-header",children:[(0,He.jsxs)("span",{children:[h.length," backup(s) found"]}),(0,He.jsx)("button",{className:"refresh-btn",onClick:x,disabled:f,children:"\u21bb Refresh"})]}),(0,He.jsx)("div",{className:"backups-list",children:h.map(e=>{return(0,He.jsxs)("div",{className:"backup-item",children:[(0,He.jsxs)("div",{className:"backup-info",children:[(0,He.jsx)("div",{className:"backup-name",children:e.name}),(0,He.jsxs)("div",{className:"backup-meta",children:[(a=e.createdTime,new Date(a).toLocaleString())," \u2022 ",(t=e.size,t?t<1024?"".concat(t," B"):t<1048576?"".concat((t/1024).toFixed(1)," KB"):"".concat((t/1048576).toFixed(1)," MB"):"Unknown")]})]}),(0,He.jsxs)("div",{className:"backup-actions",children:[(0,He.jsx)("button",{className:"restore-btn",onClick:()=>(async(e,t)=>{await d(e,t)&&n()})(e.id,e.name),title:"Restore this backup",children:"Restore"}),(0,He.jsx)("button",{className:"delete-btn",onClick:()=>(async(e,t)=>{window.confirm('Delete backup "'.concat(t,'"?'))&&(await u(e),x())})(e.id,e.name),title:"Delete this backup",children:"\xd7"})]})]},e.id);var t,a})})]}):(0,He.jsxs)("div",{className:"sign-in-prompt centered",children:[(0,He.jsx)("p",{children:"Sign in to Google to view your backups"}),(0,He.jsx)("button",{className:"sign-in-btn",onClick:m,children:"Sign in with Google"})]})})]})]})}):null};const Aa=function(){var e;const{theme:t,toggleTheme:n}=et(),{isSignedIn:a,gisLoaded:r,hasCredentials:o,user:i,signIn:s,signOut:c}=lt(),{createLocalBackup:d,exportToGoogleDrive:u,isBackingUp:p,lastBackup:m,settings:h}=Mt(),{openSettings:g,hasClaudeKey:f,hasOpenaiKey:v}=Jt(),{trashedItems:y,openTrash:b}=Fn(),[x,k]=(0,l.useState)(!1),[j,w]=(0,l.useState)(!1),[S,N]=(0,l.useState)(!1),[C,E]=(0,l.useState)(!1),[I,D]=(0,l.useState)(!1),[T,A]=(0,l.useState)(!1);(0,l.useEffect)(()=>{const e=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),k(!0)),"Escape"===e.key&&(k(!1),w(!1),N(!1),E(!1),D(!1),A(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);const[P,O]=(0,l.useState)(!1);return(0,He.jsxs)(He.Fragment,{children:[(0,He.jsxs)("nav",{className:"global-navbar",children:[(0,He.jsxs)("div",{className:"navbar-left",children:[(0,He.jsxs)("button",{className:"nav-btn search-btn",onClick:()=>k(!0),title:"Search (\u2318K)",children:["\ud83d\udd0d ",(0,He.jsx)("span",{className:"btn-label",children:"Search"}),(0,He.jsx)("span",{className:"shortcut",children:"\u2318K"})]}),(0,He.jsxs)("button",{className:"nav-btn notebook-btn",onClick:()=>D(!0),title:"Lab Notebook",children:["\ud83d\udcd3 ",(0,He.jsx)("span",{className:"btn-label",children:"Lab Notebook"})]})]}),(0,He.jsxs)("div",{className:"navbar-right",children:[(0,He.jsxs)("button",{className:"nav-btn",onClick:()=>N(!0),title:"Quick Add Task",children:["\u2795 ",(0,He.jsx)("span",{className:"btn-label",children:"Add Task"})]}),(0,He.jsxs)("button",{className:"nav-btn",onClick:()=>w(!0),title:"Calendar View",children:["\ud83d\udcc5 ",(0,He.jsx)("span",{className:"btn-label",children:"Calendar"})]}),(0,He.jsxs)("button",{className:"nav-btn",onClick:()=>E(!0),title:"Activity Timeline",children:["\ud83d\udcdc ",(0,He.jsx)("span",{className:"btn-label",children:"Activity"})]}),(0,He.jsxs)("div",{className:"export-dropdown",children:[(0,He.jsxs)("button",{className:"nav-btn ".concat(p?"backing-up":""),onClick:()=>O(!P),title:m?"Last backup: ".concat(m.toLocaleString()):"Export / Import data",children:[p?(0,He.jsx)("span",{className:"backup-icon spinning",children:"\u21bb"}):(0,He.jsx)(He.Fragment,{children:"\ud83d\udce5"}),(0,He.jsx)("span",{className:"btn-label",children:"Data"}),h.enabled&&a&&(0,He.jsx)("span",{className:"auto-backup-indicator",title:"Auto-backup enabled",children:"\u25cf"})]}),P&&(0,He.jsxs)("div",{className:"export-menu",children:[(0,He.jsx)("div",{className:"export-menu-section",children:"Google Drive"}),(0,He.jsx)("button",{onClick:()=>{u(),O(!1)},disabled:!a||p,title:a?"":"Sign in to Google first",children:"\u2601\ufe0f Backup to Drive"}),(0,He.jsx)("button",{onClick:()=>{A(!0),O(!1)},disabled:!a,title:a?"":"Sign in to Google first",children:"\ud83d\udcc2 Restore from Drive"}),(0,He.jsx)("div",{className:"export-menu-section",children:"Local"}),(0,He.jsx)("button",{onClick:()=>{(()=>{let e=[];try{const t=localStorage.getItem("research-dashboard-custom-projects");t&&(e=JSON.parse(t))}catch(c){}const t=new Set(e.map(e=>e.id)),n=[...Cn,...e];let a={};try{const e=localStorage.getItem("research-dashboard-tasks");e&&(a=JSON.parse(e))}catch(d){}const r=[["Project","Task","Status","Priority","Due Date","Description"]];n.forEach(e=>{let n;n=t.has(e.id)?e.tasks:a[e.id]||e.tasks,n&&Object.entries(n).forEach(t=>{let[n,a]=t;Array.isArray(a)&&a.forEach(t=>{r.push([e.title,t.title,n,t.priority||"medium",t.dueDate||"",(t.description||"").replace(/"/g,'""')])})})});const o=r.map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n"),i=new Blob([o],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(i),s=document.createElement("a");s.setAttribute("href",l),s.setAttribute("download","research-tasks-".concat((new Date).toISOString().split("T")[0],".csv")),s.click(),URL.revokeObjectURL(l)})(),O(!1)},children:"\ud83d\udcc4 Export Tasks CSV"}),(0,He.jsx)("button",{onClick:()=>{d(),O(!1)},children:"\ud83d\udcbe Download Backup"}),(0,He.jsx)("button",{onClick:()=>{(()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=e=>{const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=t=>{try{const n=JSON.parse(t.target.result);if(!n.appName||"KanLab"!==n.appName&&"Research Dashboard"!==n.appName)return void alert("Invalid backup file. Please select a valid KanLab backup.");if(!n.data||"object"!==typeof n.data)return void alert("Invalid backup file format. Missing data section.");const a=Object.keys(n.data).length,r="This will import ".concat(a," data entries from your backup dated ").concat(new Date(n.exportDate).toLocaleDateString(),".\n\nExisting data will be merged with the backup. Continue?");if(!window.confirm(r))return;let o=0;Object.entries(n.data).forEach(t=>{let[n,a]=t;try{localStorage.setItem(n,JSON.stringify(a)),o++}catch(e){console.error("Failed to import ".concat(n,":"),e)}}),alert("Successfully imported ".concat(o," data entries. The page will now reload to apply changes.")),window.location.reload()}catch(e){console.error("Import error:",e),alert("Failed to import backup file. Please ensure it is a valid JSON file.")}},n.readAsText(t)},e.click()})(),O(!1)},children:"\ud83d\udce4 Import from File"}),(0,He.jsx)("div",{className:"export-menu-divider"}),(0,He.jsx)("button",{onClick:()=>{A(!0),O(!1)},children:"\u2699\ufe0f Backup Settings"})]})]}),(0,He.jsxs)("button",{className:"nav-btn trash-btn ".concat(y.length>0?"has-items":""),onClick:b,title:y.length>0?"Trash (".concat(y.length," items)"):"Trash",children:["\ud83d\uddd1\ufe0f ",(0,He.jsx)("span",{className:"btn-label",children:"Trash"}),y.length>0&&(0,He.jsx)("span",{className:"trash-count-badge",children:y.length})]}),a&&(0,He.jsxs)(He.Fragment,{children:[(0,He.jsxs)("button",{className:"nav-btn cloud-btn ".concat(p?"backing-up":""),onClick:()=>u(!1,!1),disabled:p,title:m?"Save to Cloud (Last: ".concat(m.toLocaleString(),")"):"Save backup to Google Drive",children:[p?(0,He.jsx)("span",{className:"cloud-icon spinning",children:"\u21bb"}):(0,He.jsx)("span",{className:"cloud-icon",children:"\u2601\u2191"}),(0,He.jsx)("span",{className:"btn-label",children:"Save"}),h.enabled&&(0,He.jsx)("span",{className:"auto-backup-indicator",title:"Auto-backup enabled",children:"\u25cf"})]}),(0,He.jsxs)("button",{className:"nav-btn cloud-btn",onClick:()=>A(!0),title:"View and restore from Google Drive backups",children:[(0,He.jsx)("span",{className:"cloud-icon",children:"\u2601\u2193"}),(0,He.jsx)("span",{className:"btn-label",children:"Load"})]})]}),o&&(a?(0,He.jsxs)("button",{className:"nav-btn google-auth-btn signed-in",onClick:c,title:i?"Signed in as ".concat(i.email):"Sign out of Google",children:[null!==i&&void 0!==i&&i.picture?(0,He.jsx)("img",{src:i.picture,alt:"",className:"google-avatar"}):(0,He.jsx)("span",{className:"google-icon",children:"G"}),(0,He.jsx)("span",{className:"btn-label",children:(null===i||void 0===i||null===(e=i.name)||void 0===e?void 0:e.split(" ")[0])||"Google"})]}):(0,He.jsxs)("button",{className:"nav-btn google-auth-btn",onClick:s,disabled:!r,title:"Sign in with Google",children:[(0,He.jsx)("span",{className:"google-icon",children:"G"}),(0,He.jsx)("span",{className:"btn-label",children:r?"Sign In":"..."})]})),(0,He.jsxs)("button",{className:"nav-btn settings-btn ".concat(f||v?"configured":""),onClick:g,title:f&&v?"API Settings (configured)":"Configure API Keys",children:["\u2699\ufe0f ",(0,He.jsx)("span",{className:"btn-label",children:"Settings"}),(!f||!v)&&(0,He.jsx)("span",{className:"settings-dot"})]}),(0,He.jsx)("button",{className:"nav-btn theme-toggle",onClick:n,title:"Switch to ".concat("dark"===t?"light":"dark"," mode"),children:"dark"===t?"\u2600\ufe0f":"\ud83c\udf19"})]})]}),(0,He.jsx)(Bn,{isOpen:x,onClose:()=>k(!1)}),(0,He.jsx)(Qn,{isOpen:j,onClose:()=>w(!1)}),(0,He.jsx)(Xn,{isOpen:S,onClose:()=>N(!1)}),(0,He.jsx)(ta,{isOpen:C,onClose:()=>E(!1)}),(0,He.jsx)(Da,{isOpen:I,onClose:()=>D(!1)}),(0,He.jsx)(Ta,{isOpen:T,onClose:()=>A(!1)})]})},Pa=[{name:"Red",value:"#8B2942"},{name:"Purple",value:"#5B4A8A"},{name:"Blue",value:"#3A5A8A"},{name:"Brown",value:"#8A6A3A"},{name:"Green",value:"#2A6A4A"},{name:"Teal",value:"#2A5A6A"},{name:"Orange",value:"#8A4A2A"},{name:"Pink",value:"#8A3A6A"}];const Oa=function(e){let{isOpen:t,onClose:n,onAddProject:a}=e;const[r,o]=(0,l.useState)({title:"",subtitle:"",description:"",hypothesis:"",color:"#3A5A8A",approaches:""});return t?(0,He.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,He.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"modal-header",children:[(0,He.jsx)("h2",{children:"Create New Project"}),(0,He.jsx)("button",{className:"modal-close",onClick:n,children:"\xd7"})]}),(0,He.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t={id:"custom-"+Date.now(),title:r.title,subtitle:r.subtitle,description:r.description,hypothesis:r.hypothesis,color:r.color,icon:"custom",approaches:r.approaches.split(",").map(e=>e.trim()).filter(e=>e),tasks:{backlog:[],inProgress:[],review:[],done:[]},isCustom:!0};a(t),o({title:"",subtitle:"",description:"",hypothesis:"",color:"#3A5A8A",approaches:""}),n()},className:"project-form",children:[(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Project Title *"}),(0,He.jsx)("input",{type:"text",value:r.title,onChange:e=>o(Je(Je({},r),{},{title:e.target.value})),placeholder:"e.g., CAR-T Cell Optimization",required:!0})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Subtitle"}),(0,He.jsx)("input",{type:"text",value:r.subtitle,onChange:e=>o(Je(Je({},r),{},{subtitle:e.target.value})),placeholder:"e.g., Enhancing Persistence"})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Description"}),(0,He.jsx)(ua,{value:r.description,onChange:e=>o(Je(Je({},r),{},{description:e})),placeholder:"Brief project description... (type @ for commands)",rows:3})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Core Hypothesis"}),(0,He.jsx)(ua,{value:r.hypothesis,onChange:e=>o(Je(Je({},r),{},{hypothesis:e})),placeholder:"What is your main hypothesis? (type @ for commands)",rows:3})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Project Color"}),(0,He.jsx)("div",{className:"color-picker",children:Pa.map(e=>(0,He.jsx)("button",{type:"button",className:"color-option ".concat(r.color===e.value?"selected":""),style:{backgroundColor:e.value},onClick:()=>o(Je(Je({},r),{},{color:e.value})),title:e.name},e.value))})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Research Approaches (comma-separated)"}),(0,He.jsx)("input",{type:"text",value:r.approaches,onChange:e=>o(Je(Je({},r),{},{approaches:e.target.value})),placeholder:"e.g., Flow Cytometry, CRISPR, Mouse Models"})]}),(0,He.jsxs)("div",{className:"form-actions",children:[(0,He.jsx)("button",{type:"button",className:"btn-cancel",onClick:n,children:"Cancel"}),(0,He.jsx)("button",{type:"submit",className:"btn-submit",children:"Create Project"})]})]})]})}):null},La=()=>(0,He.jsxs)("svg",{viewBox:"0 0 48 48",className:"kanlab-logo",width:"48",height:"48",children:[(0,He.jsx)("defs",{children:(0,He.jsxs)("linearGradient",{id:"kanlab-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,He.jsx)("stop",{offset:"0%",stopColor:"#6366f1"}),(0,He.jsx)("stop",{offset:"50%",stopColor:"#8b5cf6"}),(0,He.jsx)("stop",{offset:"100%",stopColor:"#a855f7"})]})}),(0,He.jsx)("rect",{x:"4",y:"8",width:"10",height:"32",rx:"2",fill:"url(#kanlab-gradient)",opacity:"0.9"}),(0,He.jsx)("rect",{x:"19",y:"8",width:"10",height:"24",rx:"2",fill:"url(#kanlab-gradient)",opacity:"0.7"}),(0,He.jsx)("rect",{x:"34",y:"8",width:"10",height:"16",rx:"2",fill:"url(#kanlab-gradient)",opacity:"0.5"}),(0,He.jsx)("rect",{x:"6",y:"12",width:"6",height:"4",rx:"1",fill:"white",opacity:"0.9"}),(0,He.jsx)("rect",{x:"6",y:"20",width:"6",height:"4",rx:"1",fill:"white",opacity:"0.7"}),(0,He.jsx)("rect",{x:"6",y:"28",width:"6",height:"4",rx:"1",fill:"white",opacity:"0.5"}),(0,He.jsx)("rect",{x:"21",y:"12",width:"6",height:"4",rx:"1",fill:"white",opacity:"0.8"}),(0,He.jsx)("rect",{x:"21",y:"20",width:"6",height:"4",rx:"1",fill:"white",opacity:"0.6"}),(0,He.jsx)("rect",{x:"36",y:"12",width:"6",height:"4",rx:"1",fill:"white",opacity:"0.7"})]}),Ra={cart:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("circle",{cx:"32",cy:"32",r:"22",fill:"currentColor",opacity:"0.9"}),(0,He.jsx)("circle",{cx:"32",cy:"32",r:"16",fill:"currentColor"}),(0,He.jsx)("path",{d:"M32 10 L32 18 M28 12 L32 18 L36 12",stroke:"#4CAF50",strokeWidth:"3",strokeLinecap:"round"}),(0,He.jsx)("rect",{x:"28",y:"6",width:"8",height:"6",rx:"2",fill:"#81C784"}),(0,He.jsx)("circle",{cx:"18",cy:"28",r:"3",fill:"#A5D6A7"}),(0,He.jsx)("circle",{cx:"46",cy:"28",r:"3",fill:"#A5D6A7"}),(0,He.jsx)("circle",{cx:"20",cy:"42",r:"3",fill:"#A5D6A7"}),(0,He.jsx)("circle",{cx:"44",cy:"42",r:"3",fill:"#A5D6A7"}),(0,He.jsx)("ellipse",{cx:"32",cy:"36",rx:"8",ry:"6",fill:"#1B5E20",opacity:"0.5"})]}),crispr:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("path",{d:"M20 8 Q32 20 20 32 Q8 44 20 56",stroke:"currentColor",strokeWidth:"4",fill:"none",opacity:"0.8"}),(0,He.jsx)("path",{d:"M44 8 Q32 20 44 32 Q56 44 44 56",stroke:"currentColor",strokeWidth:"4",fill:"none",opacity:"0.8"}),(0,He.jsx)("line",{x1:"22",y1:"14",x2:"42",y2:"14",stroke:"#64B5F6",strokeWidth:"2"}),(0,He.jsx)("line",{x1:"18",y1:"26",x2:"46",y2:"26",stroke:"#64B5F6",strokeWidth:"2"}),(0,He.jsx)("line",{x1:"18",y1:"38",x2:"46",y2:"38",stroke:"#64B5F6",strokeWidth:"2"}),(0,He.jsx)("line",{x1:"22",y1:"50",x2:"42",y2:"50",stroke:"#64B5F6",strokeWidth:"2"}),(0,He.jsx)("circle",{cx:"46",cy:"32",r:"8",fill:"#1565C0"}),(0,He.jsx)("path",{d:"M42 28 L50 36 M50 28 L42 36",stroke:"white",strokeWidth:"2",strokeLinecap:"round"})]}),tme:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("circle",{cx:"32",cy:"32",r:"10",fill:"currentColor"}),(0,He.jsx)("circle",{cx:"24",cy:"24",r:"6",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("circle",{cx:"40",cy:"24",r:"7",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("circle",{cx:"26",cy:"42",r:"5",fill:"currentColor",opacity:"0.7"}),(0,He.jsx)("circle",{cx:"40",cy:"40",r:"6",fill:"currentColor",opacity:"0.7"}),(0,He.jsx)("circle",{cx:"14",cy:"30",r:"4",fill:"#CE93D8"}),(0,He.jsx)("circle",{cx:"50",cy:"30",r:"4",fill:"#CE93D8"}),(0,He.jsx)("circle",{cx:"18",cy:"46",r:"3",fill:"#CE93D8"}),(0,He.jsx)("circle",{cx:"48",cy:"18",r:"3",fill:"#CE93D8"}),(0,He.jsx)("circle",{cx:"32",cy:"52",r:"3",fill:"#CE93D8"}),(0,He.jsx)("path",{d:"M8 16 Q16 20 12 28",stroke:"#E1BEE7",strokeWidth:"1",fill:"none",opacity:"0.5"}),(0,He.jsx)("path",{d:"M52 48 Q56 44 54 36",stroke:"#E1BEE7",strokeWidth:"1",fill:"none",opacity:"0.5"})]}),scrna:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("circle",{cx:"28",cy:"32",r:"20",fill:"currentColor",opacity:"0.9"}),(0,He.jsx)("circle",{cx:"28",cy:"34",r:"10",fill:"#BF360C",opacity:"0.6"}),(0,He.jsx)("path",{d:"M22 26 Q26 24 30 26",stroke:"#FFCC80",strokeWidth:"2",fill:"none"}),(0,He.jsx)("path",{d:"M20 32 Q24 30 28 32",stroke:"#FFCC80",strokeWidth:"2",fill:"none"}),(0,He.jsx)("path",{d:"M24 40 Q28 38 32 40",stroke:"#FFCC80",strokeWidth:"2",fill:"none"}),(0,He.jsx)("rect",{x:"50",y:"16",width:"3",height:"12",fill:"#FF8A65"}),(0,He.jsx)("rect",{x:"54",y:"20",width:"3",height:"8",fill:"#FF8A65"}),(0,He.jsx)("rect",{x:"50",y:"32",width:"3",height:"16",fill:"#FFAB91"}),(0,He.jsx)("rect",{x:"54",y:"36",width:"3",height:"12",fill:"#FFAB91"}),(0,He.jsx)("path",{d:"M44 32 L48 32",stroke:"#FFE0B2",strokeWidth:"2",markerEnd:"url(#arrow)"})]}),custom:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("rect",{x:"12",y:"12",width:"40",height:"40",rx:"8",fill:"currentColor"}),(0,He.jsx)("circle",{cx:"32",cy:"28",r:"8",fill:"white",opacity:"0.3"}),(0,He.jsx)("rect",{x:"24",y:"40",width:"16",height:"4",rx:"2",fill:"white",opacity:"0.3"})]}),dna:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("path",{d:"M20 4 Q38 16 20 32 Q2 48 20 60",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,He.jsx)("path",{d:"M44 4 Q26 16 44 32 Q62 48 44 60",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,He.jsx)("line",{x1:"20",y1:"10",x2:"44",y2:"10",stroke:"currentColor",strokeWidth:"2",opacity:"0.6"}),(0,He.jsx)("line",{x1:"14",y1:"22",x2:"50",y2:"22",stroke:"currentColor",strokeWidth:"2",opacity:"0.6"}),(0,He.jsx)("line",{x1:"14",y1:"42",x2:"50",y2:"42",stroke:"currentColor",strokeWidth:"2",opacity:"0.6"}),(0,He.jsx)("line",{x1:"20",y1:"54",x2:"44",y2:"54",stroke:"currentColor",strokeWidth:"2",opacity:"0.6"})]}),cell:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("ellipse",{cx:"32",cy:"32",rx:"26",ry:"22",fill:"currentColor",opacity:"0.3"}),(0,He.jsx)("ellipse",{cx:"32",cy:"32",rx:"24",ry:"20",stroke:"currentColor",strokeWidth:"3",fill:"none"}),(0,He.jsx)("ellipse",{cx:"32",cy:"34",rx:"10",ry:"8",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("circle",{cx:"20",cy:"26",r:"3",fill:"currentColor",opacity:"0.5"}),(0,He.jsx)("circle",{cx:"44",cy:"28",r:"2",fill:"currentColor",opacity:"0.5"}),(0,He.jsx)("circle",{cx:"22",cy:"40",r:"2",fill:"currentColor",opacity:"0.5"})]}),microscope:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("rect",{x:"28",y:"4",width:"8",height:"24",rx:"2",fill:"currentColor"}),(0,He.jsx)("ellipse",{cx:"32",cy:"32",rx:"6",ry:"4",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("line",{x1:"32",y1:"36",x2:"32",y2:"52",stroke:"currentColor",strokeWidth:"4"}),(0,He.jsx)("ellipse",{cx:"32",cy:"56",rx:"16",ry:"4",fill:"currentColor",opacity:"0.6"}),(0,He.jsx)("rect",{x:"16",y:"18",width:"8",height:"6",rx:"1",fill:"currentColor",opacity:"0.7"}),(0,He.jsx)("line",{x1:"16",y1:"21",x2:"8",y2:"26",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]}),flask:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("path",{d:"M24 4 L24 24 L8 52 Q6 56 10 58 L54 58 Q58 56 56 52 L40 24 L40 4",stroke:"currentColor",strokeWidth:"3",fill:"none"}),(0,He.jsx)("line",{x1:"20",y1:"4",x2:"44",y2:"4",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"}),(0,He.jsx)("path",{d:"M12 48 Q32 40 52 48 L54 54 Q32 46 10 54 Z",fill:"currentColor",opacity:"0.4"}),(0,He.jsx)("circle",{cx:"20",cy:"50",r:"2",fill:"currentColor"}),(0,He.jsx)("circle",{cx:"32",cy:"46",r:"3",fill:"currentColor"}),(0,He.jsx)("circle",{cx:"44",cy:"52",r:"2",fill:"currentColor"})]}),antibody:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("path",{d:"M32 56 L32 36",stroke:"currentColor",strokeWidth:"4"}),(0,He.jsx)("path",{d:"M32 36 L20 24 L12 16",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"}),(0,He.jsx)("path",{d:"M32 36 L44 24 L52 16",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"}),(0,He.jsx)("circle",{cx:"12",cy:"12",r:"6",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("circle",{cx:"52",cy:"12",r:"6",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("rect",{x:"28",y:"54",width:"8",height:"6",rx:"2",fill:"currentColor",opacity:"0.6"})]}),virus:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("circle",{cx:"32",cy:"32",r:"16",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("circle",{cx:"32",cy:"32",r:"12",fill:"currentColor"}),[0,45,90,135,180,225,270,315].map((e,t)=>{const n=e*Math.PI/180,a=32+16*Math.cos(n),r=32+16*Math.sin(n),o=32+26*Math.cos(n),i=32+26*Math.sin(n);return(0,He.jsx)("line",{x1:a,y1:r,x2:o,y2:i,stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"},t)}),[0,45,90,135,180,225,270,315].map((e,t)=>{const n=e*Math.PI/180,a=32+26*Math.cos(n),r=32+26*Math.sin(n);return(0,He.jsx)("circle",{cx:a,cy:r,r:"4",fill:"currentColor"},t)})]}),brain:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("ellipse",{cx:"24",cy:"28",rx:"14",ry:"16",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("ellipse",{cx:"40",cy:"28",rx:"14",ry:"16",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("path",{d:"M18 20 Q24 16 32 20 Q40 16 46 20",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.6"}),(0,He.jsx)("path",{d:"M16 32 Q24 28 32 32 Q40 28 48 32",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.6"}),(0,He.jsx)("ellipse",{cx:"32",cy:"48",rx:"8",ry:"6",fill:"currentColor"}),(0,He.jsx)("line",{x1:"32",y1:"54",x2:"32",y2:"60",stroke:"currentColor",strokeWidth:"4"})]}),heart:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("path",{d:"M32 56 L12 36 Q4 28 4 20 Q4 8 16 8 Q24 8 32 18 Q40 8 48 8 Q60 8 60 20 Q60 28 52 36 Z",fill:"currentColor"}),(0,He.jsx)("path",{d:"M20 24 Q28 24 32 32",stroke:"white",strokeWidth:"2",fill:"none",opacity:"0.4"})]}),molecule:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("circle",{cx:"32",cy:"20",r:"8",fill:"currentColor"}),(0,He.jsx)("circle",{cx:"16",cy:"44",r:"8",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("circle",{cx:"48",cy:"44",r:"8",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("line",{x1:"32",y1:"28",x2:"20",y2:"38",stroke:"currentColor",strokeWidth:"3"}),(0,He.jsx)("line",{x1:"32",y1:"28",x2:"44",y2:"38",stroke:"currentColor",strokeWidth:"3"}),(0,He.jsx)("line",{x1:"24",y1:"44",x2:"40",y2:"44",stroke:"currentColor",strokeWidth:"3"})]}),petri:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("ellipse",{cx:"32",cy:"36",rx:"26",ry:"12",fill:"currentColor",opacity:"0.3"}),(0,He.jsx)("ellipse",{cx:"32",cy:"32",rx:"26",ry:"12",stroke:"currentColor",strokeWidth:"3",fill:"none"}),(0,He.jsx)("ellipse",{cx:"32",cy:"28",rx:"26",ry:"12",stroke:"currentColor",strokeWidth:"3",fill:"none"}),(0,He.jsx)("circle",{cx:"24",cy:"30",r:"4",fill:"currentColor",opacity:"0.6"}),(0,He.jsx)("circle",{cx:"38",cy:"28",r:"3",fill:"currentColor",opacity:"0.6"}),(0,He.jsx)("circle",{cx:"28",cy:"34",r:"2",fill:"currentColor",opacity:"0.6"}),(0,He.jsx)("circle",{cx:"42",cy:"32",r:"3",fill:"currentColor",opacity:"0.6"})]}),testtube:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("path",{d:"M24 8 L24 44 Q24 56 32 56 Q40 56 40 44 L40 8",stroke:"currentColor",strokeWidth:"3",fill:"none"}),(0,He.jsx)("line",{x1:"20",y1:"8",x2:"44",y2:"8",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"}),(0,He.jsx)("path",{d:"M24 36 Q32 32 40 36 L40 44 Q40 52 32 52 Q24 52 24 44 Z",fill:"currentColor",opacity:"0.4"}),(0,He.jsx)("circle",{cx:"30",cy:"44",r:"2",fill:"currentColor"}),(0,He.jsx)("circle",{cx:"36",cy:"40",r:"2",fill:"currentColor"})]}),syringe:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("rect",{x:"18",y:"28",width:"28",height:"12",rx:"2",fill:"currentColor"}),(0,He.jsx)("rect",{x:"46",y:"30",width:"12",height:"8",rx:"1",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("line",{x1:"58",y1:"34",x2:"62",y2:"34",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"}),(0,He.jsx)("rect",{x:"6",y:"32",width:"12",height:"4",fill:"currentColor",opacity:"0.6"}),(0,He.jsx)("line",{x1:"4",y1:"34",x2:"6",y2:"34",stroke:"currentColor",strokeWidth:"2"}),(0,He.jsx)("line",{x1:"26",y1:"30",x2:"26",y2:"38",stroke:"currentColor",strokeWidth:"1",opacity:"0.4"}),(0,He.jsx)("line",{x1:"34",y1:"30",x2:"34",y2:"38",stroke:"currentColor",strokeWidth:"1",opacity:"0.4"}),(0,He.jsx)("rect",{x:"10",y:"26",width:"4",height:"16",fill:"currentColor",opacity:"0.7"})]}),chromosome:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("path",{d:"M20 8 Q12 8 12 16 L12 28 Q12 32 16 32 Q12 32 12 36 L12 48 Q12 56 20 56",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),(0,He.jsx)("path",{d:"M44 8 Q52 8 52 16 L52 28 Q52 32 48 32 Q52 32 52 36 L52 48 Q52 56 44 56",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),(0,He.jsx)("ellipse",{cx:"32",cy:"32",rx:"6",ry:"4",fill:"currentColor",opacity:"0.6"})]}),protein:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("path",{d:"M8 32 Q16 16 28 24 Q40 32 32 44 Q24 56 40 48 Q56 40 56 32",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),(0,He.jsx)("circle",{cx:"8",cy:"32",r:"4",fill:"currentColor"}),(0,He.jsx)("circle",{cx:"28",cy:"24",r:"4",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("circle",{cx:"32",cy:"44",r:"4",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("circle",{cx:"56",cy:"32",r:"4",fill:"currentColor"})]}),leaf:(0,He.jsxs)("svg",{viewBox:"0 0 64 64",className:"project-card-icon",children:[(0,He.jsx)("path",{d:"M32 58 Q32 40 24 32 Q8 16 32 8 Q56 16 40 32 Q32 40 32 58",fill:"currentColor",opacity:"0.8"}),(0,He.jsx)("path",{d:"M32 58 L32 20",stroke:"currentColor",strokeWidth:"2"}),(0,He.jsx)("path",{d:"M32 28 Q24 32 20 28",stroke:"currentColor",strokeWidth:"2",fill:"none"}),(0,He.jsx)("path",{d:"M32 36 Q40 40 44 36",stroke:"currentColor",strokeWidth:"2",fill:"none"}),(0,He.jsx)("path",{d:"M32 44 Q26 48 22 44",stroke:"currentColor",strokeWidth:"2",fill:"none"})]})},Ma=[{id:"custom",name:"Custom"},{id:"cart",name:"CAR-T Cell"},{id:"crispr",name:"CRISPR"},{id:"tme",name:"Tumor Microenvironment"},{id:"scrna",name:"Single-cell RNA"},{id:"dna",name:"DNA Helix"},{id:"cell",name:"Cell"},{id:"microscope",name:"Microscope"},{id:"flask",name:"Flask"},{id:"antibody",name:"Antibody"},{id:"virus",name:"Virus"},{id:"brain",name:"Brain"},{id:"heart",name:"Heart"},{id:"molecule",name:"Molecule"},{id:"petri",name:"Petri Dish"},{id:"testtube",name:"Test Tube"},{id:"syringe",name:"Syringe"},{id:"chromosome",name:"Chromosome"},{id:"protein",name:"Protein"},{id:"leaf",name:"Leaf"}],Fa=e=>{var t,n;const a=Object.values(e).flat().length,r=(null===(t=e.done)||void 0===t?void 0:t.length)||0;return{total:a,done:r,inProgress:(null===(n=e.inProgress)||void 0===n?void 0:n.length)||0,percentage:a>0?Math.round(r/a*100):0}},Ua="research-dashboard-custom-projects",_a="research-dashboard-project-order";const za=function(){const{isProjectArchived:e,archiveProject:t,unarchiveProject:n,archivedProjects:a,logActivity:r}=et(),o=St(),{moveToTrash:i}=Fn(),{showSuccess:s}=vt(),[c,d]=(0,l.useState)([]),[u,p]=(0,l.useState)({}),[m,h]=(0,l.useState)(!1),[g,f]=(0,l.useState)(!1),[v,y]=(0,l.useState)([]),[b,x]=(0,l.useState)({}),[k,j]=(0,l.useState)(null),[w,S]=(0,l.useState)(null);(0,l.useEffect)(()=>{const e=localStorage.getItem(Ua);if(e)try{d(JSON.parse(e))}catch(Fr){console.error("Failed to load custom projects:",Fr)}const t=localStorage.getItem("research-dashboard-tasks");if(t)try{p(JSON.parse(t))}catch(Fr){console.error("Failed to load saved tasks:",Fr)}const n=localStorage.getItem(_a);if(n)try{y(JSON.parse(n))}catch(Fr){console.error("Failed to load project order:",Fr)}const a=localStorage.getItem("research-dashboard-project-overrides");if(a)try{x(JSON.parse(a))}catch(Fr){console.error("Failed to load project overrides:",Fr)}},[]);const N=(0,l.useCallback)(e=>{localStorage.setItem(Ua,JSON.stringify(e)),d(e),o()},[o]),C=(0,l.useCallback)(e=>{localStorage.setItem(_a,JSON.stringify(e)),y(e),o()},[o]),E=e=>{e.target.classList.remove("dragging"),j(null),S(null)},I=e=>{e.currentTarget.contains(e.relatedTarget)||S(null)},D=e=>e.isCustom?e.tasks:u[e.id]||e.tasks,T=[...Cn.map(e=>b[e.id]?Je(Je({},e),b[e.id]):e),...c],A=[...T.filter(t=>!e(t.id))].sort((e,t)=>{const n=v.indexOf(e.id),a=v.indexOf(t.id);return-1===n&&-1===a?0:-1===n?1:-1===a?-1:n-a}),P=T.filter(t=>e(t.id));return(0,He.jsxs)("div",{className:"landing-page",children:[(0,He.jsx)("header",{className:"landing-header",children:(0,He.jsx)("div",{className:"header-content",children:(0,He.jsxs)("div",{className:"kanlab-brand",children:[(0,He.jsx)(La,{}),(0,He.jsxs)("div",{className:"kanlab-title-group",children:[(0,He.jsx)("h1",{children:"KanLab"}),(0,He.jsx)("p",{className:"subtitle",children:"Research Project Management"})]})]})})}),(0,He.jsxs)("main",{className:"landing-main",children:[(0,He.jsxs)("section",{className:"projects-overview",children:[(0,He.jsxs)("div",{className:"section-header",children:[(0,He.jsxs)("div",{children:[(0,He.jsx)("h2",{children:"Active Projects"}),(0,He.jsx)("p",{className:"section-description",children:"Click on a project to view detailed Kanban board and manage tasks"})]}),(0,He.jsxs)("div",{className:"header-actions",children:[a.length>0&&(0,He.jsxs)("button",{className:"show-archived-btn",onClick:()=>f(!g),children:["\ud83d\udce6 ",g?"Hide":"Show"," Archived (",a.length,")"]}),(0,He.jsx)("button",{className:"add-project-btn",onClick:()=>h(!0),children:"+ New Project"})]})]}),(0,He.jsx)("div",{className:"project-grid",children:A.map(e=>{const n=D(e),a=Fa(n),r=k===e.id,o=w===e.id;return(0,He.jsxs)(Le,{to:"/project/".concat(e.id),className:"project-card ".concat(r?"dragging":""," ").concat(o?"drag-over":""),style:{"--project-color":e.color},draggable:!0,onDragStart:t=>((e,t)=>{j(t),e.dataTransfer.effectAllowed="move",setTimeout(()=>{e.target.classList.add("dragging")},0)})(t,e.id),onDragEnd:E,onDragOver:t=>((e,t)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",t!==k&&S(t)})(t,e.id),onDragLeave:I,onDrop:t=>((e,t)=>{if(e.preventDefault(),!k||k===t)return;const n=A.map(e=>e.id);let a=v.length>0?v.filter(e=>n.includes(e)):n;n.forEach(e=>{a.includes(e)||a.push(e)});const r=a.indexOf(k),o=a.indexOf(t);if(-1===r||-1===o)return;const i=[...a];i.splice(r,1),i.splice(o,0,k),C(i),j(null),S(null)})(t,e.id),children:[(0,He.jsxs)("div",{className:"project-card-actions",children:[(0,He.jsx)("button",{className:"archive-project-btn",onClick:n=>((e,n)=>{e.preventDefault(),e.stopPropagation(),t(n)})(n,e.id),title:"Archive project",children:"\ud83d\udce6"}),e.isCustom&&(0,He.jsx)("button",{className:"delete-project-btn",onClick:t=>((e,t)=>{e.preventDefault(),e.stopPropagation();const n=c.find(e=>e.id===t);if(!n)return;i(Rn.PROJECT,n,{projectId:n.id,projectTitle:n.title});const a=c.filter(e=>e.id!==t);N(a),s('"'.concat(n.title,'" moved to trash'))})(t,e.id),title:"Delete project",children:"\xd7"})]}),(0,He.jsxs)("div",{className:"project-card-header",children:[(0,He.jsx)("div",{className:"project-icon",style:{color:e.color},children:Ra[e.icon]||Ra.custom}),(0,He.jsxs)("div",{className:"project-status-badge",children:[a.percentage,"% Complete"]})]}),(0,He.jsxs)("div",{className:"project-card-body",children:[(0,He.jsx)("h3",{className:"project-title",children:e.title}),(0,He.jsx)("p",{className:"project-subtitle",children:e.subtitle}),(0,He.jsx)("p",{className:"project-description",children:e.description})]}),(0,He.jsxs)("div",{className:"project-card-footer",children:[(0,He.jsx)("div",{className:"progress-bar",children:(0,He.jsx)("div",{className:"progress-fill",style:{width:"".concat(a.percentage,"%"),backgroundColor:e.color}})}),(0,He.jsxs)("div",{className:"task-stats",children:[(0,He.jsxs)("span",{className:"stat",children:[(0,He.jsx)("span",{className:"stat-number",children:a.done})," done"]}),(0,He.jsxs)("span",{className:"stat",children:[(0,He.jsx)("span",{className:"stat-number",children:a.inProgress})," in progress"]}),(0,He.jsxs)("span",{className:"stat",children:[(0,He.jsx)("span",{className:"stat-number",children:a.total})," total"]})]}),(0,He.jsx)("div",{className:"approaches",children:e.approaches.slice(0,3).map((e,t)=>(0,He.jsx)("span",{className:"approach-tag",children:e},t))})]}),(0,He.jsx)("div",{className:"card-hover-indicator",children:"View Kanban Board \u2192"})]},e.id)})}),g&&P.length>0&&(0,He.jsxs)("div",{className:"archived-section",children:[(0,He.jsx)("h3",{children:"\ud83d\udce6 Archived Projects"}),(0,He.jsx)("div",{className:"project-grid archived-grid",children:P.map(e=>{const t=D(e),a=Fa(t);return(0,He.jsxs)("div",{className:"project-card archived",style:{"--project-color":e.color},children:[(0,He.jsx)("div",{className:"project-card-actions",children:(0,He.jsx)("button",{className:"unarchive-project-btn",onClick:t=>((e,t)=>{e.preventDefault(),e.stopPropagation(),n(t)})(t,e.id),title:"Restore project",children:"\ud83d\udcc2 Restore"})}),(0,He.jsxs)("div",{className:"project-card-header",children:[(0,He.jsx)("div",{className:"project-icon",style:{color:e.color,opacity:.5},children:Ra[e.icon]||Ra.custom}),(0,He.jsxs)("div",{className:"project-status-badge",children:[a.percentage,"% Complete"]})]}),(0,He.jsxs)("div",{className:"project-card-body",children:[(0,He.jsx)("h3",{className:"project-title",children:e.title}),(0,He.jsx)("p",{className:"project-subtitle",children:e.subtitle})]})]},e.id)})})]})]}),(0,He.jsxs)("section",{className:"quick-stats",children:[(0,He.jsx)("h2",{children:"Overview"}),(0,He.jsxs)("div",{className:"stats-grid",children:[(0,He.jsxs)("div",{className:"stat-card",children:[(0,He.jsx)("span",{className:"stat-value",children:A.length}),(0,He.jsx)("span",{className:"stat-label",children:"Active Projects"})]}),(0,He.jsxs)("div",{className:"stat-card",children:[(0,He.jsx)("span",{className:"stat-value",children:A.reduce((e,t)=>e+Object.values(D(t)).flat().length,0)}),(0,He.jsx)("span",{className:"stat-label",children:"Total Tasks"})]}),(0,He.jsxs)("div",{className:"stat-card",children:[(0,He.jsx)("span",{className:"stat-value",children:A.reduce((e,t)=>{var n;return e+((null===(n=D(t).inProgress)||void 0===n?void 0:n.length)||0)},0)}),(0,He.jsx)("span",{className:"stat-label",children:"In Progress"})]}),(0,He.jsxs)("div",{className:"stat-card",children:[(0,He.jsx)("span",{className:"stat-value",children:A.reduce((e,t)=>{var n;return e+((null===(n=D(t).done)||void 0===n?void 0:n.length)||0)},0)}),(0,He.jsx)("span",{className:"stat-label",children:"Completed"})]})]})]})]}),(0,He.jsxs)("footer",{className:"landing-footer",children:[(0,He.jsx)("p",{children:"KanLab - Research Project Management"}),(0,He.jsx)("span",{className:"version-tag",children:"v0.1"}),(0,He.jsx)("p",{className:"copyright",children:"Created by Eric Perkey. All rights reserved."})]}),(0,He.jsx)(Oa,{isOpen:m,onClose:()=>h(!1),onAddProject:e=>{const t=[...c,e];N(t),r("project_created",{projectId:e.id,projectTitle:e.title})}})]})};const Ba=function(e){let{currentTaskId:t,allTasks:n,selectedDependencies:a=[],onUpdate:r}=e;const[o,i]=(0,l.useState)(!1),[s,c]=(0,l.useState)(""),d=Object.entries(n||{}).flatMap(e=>{let[n,a]=e;return(a||[]).filter(e=>e.id!==t).map(e=>Je(Je({},e),{},{columnId:n}))}),u=d.filter(e=>e.title.toLowerCase().includes(s.toLowerCase())),p=e=>{const t=a.includes(e)?a.filter(t=>t!==e):[...a,e];r(t)},m=e=>d.find(t=>t.id===e);return(0,He.jsxs)("div",{className:"task-dependency-selector",children:[(0,He.jsxs)("div",{className:"section-header-row",children:[(0,He.jsx)("label",{children:"Blocked By (Dependencies)"}),(0,He.jsx)("button",{className:"add-btn-small",onClick:()=>i(!o),children:o?"Done":"+ Add"})]}),a.length>0&&(0,He.jsx)("div",{className:"selected-dependencies",children:a.map(e=>{const t=m(e);return t?(0,He.jsxs)("div",{className:"dependency-chip ".concat("done"===t.columnId?"resolved":"blocking"),children:[(0,He.jsx)("span",{className:"dep-status-icon",children:"done"===t.columnId?"\u2713":"\u23f3"}),(0,He.jsx)("span",{className:"dep-title",children:t.title}),(0,He.jsx)("button",{className:"remove-dep-btn",onClick:()=>p(e),children:"\xd7"})]},e):null})}),o&&(0,He.jsxs)("div",{className:"dependency-picker",children:[(0,He.jsx)("input",{type:"text",className:"dependency-search",placeholder:"Search tasks...",value:s,onChange:e=>c(e.target.value)}),(0,He.jsx)("div",{className:"dependency-list",children:0===u.length?(0,He.jsx)("div",{className:"no-tasks-msg",children:"No tasks available"}):u.map(e=>{return(0,He.jsxs)("div",{className:"dependency-option ".concat(a.includes(e.id)?"selected":""),onClick:()=>p(e.id),children:[(0,He.jsx)("span",{className:"dep-checkbox",children:a.includes(e.id)?"\u2611":"\u2610"}),(0,He.jsx)("span",{className:"dep-task-title",children:e.title}),(0,He.jsx)("span",{className:"dep-column-badge ".concat(e.columnId),children:(t=e.columnId,{backlog:"Backlog",inProgress:"In Progress",review:"Review",done:"Done"}[t]||t)})]},e.id);var t})})]}),a.length>0&&(0,He.jsx)("div",{className:"dependency-status",children:a.every(e=>{var t;return"done"===(null===(t=m(e))||void 0===t?void 0:t.columnId)})?(0,He.jsx)("span",{className:"status-resolved",children:"All dependencies resolved"}):(0,He.jsxs)("span",{className:"status-blocking",children:[a.filter(e=>{var t;return"done"!==(null===(t=m(e))||void 0===t?void 0:t.columnId)}).length," blocking task(s)"]})})]})},Ga=(e,t)=>t||(null!==e&&void 0!==e&&e.includes("pdf")?"\ud83d\udcc4":null!==e&&void 0!==e&&e.includes("image")?"\ud83d\uddbc\ufe0f":null!==e&&void 0!==e&&e.includes("video")?"\ud83c\udfac":null!==e&&void 0!==e&&e.includes("audio")?"\ud83c\udfb5":null!==e&&void 0!==e&&e.includes("spreadsheet")||null!==e&&void 0!==e&&e.includes("excel")?"\ud83d\udcca":null!==e&&void 0!==e&&e.includes("document")||null!==e&&void 0!==e&&e.includes("word")?"\ud83d\udcdd":null!==e&&void 0!==e&&e.includes("presentation")||null!==e&&void 0!==e&&e.includes("powerpoint")?"\ud83d\udcfd\ufe0f":null!==e&&void 0!==e&&e.includes("zip")||null!==e&&void 0!==e&&e.includes("archive")?"\ud83d\udce6":"\ud83d\udcce");const Wa=function(e){let{attachments:t=[],onUpdate:n,maxFiles:a=10,acceptedTypes:r=null,showUpload:o=!0,showPicker:i=!0,compact:s=!1}=e;const{isSignedIn:c,pickerLoaded:d,uploadFileToDrive:u,openFilePicker:p}=lt(),[m,h]=(0,l.useState)(!1),[g,f]=(0,l.useState)(""),v=(0,l.useRef)(null);return c?(0,He.jsxs)("div",{className:"file-attachments ".concat(s?"compact":""),children:[t.length>0&&(0,He.jsx)("div",{className:"attachments-list",children:t.map(e=>{return(0,He.jsxs)("div",{className:"attachment-item",children:[(0,He.jsx)("span",{className:"attachment-icon",children:"string"===typeof Ga(e.mimeType,e.iconUrl)&&Ga(e.mimeType,e.iconUrl).startsWith("http")?(0,He.jsx)("img",{src:e.iconUrl,alt:""}):Ga(e.mimeType,e.iconUrl)}),(0,He.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"attachment-name",title:e.name,children:e.name}),e.size&&(0,He.jsx)("span",{className:"attachment-size",children:(a=e.size,a?a<1024?"".concat(a," B"):a<1048576?"".concat((a/1024).toFixed(1)," KB"):"".concat((a/1048576).toFixed(1)," MB"):"")}),(0,He.jsx)("span",{className:"attachment-source ".concat(e.source),children:"upload"===e.source?"\u2191":"\u2601"}),(0,He.jsx)("button",{className:"attachment-remove",onClick:()=>{return a=e.id,void n(t.filter(e=>e.id!==a));var a},title:"Remove attachment",children:"\xd7"})]},e.id);var a})}),(o||i)&&t.length<a&&(0,He.jsxs)("div",{className:"attachments-actions",children:[o&&(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("input",{ref:v,type:"file",multiple:!0,accept:null===r||void 0===r?void 0:r.join(","),onChange:async e=>{const r=Array.from(e.target.files);if(0===r.length)return;if(t.length+r.length>a)return void alert("Maximum ".concat(a," files allowed"));h(!0);const o=[...t];for(let t=0;t<r.length;t++){const e=r[t];f("Uploading ".concat(t+1,"/").concat(r.length,": ").concat(e.name));try{const t=await u(e);t&&o.push({id:t.id,name:t.name,mimeType:t.mimeType,url:t.webViewLink,downloadUrl:t.webContentLink,iconUrl:t.iconLink,uploadedAt:(new Date).toISOString(),source:"upload"})}catch(i){console.error("Upload failed:",i)}}n(o),h(!1),f(""),v.current&&(v.current.value="")},style:{display:"none"},id:"file-upload-input"}),(0,He.jsxs)("button",{className:"btn-attach upload",onClick:()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.click()},disabled:m,children:[m?"\u23f3":"\ud83d\udce4"," ",s?"":"Upload"]})]}),i&&d&&(0,He.jsxs)("button",{className:"btn-attach picker",onClick:async()=>{if(d&&c)if(t.length>=a)alert("Maximum ".concat(a," files allowed"));else try{const e=await p({multiSelect:!0,mimeTypes:r});if(e){const r=Array.isArray(e)?e:[e],o=[...t];for(const e of r)if(!o.some(t=>t.id===e.id)){if(o.length>=a)break;o.push({id:e.id,name:e.name,mimeType:e.mimeType,url:e.url,iconUrl:e.iconUrl,linkedAt:(new Date).toISOString(),source:"drive"})}n(o)}}catch(e){console.error("Picker error:",e)}else alert("Please sign in to Google to use this feature")},disabled:m,children:["\u2601\ufe0f ",s?"":"Google Drive"]})]}),g&&(0,He.jsx)("div",{className:"upload-progress",children:g}),0===t.length&&!s&&(0,He.jsx)("div",{className:"attachments-empty",children:"No files attached"})]}):(0,He.jsx)("div",{className:"file-attachments ".concat(s?"compact":""),children:(0,He.jsx)("div",{className:"attachments-signin-prompt",children:"Sign in to Google to attach files"})})},Va=[{id:"high",label:"High",color:"#e74c3c"},{id:"medium",label:"Medium",color:"#f39c12"},{id:"low",label:"Low",color:"#27ae60"}],qa=[{id:"red",color:"#e74c3c",name:"Red"},{id:"orange",color:"#f39c12",name:"Orange"},{id:"yellow",color:"#f1c40f",name:"Yellow"},{id:"green",color:"#27ae60",name:"Green"},{id:"blue",color:"#3498db",name:"Blue"},{id:"purple",color:"#9b59b6",name:"Purple"},{id:"pink",color:"#e91e63",name:"Pink"},{id:"teal",color:"#00bcd4",name:"Teal"}];const Ka=function(e){var t;let{task:n,columnId:a,isOpen:r,onClose:o,onSave:i,onDelete:s,allTasks:c}=e;const[d,u]=(0,l.useState)({title:"",description:"",priority:"medium",dueDate:"",dueTime:"",links:[],labels:[],checklist:[],dependencies:[],attachments:[]}),[p,m]=(0,l.useState)({title:"",url:""}),[h,g]=(0,l.useState)(""),[f,v]=(0,l.useState)(!1),[y,b]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{n&&u({title:n.title||"",description:n.description||"",priority:n.priority||"medium",dueDate:n.dueDate||"",dueTime:n.dueTime||"",links:n.links||[],labels:n.labels||[],checklist:n.checklist||[],dependencies:n.dependencies||[],attachments:n.attachments||[]})},[n]),!r||!n)return null;const x=()=>{if(p.url.trim()){const e={id:Date.now(),title:p.title.trim()||p.url,url:p.url.trim()};u(Je(Je({},d),{},{links:[...d.links,e]})),m({title:"",url:""}),v(!1)}},k=e=>{const t=d.labels.includes(e);u(Je(Je({},d),{},{labels:t?d.labels.filter(t=>t!==e):[...d.labels,e]}))},j=()=>{if(h.trim()){const e={id:Date.now(),text:h.trim(),completed:!1};u(Je(Je({},d),{},{checklist:[...d.checklist,e]})),g("")}},w=d.checklist.length>0?Math.round(d.checklist.filter(e=>e.completed).length/d.checklist.length*100):0,S=d.dueDate&&new Date(d.dueDate)<new Date;return(0,He.jsx)("div",{className:"modal-overlay",onClick:o,children:(0,He.jsxs)("div",{className:"task-modal-content",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"task-modal-header",children:[(0,He.jsx)("div",{className:"task-modal-labels",children:d.labels.map(e=>{const t=qa.find(t=>t.id===e);return t?(0,He.jsx)("span",{className:"task-label-pill",style:{backgroundColor:t.color}},e):null})}),(0,He.jsx)("button",{className:"modal-close",onClick:o,children:"\xd7"})]}),(0,He.jsxs)("div",{className:"task-modal-body",children:[(0,He.jsx)("div",{className:"task-section",children:(0,He.jsx)("input",{type:"text",className:"task-title-input",value:d.title,onChange:e=>u(Je(Je({},d),{},{title:e.target.value})),placeholder:"Task title..."})}),(0,He.jsxs)("div",{className:"task-meta-row",children:[(0,He.jsxs)("div",{className:"task-meta-item",children:[(0,He.jsx)("label",{children:"Priority"}),(0,He.jsx)("div",{className:"priority-selector",children:Va.map(e=>(0,He.jsx)("button",{className:"priority-option ".concat(d.priority===e.id?"selected":""),style:{"--priority-color":e.color,backgroundColor:d.priority===e.id?e.color:"transparent"},onClick:()=>u(Je(Je({},d),{},{priority:e.id})),children:e.label},e.id))})]}),(0,He.jsxs)("div",{className:"task-meta-item",children:[(0,He.jsx)("label",{children:"Due Date"}),(0,He.jsx)("input",{type:"date",className:"date-input ".concat(S?"overdue":""),value:(null===(t=d.dueDate)||void 0===t?void 0:t.split("T")[0])||d.dueDate||"",onChange:e=>{const t=e.target.value,n=d.dueTime||"";u(Je(Je({},d),{},{dueDate:t,dueTime:n}))}})]}),(0,He.jsxs)("div",{className:"task-meta-item",children:[(0,He.jsxs)("label",{children:["Due Time ",(0,He.jsx)("span",{className:"optional-hint",children:"(optional)"})]}),(0,He.jsx)("input",{type:"time",className:"time-input",value:d.dueTime||"",onChange:e=>u(Je(Je({},d),{},{dueTime:e.target.value}))})]})]}),(0,He.jsxs)("div",{className:"task-section",children:[(0,He.jsxs)("div",{className:"section-header-row",children:[(0,He.jsx)("label",{children:"Labels"}),(0,He.jsx)("button",{className:"add-btn-small",onClick:()=>b(!y),children:y?"Done":"+ Add"})]}),y&&(0,He.jsx)("div",{className:"label-picker",children:qa.map(e=>(0,He.jsx)("button",{className:"label-option ".concat(d.labels.includes(e.id)?"selected":""),style:{backgroundColor:e.color},onClick:()=>k(e.id),children:d.labels.includes(e.id)&&"\u2713"},e.id))}),(0,He.jsx)("div",{className:"selected-labels",children:d.labels.map(e=>{const t=qa.find(t=>t.id===e);return t?(0,He.jsxs)("span",{className:"label-tag",style:{backgroundColor:t.color},children:[t.name,(0,He.jsx)("button",{onClick:()=>k(e),children:"\xd7"})]},e):null})})]}),(0,He.jsx)("div",{className:"task-section",children:(0,He.jsx)(Ba,{currentTaskId:n.id,allTasks:c,selectedDependencies:d.dependencies,onUpdate:e=>u(Je(Je({},d),{},{dependencies:e}))})}),(0,He.jsxs)("div",{className:"task-section",children:[(0,He.jsx)("label",{children:"Notes"}),(0,He.jsx)(ya,{className:"task-description-input",value:d.description,onChange:e=>u(Je(Je({},d),{},{description:e})),attachments:d.attachments,onAttachmentsChange:e=>u(Je(Je({},d),{},{attachments:e})),variant:"macro",placeholder:"Add notes, details, or context... (type @ for commands, drag files to upload)",rows:4})]}),(0,He.jsxs)("div",{className:"task-section",children:[(0,He.jsxs)("div",{className:"section-header-row",children:[(0,He.jsx)("label",{children:"Checklist"}),d.checklist.length>0&&(0,He.jsxs)("span",{className:"checklist-progress",children:[w,"%"]})]}),d.checklist.length>0&&(0,He.jsx)("div",{className:"checklist-progress-bar",children:(0,He.jsx)("div",{className:"checklist-progress-fill",style:{width:"".concat(w,"%")}})}),(0,He.jsx)("div",{className:"checklist-items",children:d.checklist.map(e=>(0,He.jsxs)("div",{className:"checklist-item ".concat(e.completed?"completed":""),children:[(0,He.jsx)("input",{type:"checkbox",checked:e.completed,onChange:()=>{return t=e.id,void u(Je(Je({},d),{},{checklist:d.checklist.map(e=>e.id===t?Je(Je({},e),{},{completed:!e.completed}):e)}));var t}}),(0,He.jsx)("span",{className:"checklist-text",children:e.text}),(0,He.jsx)("button",{className:"remove-btn",onClick:()=>{return t=e.id,void u(Je(Je({},d),{},{checklist:d.checklist.filter(e=>e.id!==t)}));var t},children:"\xd7"})]},e.id))}),(0,He.jsxs)("div",{className:"add-checklist-form",children:[(0,He.jsx)("input",{type:"text",placeholder:"Add checklist item...",value:h,onChange:e=>g(e.target.value),onKeyPress:e=>"Enter"===e.key&&j()}),(0,He.jsx)("button",{onClick:j,children:"Add"})]})]}),(0,He.jsxs)("div",{className:"task-section",children:[(0,He.jsxs)("div",{className:"section-header-row",children:[(0,He.jsx)("label",{children:"Links & Attachments"}),(0,He.jsx)("button",{className:"add-btn-small",onClick:()=>v(!f),children:"+ Add Link"})]}),f&&(0,He.jsxs)("div",{className:"add-link-form",children:[(0,He.jsx)("input",{type:"text",placeholder:"Link title (optional)",value:p.title,onChange:e=>m(Je(Je({},p),{},{title:e.target.value}))}),(0,He.jsx)("input",{type:"url",placeholder:"https://...",value:p.url,onChange:e=>m(Je(Je({},p),{},{url:e.target.value})),onKeyPress:e=>"Enter"===e.key&&x()}),(0,He.jsxs)("div",{className:"link-form-actions",children:[(0,He.jsx)("button",{className:"submit-btn",onClick:x,children:"Add"}),(0,He.jsx)("button",{className:"cancel-btn",onClick:()=>v(!1),children:"Cancel"})]})]}),(0,He.jsx)("div",{className:"links-list",children:d.links.map(e=>(0,He.jsxs)("div",{className:"link-item",children:[(0,He.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:[(0,He.jsx)("span",{className:"link-icon",children:"\ud83d\udd17"}),e.title]}),(0,He.jsx)("button",{className:"remove-btn",onClick:()=>{return t=e.id,void u(Je(Je({},d),{},{links:d.links.filter(e=>e.id!==t)}));var t},children:"\xd7"})]},e.id))})]}),(0,He.jsxs)("div",{className:"task-section",children:[(0,He.jsx)("div",{className:"section-header-row",children:(0,He.jsx)("label",{children:"Google Drive Files"})}),(0,He.jsx)(Wa,{attachments:d.attachments,onUpdate:e=>u(Je(Je({},d),{},{attachments:e})),maxFiles:10})]})]}),(0,He.jsxs)("div",{className:"task-modal-footer",children:[(0,He.jsx)("button",{className:"btn-delete",onClick:()=>{window.confirm("Delete this task?")&&(s(n.id,a),o())},children:"Delete Task"}),(0,He.jsxs)("div",{className:"footer-actions",children:[(0,He.jsx)("button",{className:"btn-cancel",onClick:o,children:"Cancel"}),(0,He.jsx)("button",{className:"btn-submit",onClick:()=>{i(n.id,a,d),o()},children:"Save Changes"})]})]})]})})},Ja=[{id:"backlog",title:"Backlog",icon:"\ud83d\udccb"},{id:"inProgress",title:"In Progress",icon:"\ud83d\udd04"},{id:"review",title:"Review",icon:"\ud83d\udc40"},{id:"done",title:"Done",icon:"\u2705"}],Ha={high:"#e74c3c",medium:"#f39c12",low:"#27ae60"},Qa={red:"#e74c3c",orange:"#f39c12",yellow:"#f1c40f",green:"#27ae60",blue:"#3498db",purple:"#9b59b6",pink:"#e91e63",teal:"#00bcd4"};const $a=function(e){let{tasks:t,projectColor:n,onTaskMove:a,onAddTask:r,onDeleteTask:o,onUpdateTask:i,onReorderTask:s}=e;const[c,d]=(0,l.useState)(null),[u,p]=(0,l.useState)(null),[m,h]=(0,l.useState)(null),[g,f]=(0,l.useState)({}),[v,y]=(0,l.useState)({}),[b,x]=(0,l.useState)(null),[k,j]=(0,l.useState)(null),[w,S]=(0,l.useState)(null),[N,C]=(0,l.useState)(""),E=e=>{e.target.classList.remove("dragging"),d(null),p(null),h(null)},I=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},D=()=>{h(null)},T=e=>{var t;null!==(t=g[e])&&void 0!==t&&t.trim()&&(r(e,g[e].trim()),f(Je(Je({},g),{},{[e]:""})),y(Je(Je({},v),{},{[e]:!1})))},A=e=>{C(e.target.value)},P=(e,t)=>{N.trim()&&i&&i(e,t,{title:N.trim()}),S(null),C("")},O=e=>{var n;return(null===(n=t[e])||void 0===n?void 0:n.length)||0};return(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("div",{className:"kanban-board",children:Ja.map(e=>{var n;return(0,He.jsxs)("div",{className:"kanban-column ".concat(u&&u!==e.id?"drop-target":""),onDragOver:I,onDrop:n=>function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e.preventDefault(),c){if(u!==n)a(c.id,u,n,r);else if(null!==r&&s){var o;const e=null===(o=t[n])||void 0===o?void 0:o.findIndex(e=>e.id===c.id);-1!==e&&e!==r&&s(c.id,n,e,r)}d(null),p(null),h(null)}}(n,e.id),children:[(0,He.jsxs)("div",{className:"column-header",children:[(0,He.jsxs)("div",{className:"column-title",children:[(0,He.jsx)("span",{className:"column-icon",children:e.icon}),(0,He.jsx)("h3",{children:e.title}),(0,He.jsx)("span",{className:"task-count",children:O(e.id)})]}),(0,He.jsx)("button",{className:"add-task-btn",onClick:()=>y(Je(Je({},v),{},{[e.id]:!0})),title:"Add task",children:"+"})]}),(0,He.jsxs)("div",{className:"column-content",children:[v[e.id]&&(0,He.jsxs)("div",{className:"add-task-form",children:[(0,He.jsx)("input",{type:"text",placeholder:"Enter task title...",value:g[e.id]||"",onChange:t=>f(Je(Je({},g),{},{[e.id]:t.target.value})),onKeyPress:t=>"Enter"===t.key&&T(e.id),autoFocus:!0}),(0,He.jsxs)("div",{className:"add-task-actions",children:[(0,He.jsx)("button",{className:"submit-btn",onClick:()=>T(e.id),children:"Add"}),(0,He.jsx)("button",{className:"cancel-btn",onClick:()=>y(Je(Je({},v),{},{[e.id]:!1})),children:"Cancel"})]})]}),null===(n=t[e.id])||void 0===n?void 0:n.map((n,r)=>{const i=((e,t)=>{if(!e)return null;const n=new Date(e),a=new Date;a.setHours(0,0,0,0);const r=new Date(a);r.setDate(r.getDate()+1);const o=(e=>{if(!e)return"";const[t,n]=e.split(":"),a=parseInt(t),r=a>=12?"pm":"am";return" ".concat(a%12||12,":").concat(n).concat(r)})(t);return n<a?{text:"Overdue"+o,className:"overdue"}:n.toDateString()===a.toDateString()?{text:"Today"+o,className:"due-today"}:n.toDateString()===r.toDateString()?{text:"Tomorrow"+o,className:"due-soon"}:{text:n.toLocaleDateString("en-US",{month:"short",day:"numeric"})+o,className:""}})(n.dueDate,n.dueTime),l=(g=n.checklist)&&0!==g.length?{completed:g.filter(e=>e.completed).length,total:g.length}:null;var g;const f=n.description&&n.description.trim().length>0,v=n.links&&n.links.length>0,y=(null===m||void 0===m?void 0:m.taskId)===n.id&&(null===m||void 0===m?void 0:m.columnId)===e.id;return(0,He.jsxs)("div",{className:"task-card ".concat((null===c||void 0===c?void 0:c.id)===n.id?"dragging":""," ").concat(y?"drag-over":""),draggable:!0,onDragStart:t=>((e,t,n)=>{d(t),p(n),e.dataTransfer.effectAllowed="move",setTimeout(()=>{e.target.classList.add("dragging")},0)})(t,n,e.id),onDragEnd:E,onDragOver:t=>((e,t,n)=>{e.preventDefault(),e.stopPropagation(),c&&c.id!==t.id&&h({taskId:t.id,columnId:n})})(t,n,e.id),onDragLeave:D,onDrop:r=>((e,n,r)=>{var o;if(e.preventDefault(),e.stopPropagation(),!c||c.id===n.id)return;const i=null===(o=t[r])||void 0===o?void 0:o.findIndex(e=>e.id===n.id);if(u!==r)a(c.id,u,r,i);else if(s){var l;const e=null===(l=t[r])||void 0===l?void 0:l.findIndex(e=>e.id===c.id);-1!==e&&e!==i&&s(c.id,r,e,i)}d(null),p(null),h(null)})(r,n,e.id),onClick:t=>((e,t,n)=>{e.defaultPrevented||(x(t),j(n))})(t,n,e.id),children:[n.labels&&n.labels.length>0&&(0,He.jsx)("div",{className:"task-labels-bar",children:n.labels.map(e=>(0,He.jsx)("span",{className:"task-label-mini",style:{backgroundColor:Qa[e]||"#888"}},e))}),(0,He.jsxs)("div",{className:"task-header",children:[(0,He.jsx)("span",{className:"priority-indicator",style:{backgroundColor:Ha[n.priority]},title:"".concat(n.priority," priority")}),(0,He.jsx)("button",{className:"delete-task-btn",onClick:t=>{t.stopPropagation(),o(n.id,e.id)},title:"Delete task",children:"\xd7"})]}),w===n.id?(0,He.jsx)("input",{type:"text",className:"task-title-edit",value:N,onChange:A,onKeyDown:t=>((e,t,n)=>{"Enter"===e.key?(e.preventDefault(),P(t,n)):"Escape"===e.key&&(S(null),C(""))})(t,n.id,e.id),onBlur:()=>{return t=n.id,a=e.id,void P(t,a);var t,a},onClick:e=>e.stopPropagation(),autoFocus:!0}):(0,He.jsx)("p",{className:"task-title",onDoubleClick:e=>((e,t)=>{e.stopPropagation(),S(t.id),C(t.title)})(e,n),title:"Double-click to edit",children:n.title}),n.attachments&&n.attachments.length>0&&(0,He.jsxs)("div",{className:"task-card-attachments",children:[n.attachments.filter(e=>e.isImage).slice(0,3).map(e=>(0,He.jsx)("img",{src:e.thumbnailLink||"https://drive.google.com/thumbnail?id=".concat(e.id,"&sz=w64"),alt:e.name,className:"task-card-thumbnail",onClick:t=>{t.stopPropagation(),window.open(e.webViewLink||"https://drive.google.com/file/d/".concat(e.id,"/view"),"_blank")},title:e.name},e.id)),n.attachments.filter(e=>e.isImage).length>3&&(0,He.jsxs)("span",{className:"task-card-more-attachments",children:["+",n.attachments.filter(e=>e.isImage).length-3]})]}),(0,He.jsxs)("div",{className:"task-metadata",children:[i&&(0,He.jsxs)("span",{className:"due-badge ".concat(i.className),children:[(0,He.jsx)("span",{className:"due-icon",children:"\ud83d\udcc5"}),i.text]}),f&&(0,He.jsx)("span",{className:"meta-icon",title:"Has notes",children:"\ud83d\udcdd"}),v&&(0,He.jsx)("span",{className:"meta-icon",title:"".concat(n.links.length," link(s)"),children:"\ud83d\udd17"}),n.attachments&&n.attachments.length>0&&(0,He.jsxs)("span",{className:"meta-icon",title:"".concat(n.attachments.length," attachment(s)"),children:["\ud83d\udcce ",n.attachments.length]}),l&&(0,He.jsxs)("span",{className:"checklist-badge ".concat(l.completed===l.total?"complete":""),title:"Checklist progress",children:["\u2611 ",l.completed,"/",l.total]})]}),(0,He.jsx)("div",{className:"task-footer",children:(0,He.jsx)("span",{className:"priority-badge ".concat(n.priority),children:n.priority})})]},n.id)})]})]},e.id)})}),(0,He.jsx)(Ka,{task:b,columnId:k,isOpen:null!==b,onClose:()=>{x(null),j(null)},onSave:(e,t,n)=>{i&&i(e,t,n)},onDelete:o,allTasks:t})]})},Ya="research-dashboard-protocols",Xa="research-dashboard-results",Za=(e,t)=>{try{const n=localStorage.getItem(e);if(n){return JSON.parse(n)[t]||[]}}catch(n){}return[]};const er=function(e){let{projectId:t,projectTitle:n}=e;const{logActivity:a}=et(),{isSignedIn:r,createDoc:o,syncToDoc:i,importFromDoc:s,createSheet:c,syncToSheet:d,importFromSheet:u}=lt(),p=St(),{moveToTrash:m}=Fn(),{showSuccess:h}=vt(),g=(0,l.useCallback)((e,n)=>{((e,t,n)=>{try{const a=localStorage.getItem(e),r=a?JSON.parse(a):{};r[t]=n,localStorage.setItem(e,JSON.stringify(r))}catch(Fr){console.error("Failed to save:",Fr)}})(e,t,n),p()},[t,p]),[f,v]=(0,l.useState)("protocols"),[y,b]=(0,l.useState)(()=>Za(Ya,t)),[x,k]=(0,l.useState)(()=>Za(Xa,t)),[j,w]=(0,l.useState)(!1),[S,N]=(0,l.useState)({title:"",description:"",date:(new Date).toISOString().split("T")[0],fileUrl:"",tags:"",attachments:[]}),[C,E]=(0,l.useState)(null),[I,D]=(0,l.useState)({message:"",type:""}),T=(e,t)=>{if("protocols"===f){const n=y.map(n=>n.id===e?Je(Je({},n),t):n);b(n),g(Ya,n)}else{const n=x.map(n=>n.id===e?Je(Je({},n),t):n);k(n),g(Xa,n)}},A="protocols"===f?y:x;return(0,He.jsxs)("div",{className:"protocols-results-section",children:[(0,He.jsx)("div",{className:"google-status-indicator",children:r?(0,He.jsx)("span",{className:"google-status-text connected",children:"Google Connected"}):(0,He.jsx)("span",{className:"google-status-text",children:"Sign in via navbar for Google Docs"})}),I.message&&(0,He.jsxs)("div",{className:"sync-status-bar ".concat(I.type),children:[I.message,(0,He.jsx)("button",{onClick:()=>D({message:"",type:""}),children:"x"})]}),(0,He.jsxs)("div",{className:"pr-tabs",children:[(0,He.jsxs)("button",{className:"pr-tab ".concat("protocols"===f?"active":""),onClick:()=>v("protocols"),children:["Protocols (",y.length,")"]}),(0,He.jsxs)("button",{className:"pr-tab ".concat("results"===f?"active":""),onClick:()=>v("results"),children:["Data & Results (",x.length,")"]})]}),(0,He.jsxs)("div",{className:"pr-content",children:[(0,He.jsxs)("div",{className:"pr-header",children:[(0,He.jsx)("h3",{children:"protocols"===f?"Protocols & Methods":"Data & Results"}),(0,He.jsxs)("button",{className:"add-pr-btn",onClick:()=>w(!0),children:["+ Add ","protocols"===f?"Protocol":"Result"]})]}),j&&(0,He.jsxs)("div",{className:"pr-add-form",children:[(0,He.jsx)("input",{type:"text",placeholder:"protocols"===f?"Protocol title...":"Result title...",value:S.title,onChange:e=>N(Je(Je({},S),{},{title:e.target.value})),autoFocus:!0}),(0,He.jsx)(ya,{placeholder:"Description or notes... (type @ for commands, drag files to upload)",value:S.description,onChange:e=>N(Je(Je({},S),{},{description:e})),attachments:S.attachments,onAttachmentsChange:e=>N(Je(Je({},S),{},{attachments:e})),variant:"macro",rows:3}),(0,He.jsxs)("div",{className:"pr-form-row",children:[(0,He.jsx)("input",{type:"date",value:S.date,onChange:e=>N(Je(Je({},S),{},{date:e.target.value}))}),(0,He.jsx)("input",{type:"url",placeholder:"File/Link URL (optional)",value:S.fileUrl,onChange:e=>N(Je(Je({},S),{},{fileUrl:e.target.value}))})]}),(0,He.jsx)("input",{type:"text",placeholder:"Tags (comma separated)",value:S.tags,onChange:e=>N(Je(Je({},S),{},{tags:e.target.value}))}),(0,He.jsxs)("div",{className:"pr-form-actions",children:[(0,He.jsx)("button",{className:"btn-cancel",onClick:()=>w(!1),children:"Cancel"}),(0,He.jsx)("button",{className:"btn-submit",onClick:()=>{if(!S.title.trim())return;const e=Je(Je({id:Date.now()},S),{},{tags:S.tags.split(",").map(e=>e.trim()).filter(Boolean),createdAt:(new Date).toISOString(),googleDocId:null,googleDocUrl:null,googleSheetId:null,googleSheetUrl:null});if("protocols"===f){const r=[...y,e];b(r),g(Ya,r),a("protocol_added",{protocolTitle:e.title,projectId:t,projectTitle:n})}else{const r=[...x,e];k(r),g(Xa,r),a("result_added",{resultTitle:e.title,projectId:t,projectTitle:n})}N({title:"",description:"",date:(new Date).toISOString().split("T")[0],fileUrl:"",tags:"",attachments:[]}),w(!1)},children:"Add"})]})]}),0!==A.length||j?(0,He.jsx)("div",{className:"pr-list",children:A.map(e=>(0,He.jsxs)("div",{className:"pr-item ".concat(C===e.id?"expanded":""),children:[(0,He.jsxs)("div",{className:"pr-item-header",onClick:()=>E(C===e.id?null:e.id),children:[(0,He.jsxs)("div",{className:"pr-item-main",children:[(0,He.jsx)("span",{className:"pr-item-icon",children:"protocols"===f?"\ud83d\udccb":"\ud83d\udcca"}),(0,He.jsxs)("div",{className:"pr-item-info",children:[(0,He.jsxs)("h4",{children:[e.title,e.googleDocId&&(0,He.jsx)("span",{className:"google-doc-indicator",title:"Linked to Google Doc",children:"\ud83d\udcc4"}),e.googleSheetId&&(0,He.jsx)("span",{className:"google-sheet-indicator",title:"Linked to Google Sheet",children:"\ud83d\udcca"})]}),(0,He.jsx)("span",{className:"pr-item-date",children:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]}),(0,He.jsxs)("div",{className:"pr-item-actions",children:[e.fileUrl&&(0,He.jsx)("a",{href:e.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"pr-link-btn",onClick:e=>e.stopPropagation(),children:"\ud83d\udd17"}),(0,He.jsx)("button",{className:"pr-delete-btn",onClick:a=>{a.stopPropagation(),(e=>{if("protocols"===f){const a=y.find(t=>t.id===e);if(!a)return;m(Rn.PROTOCOL,a,{projectId:t,projectTitle:n});const r=y.filter(t=>t.id!==e);b(r),g(Ya,r),h('"'.concat(a.title||"Protocol",'" moved to trash'))}else{const a=x.find(t=>t.id===e);if(!a)return;m(Rn.RESULT,a,{projectId:t,projectTitle:n});const r=x.filter(t=>t.id!==e);k(r),g(Xa,r),h('"'.concat(a.title||"Result",'" moved to trash'))}})(e.id)},children:"\ud83d\uddd1\ufe0f"}),(0,He.jsx)("span",{className:"pr-expand-icon",children:C===e.id?"\u25bc":"\u25b6"})]})]}),C===e.id&&(0,He.jsxs)("div",{className:"pr-item-details",children:[e.description&&(0,He.jsx)("p",{className:"pr-description",children:e.description}),e.tags&&e.tags.length>0&&(0,He.jsx)("div",{className:"pr-tags",children:e.tags.map((e,t)=>(0,He.jsx)("span",{className:"pr-tag",children:e},t))}),e.fileUrl&&(0,He.jsx)("a",{href:e.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"pr-file-link",children:"\ud83d\udcce Open attached file/link"}),r&&(0,He.jsxs)("div",{className:"pr-google-actions",children:[(0,He.jsx)("span",{className:"google-action-label",children:"Docs:"}),e.googleDocId?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("a",{href:e.googleDocUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-google-action",children:"Open"}),(0,He.jsx)("button",{className:"btn-google-action",onClick:()=>(async e=>{var t;if(!e.googleDocId)return void D({message:"No Google Doc linked to this item",type:"error"});const a="".concat("protocols"===f?"Protocol":"Result",": ").concat(e.title,"\nProject: ").concat(n,"\nDate: ").concat(new Date(e.date).toLocaleDateString(),"\nTags: ").concat((null===(t=e.tags)||void 0===t?void 0:t.join(", "))||"None","\n\n---\n\n").concat(e.description||"No description provided.","\n\n").concat(e.fileUrl?"\nAttached File/Link: ".concat(e.fileUrl):"","\n\n---\nCreated: ").concat(new Date(e.createdAt).toLocaleString(),"\nLast Updated: ").concat((new Date).toLocaleString());await i(e.googleDocId,a)})(e),title:"Push to Google Doc",children:"\u2b06"}),(0,He.jsx)("button",{className:"btn-google-action",onClick:()=>(async e=>{if(!e.googleDocId)return void D({message:"No Google Doc linked to this item",type:"error"});D({message:"Importing from Google Doc...",type:"info"});const t=await s(e.googleDocId);if(t){let n=t.content;const a=n.indexOf("---"),r=n.lastIndexOf("---");-1!==a&&-1!==r&&a!==r&&(n=n.substring(a+3,r).trim(),n=n.replace(/\nAttached File\/Link:.*$/m,"").trim()),T(e.id,{description:n}),D({message:"Imported from Google Doc!",type:"success"})}else D({message:"Failed to import from Google Doc",type:"error"});setTimeout(()=>D({message:"",type:""}),3e3)})(e),title:"Pull from Google Doc",children:"\u2b07"})]}):(0,He.jsx)("button",{className:"btn-google-action primary",onClick:()=>(async e=>{var t;const a="protocols"===f?"Protocol":"Result",r="[".concat(a,"] ").concat(e.title," - ").concat(n),i="".concat(a,": ").concat(e.title,"\nProject: ").concat(n,"\nDate: ").concat(new Date(e.date).toLocaleDateString(),"\nTags: ").concat((null===(t=e.tags)||void 0===t?void 0:t.join(", "))||"None","\n\n---\n\n").concat(e.description||"No description provided.","\n\n").concat(e.fileUrl?"\nAttached File/Link: ".concat(e.fileUrl):"","\n\n---\nCreated: ").concat(new Date(e.createdAt).toLocaleString(),"\nLast Updated: ").concat((new Date).toLocaleString()),l=await o(r,i);l&&(T(e.id,{googleDocId:l.docId,googleDocUrl:l.docUrl}),window.open(l.docUrl,"_blank"))})(e),children:"+ Create"})]}),r&&(0,He.jsxs)("div",{className:"pr-google-actions",children:[(0,He.jsx)("span",{className:"google-action-label",children:"Sheets:"}),e.googleSheetId?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("a",{href:e.googleSheetUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-google-action",children:"Open"}),(0,He.jsx)("button",{className:"btn-google-action",onClick:()=>(async e=>{var t;if(!e.googleSheetId)return void D({message:"No Google Sheet linked",type:"error"});const a="protocols"===f?"Protocol":"Result",r=[["Title",e.title],["Type",a],["Project",n],["Date",new Date(e.date).toLocaleDateString()],["Tags",(null===(t=e.tags)||void 0===t?void 0:t.join(", "))||"None"],["Description",e.description||""],["File/Link",e.fileUrl||""],["Created",new Date(e.createdAt).toLocaleString()],["Last Updated",(new Date).toLocaleString()]];D({message:"Syncing to Google Sheet...",type:"info"});const o=await d(e.googleSheetId,["Field","Value"],r);D(o?{message:"Synced to Google Sheet!",type:"success"}:{message:"Failed to sync to Google Sheet",type:"error"}),setTimeout(()=>D({message:"",type:""}),3e3)})(e),title:"Push to Google Sheet",children:"\u2b06"}),(0,He.jsx)("button",{className:"btn-google-action",onClick:()=>(async e=>{if(!e.googleSheetId)return void D({message:"No Google Sheet linked",type:"error"});D({message:"Importing from Google Sheet...",type:"info"});const t=await u(e.googleSheetId);if(t&&t.data){const n={};t.data.forEach(e=>{var t;const a=null===(t=e[0])||void 0===t?void 0:t.toLowerCase(),r=e[1]||"";"description"===a&&(n.description=r),"tags"===a&&(n.tags=r.split(",").map(e=>e.trim()).filter(Boolean))}),Object.keys(n).length>0&&T(e.id,n),D({message:"Imported from Google Sheet!",type:"success"})}else D({message:"Failed to import from Google Sheet",type:"error"});setTimeout(()=>D({message:"",type:""}),3e3)})(e),title:"Pull from Google Sheet",children:"\u2b07"})]}):(0,He.jsx)("button",{className:"btn-google-action primary",onClick:()=>(async e=>{var t;const a="protocols"===f?"Protocol":"Result",r="[".concat(a,"] ").concat(e.title," - ").concat(n),o=[["Title",e.title],["Type",a],["Project",n],["Date",new Date(e.date).toLocaleDateString()],["Tags",(null===(t=e.tags)||void 0===t?void 0:t.join(", "))||"None"],["Description",e.description||""],["File/Link",e.fileUrl||""],["Created",new Date(e.createdAt).toLocaleString()],["Last Updated",(new Date).toLocaleString()]];D({message:"Creating Google Sheet...",type:"info"});const i=await c(r,["Field","Value"],o);i?(T(e.id,{googleSheetId:i.spreadsheetId,googleSheetUrl:i.sheetUrl}),D({message:"Google Sheet created!",type:"success"}),window.open(i.sheetUrl,"_blank")):D({message:"Failed to create Google Sheet",type:"error"}),setTimeout(()=>D({message:"",type:""}),3e3)})(e),children:"+ Create"})]}),(0,He.jsxs)("div",{className:"pr-attachments",children:[(0,He.jsx)("span",{className:"google-action-label",children:"Files:"}),(0,He.jsx)(Wa,{attachments:e.attachments||[],onUpdate:t=>T(e.id,{attachments:t}),maxFiles:10,compact:!0})]})]})]},e.id))}):(0,He.jsxs)("div",{className:"pr-empty",children:[(0,He.jsxs)("p",{children:["No ","protocols"===f?"protocols":"results"," yet"]}),(0,He.jsxs)("span",{children:["Add your first ","protocols"===f?"protocol or method":"data or result"]})]})]})]})};async function tr(e){const t=e.toString().trim();try{var n,a,r,o,i,l,s,c,d,u;const e=await fetch("https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&id=".concat(t,"&retmode=xml"));if(!e.ok)throw new Error("PubMed API error: ".concat(e.status));const p=await e.text(),m=(new DOMParser).parseFromString(p,"text/xml"),h=m.querySelector("ERROR");if(h)throw new Error(h.textContent);const g=m.querySelector("PubmedArticle");if(!g)throw new Error("Article not found");const f=(null===(n=g.querySelector("ArticleTitle"))||void 0===n?void 0:n.textContent)||"",v=(null===(a=g.querySelector("Abstract AbstractText"))||void 0===a?void 0:a.textContent)||"",y=g.querySelectorAll("Author"),b=Array.from(y).map(e=>{var t,n,a;const r=(null===(t=e.querySelector("LastName"))||void 0===t?void 0:t.textContent)||"",o=(null===(n=e.querySelector("ForeName"))||void 0===n?void 0:n.textContent)||"",i=(null===(a=e.querySelector("Initials"))||void 0===a?void 0:a.textContent)||"";return r?"".concat(r," ").concat(i||o):""}).filter(Boolean).join(", "),x=(null===(r=g.querySelector("Journal Title"))||void 0===r?void 0:r.textContent)||(null===(o=g.querySelector("ISOAbbreviation"))||void 0===o?void 0:o.textContent)||"",k=(null===(i=g.querySelector("Volume"))||void 0===i?void 0:i.textContent)||"",j=(null===(l=g.querySelector("Issue"))||void 0===l?void 0:l.textContent)||"",w=(null===(s=g.querySelector("MedlinePgn"))||void 0===s?void 0:s.textContent)||"",S=g.querySelector("PubDate"),N=(null===S||void 0===S||null===(c=S.querySelector("Year"))||void 0===c?void 0:c.textContent)||(null===S||void 0===S||null===(d=S.querySelector("MedlineDate"))||void 0===d||null===(u=d.textContent)||void 0===u?void 0:u.substring(0,4))||"",C=g.querySelector('ArticleId[IdType="doi"]'),E=(null===C||void 0===C?void 0:C.textContent)||"";return{id:"pmid-".concat(t,"-").concat(Date.now()),pmid:t,doi:E,title:f,authors:b,journal:x,year:N,volume:k,issue:j,pages:w,abstract:v,url:"https://pubmed.ncbi.nlm.nih.gov/".concat(t,"/"),source:"pubmed",dateAdded:(new Date).toISOString()}}catch(p){throw console.error("Error fetching PMID ".concat(t,":"),p),new Error("Failed to fetch PMID ".concat(t,": ").concat(p.message))}}async function nr(e){let t=e.trim();t.startsWith("https://doi.org/")?t=t.replace("https://doi.org/",""):t.startsWith("http://doi.org/")?t=t.replace("http://doi.org/",""):t.startsWith("doi:")&&(t=t.replace("doi:",""));try{var n,a,r;const e=await fetch("https://api.crossref.org/works/".concat(encodeURIComponent(t)),{headers:{Accept:"application/json"}});if(!e.ok){if(404===e.status)throw new Error("DOI not found");throw new Error("CrossRef API error: ".concat(e.status))}const o=(await e.json()).message,i=(o.author||[]).map(e=>e.family&&e.given?"".concat(e.family," ").concat(e.given.charAt(0)):e.name||"").filter(Boolean).join(", "),l=o.published||o["published-print"]||o["published-online"],s=(null===l||void 0===l||null===(n=l["date-parts"])||void 0===n||null===(a=n[0])||void 0===a||null===(r=a[0])||void 0===r?void 0:r.toString())||"",c=Array.isArray(o.title)?o.title[0]:o.title||"",d=Array.isArray(o["container-title"])?o["container-title"][0]:o["container-title"]||"";return{id:"doi-".concat(Date.now()),pmid:"",doi:t,title:c,authors:i,journal:d,year:s,volume:o.volume||"",issue:o.issue||"",pages:o.page||"",abstract:o.abstract?o.abstract.replace(/<[^>]*>/g,""):"",url:"https://doi.org/".concat(t),source:"crossref",dateAdded:(new Date).toISOString()}}catch(o){throw console.error("Error fetching DOI ".concat(t,":"),o),new Error("Failed to fetch DOI ".concat(t,": ").concat(o.message))}}async function ar(e){const t=function(e){const t=[],n=e.split(/[,;\s\n]+/).filter(Boolean);for(const a of n){const e=a.trim();if(e)if(e.includes("/")||e.startsWith("10.")||e.toLowerCase().startsWith("doi:")||e.toLowerCase().includes("doi.org"))t.push({type:"doi",value:e});else if(/^(pmid[:\s]*)?(\d+)$/i.test(e)){const n=e.replace(/^pmid[:\s]*/i,"");t.push({type:"pmid",value:n})}else/^\d+$/.test(e)&&t.push({type:"pmid",value:e})}return t}(e),n={success:[],failed:[]};for(let a=0;a<t.length;a+=5){const e=t.slice(a,a+5).map(async e=>{let{type:t,value:n}=e;try{let e;return e="pmid"===t?await tr(n):await nr(n),{success:!0,citation:e,identifier:{type:t,value:n}}}catch(a){return{success:!1,error:a.message,identifier:{type:t,value:n}}}}),r=await Promise.all(e);for(const t of r)t.success?n.success.push(t.citation):n.failed.push({identifier:t.identifier,error:t.error});a+5<t.length&&await new Promise(e=>setTimeout(e,200))}return n}const rr="https://api.anthropic.com/v1/messages",or="claude-3-haiku-20240307";async function ir(e,t){if(!e)throw new Error("Claude API key is required");if(!t.abstract)throw new Error("Paper abstract is required for summarization");const n="You are a research assistant helping to summarize scientific papers. Analyze the following paper and provide:\n1. A concise summary (2-3 sentences) of the main findings and significance\n2. 3-5 key findings or takeaways as bullet points\n\nPaper Details:\nTitle: ".concat(t.title||"Unknown","\nAuthors: ").concat(t.authors||"Unknown","\nJournal: ").concat(t.journal||"Unknown"," (").concat(t.year||"Unknown",")\n\nAbstract:\n").concat(t.abstract,'\n\nRespond in JSON format:\n{\n  "summary": "Your 2-3 sentence summary here",\n  "keyFindings": ["Finding 1", "Finding 2", "Finding 3"]\n}');try{var a;const t=await fetch(rr,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":e,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:or,max_tokens:1024,messages:[{role:"user",content:n}]})});if(!t.ok){var r;const e=await t.json().catch(()=>({}));if(401===t.status)throw new Error("Invalid API key. Please check your Claude API key.");if(429===t.status)throw new Error("Rate limit exceeded. Please try again in a moment.");var o;if(400===t.status)throw new Error((null===(o=e.error)||void 0===o?void 0:o.message)||"Bad request to Claude API");throw new Error((null===(r=e.error)||void 0===r?void 0:r.message)||"API error: ".concat(t.status))}const l=null===(a=(await t.json()).content[0])||void 0===a?void 0:a.text;if(!l)throw new Error("No response from Claude API");try{const e=l.match(/\{[\s\S]*\}/);if(!e)throw new Error("Could not parse response");const t=JSON.parse(e[0]);return{summary:t.summary||"",keyFindings:t.keyFindings||[],generatedAt:(new Date).toISOString(),modelUsed:or}}catch(i){return{summary:l.trim(),keyFindings:[],generatedAt:(new Date).toISOString(),modelUsed:or}}}catch(l){if("TypeError"===l.name&&l.message.includes("fetch"))throw new Error("Network error. Please check your internet connection.");throw l}}async function lr(e,t,n){const a=[];for(let o=0;o<t.length;o++){const i=t[o];n&&n(o+1,t.length);try{const t=await ir(e,i);a.push({id:i.id,success:!0,summary:t})}catch(r){a.push({id:i.id,success:!1,error:r.message})}o<t.length-1&&await new Promise(e=>setTimeout(e,500))}return a}async function sr(e){if(!e)throw new Error("API key is required");try{const t=await fetch(rr,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":e,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:or,max_tokens:10,messages:[{role:"user",content:"Hi"}]})});if(401===t.status)throw new Error("Invalid API key");return t.ok}catch(t){if("Invalid API key"===t.message)throw t;throw new Error("Could not validate API key. Please check your connection.")}}async function cr(){throw new Error("Claude does not offer a native embeddings API. Please use OpenAI or Gemini for semantic search.")}async function dr(){throw new Error("Claude does not offer a native embeddings API. Please use OpenAI or Gemini for semantic search.")}function ur(){return!1}function pr(){return 0}const mr="research-dashboard-literature";const hr=function(e){let{projectId:t,projectTitle:n}=e;const i=St(),{getApiKeyForProvider:s,hasKeyForProvider:c,openSettings:d,summarizationProvider:u,getAvailableProvidersForSummarization:p}=Jt(),{moveToTrash:m}=Fn(),{showSuccess:h}=vt(),[g,f]=(0,l.useState)([]),[v,y]=(0,l.useState)(!1),[b,x]=(0,l.useState)(""),[k,j]=(0,l.useState)("all"),[w,S]=(0,l.useState)(null),[N,C]=(0,l.useState)(!1),[E,I]=(0,l.useState)({message:"",type:""}),[D,T]=(0,l.useState)(""),[A,P]=(0,l.useState)({current:0,total:0,importing:!1}),[O,L]=(0,l.useState)(null),[R,M]=(0,l.useState)({active:!1,current:0,total:0}),[F,U]=(0,l.useState)(u),_=e=>{switch(e){case Wt.CLAUDE:return o;case Wt.OPENAI:return a;case Wt.GEMINI:return r;default:return o}},z=()=>p().length>0,[B,G]=(0,l.useState)({pmid:"",doi:"",title:"",authors:"",journal:"",year:"",volume:"",pages:"",abstract:"",notes:"",tags:[]}),[W,V]=(0,l.useState)("");(0,l.useEffect)(()=>{const e=localStorage.getItem(mr);if(e)try{const n=JSON.parse(e);n[t]&&f(n[t])}catch(Fr){console.error("Failed to load references:",Fr)}},[t]);const q=(0,l.useCallback)(e=>{try{const n=localStorage.getItem(mr),a=n?JSON.parse(n):{};a[t]=e,localStorage.setItem(mr,JSON.stringify(a)),f(e),i()}catch(Fr){console.error("Failed to save references:",Fr)}},[t,i]),K=(e,t)=>{const n=g.map(n=>n.id===e?Je(Je(Je({},n),t),{},{updatedAt:(new Date).toISOString()}):n);q(n),(null===w||void 0===w?void 0:w.id)===e&&S(Je(Je({},w),t))},J=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F;if(!c(t))return void d();const n=g.find(t=>t.id===e);if(!n||!n.abstract)return I({message:"Abstract required for summarization",type:"error"}),void setTimeout(()=>I({message:"",type:""}),3e3);L(e);const a=Vt[t]||t;I({message:"Generating summary with ".concat(a,"..."),type:"info"});try{const r=s(t),o=_(t),i=await o.summarizePaper(r,n);i.provider=t,K(e,{aiSummary:i}),I({message:"Summary generated with ".concat(a,"!"),type:"success"})}catch(r){console.error("Summarization error:",r),I({message:r.message||"Failed to generate summary",type:"error"})}L(null),setTimeout(()=>I({message:"",type:""}),3e3)},H=()=>{G({pmid:"",doi:"",title:"",authors:"",journal:"",year:"",volume:"",pages:"",abstract:"",notes:"",tags:[]}),V("")},Q=()=>{W.trim()&&!B.tags.includes(W.trim())&&(G(Je(Je({},B),{},{tags:[...B.tags,W.trim()]})),V(""))},$=e=>{let t="";if(e.authors){const n=e.authors.split(", ");n.length>3?t+="".concat(n.slice(0,3).join(", "),", et al"):t+=e.authors,t+=". "}return e.title&&(t+=e.title,e.title.endsWith(".")||e.title.endsWith("?")||(t+="."),t+=" "),e.journal&&(t+="".concat(e.journal,". ")),e.year&&(t+=e.year,e.volume&&(t+=";".concat(e.volume),e.pages&&(t+=":".concat(e.pages))),t+="."),e.doi&&(t+=" doi:".concat(e.doi)),t.trim()},Y=e=>{const t=encodeURIComponent(e.title);return"https://scholar.google.com/scholar?q=".concat(t)},X=[...new Set(g.flatMap(e=>e.tags||[]))],Z=g.filter(e=>{var t,n,a;const r=!b||e.title.toLowerCase().includes(b.toLowerCase())||e.authors.toLowerCase().includes(b.toLowerCase())||(null===(t=e.journal)||void 0===t?void 0:t.toLowerCase().includes(b.toLowerCase()))||(null===(n=e.tags)||void 0===n?void 0:n.some(e=>e.toLowerCase().includes(b.toLowerCase()))),o="all"===k||(null===(a=e.tags)||void 0===a?void 0:a.includes(k));return r&&o}),[ee,te]=(0,l.useState)(!1);return(0,He.jsxs)("div",{className:"literature-manager",children:[E.message&&(0,He.jsxs)("div",{className:"sync-status-bar ".concat(E.type),children:[E.message,(0,He.jsx)("button",{onClick:()=>I({message:"",type:""}),children:"x"})]}),(0,He.jsxs)("div",{className:"literature-toolbar",children:[(0,He.jsx)("button",{className:"add-ref-btn",onClick:()=>y(!0),children:"+ Add Reference"}),(0,He.jsxs)("div",{className:"ai-summarize-group",children:[(0,He.jsx)("select",{className:"provider-select-inline",value:F,onChange:e=>U(e.target.value),disabled:R.active,title:"Select AI provider for summarization",children:Object.values(Wt).filter(e=>{var t;return null===(t=qt[e])||void 0===t?void 0:t.summarization}).map(e=>(0,He.jsxs)("option",{value:e,disabled:!c(e),children:[Vt[e]," ",c(e)?"":"(No key)"]},e))}),(0,He.jsx)("button",{className:"batch-summarize-btn",onClick:()=>async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F;if(!c(e))return void d();const t=g.filter(e=>e.abstract&&!e.aiSummary);if(0===t.length)return I({message:"No papers to summarize (all have summaries or no abstracts)",type:"info"}),void setTimeout(()=>I({message:"",type:""}),3e3);M({active:!0,current:0,total:t.length});const n=Vt[e]||e;I({message:"Summarizing ".concat(t.length," papers with ").concat(n,"..."),type:"info"});try{const a=s(e),r=_(e),o=await r.summarizePapersBatch(a,t,(e,t)=>M({active:!0,current:e,total:t})),i=o.filter(e=>e.success).length,l=g.map(t=>{const n=o.find(e=>e.id===t.id);return null!==n&&void 0!==n&&n.success?Je(Je({},t),{},{aiSummary:Je(Je({},n.summary),{},{provider:e}),updatedAt:(new Date).toISOString()}):t});q(l),I({message:"Summarized ".concat(i," of ").concat(t.length," papers with ").concat(n),type:i===t.length?"success":"warning"})}catch(a){console.error("Batch summarization error:",a),I({message:"Batch summarization failed",type:"error"})}M({active:!1,current:0,total:0}),setTimeout(()=>I({message:"",type:""}),4e3)}(F),disabled:R.active||0===g.length||!z(),title:z()?"Summarize all papers with abstracts":"Configure an API key first",children:R.active?"Summarizing ".concat(R.current,"/").concat(R.total,"..."):"AI Summarize All"})]}),(0,He.jsxs)("div",{className:"literature-filters",children:[(0,He.jsx)("input",{type:"text",className:"literature-search",placeholder:"Search references...",value:b,onChange:e=>x(e.target.value)}),(0,He.jsxs)("select",{className:"literature-tag-filter",value:k,onChange:e=>j(e.target.value),children:[(0,He.jsx)("option",{value:"all",children:"All Tags"}),X.map(e=>(0,He.jsx)("option",{value:e,children:e},e))]})]}),(0,He.jsxs)("div",{className:"export-dropdown",children:[(0,He.jsx)("button",{className:"export-refs-btn",onClick:()=>te(!ee),disabled:0===Z.length,title:"Export references",children:"\ud83d\udce5 Export"}),ee&&(0,He.jsxs)("div",{className:"export-menu",children:[(0,He.jsx)("button",{onClick:()=>{(()=>{const e=[["PMID","DOI","Title","Authors","Journal","Year","Tags","Abstract","Summary"]];Z.forEach(t=>{e.push([t.pmid||"",t.doi||"",(t.title||"").replace(/"/g,'""'),(t.authors||"").replace(/"/g,'""'),(t.journal||"").replace(/"/g,'""'),t.year||"",(t.tags||[]).join("; "),(t.abstract||"").replace(/"/g,'""'),(t.aiSummary||"").replace(/"/g,'""')])});const n=e.map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n"),a=new Blob([n],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(a),o=document.createElement("a");o.href=r,o.download="references-".concat(t||"all","-").concat((new Date).toISOString().split("T")[0],".csv"),o.click(),URL.revokeObjectURL(r)})(),te(!1)},children:"\ud83d\udcc4 CSV (spreadsheet)"}),(0,He.jsx)("button",{onClick:()=>{(()=>{const e={exportDate:(new Date).toISOString(),projectId:t,projectTitle:n,totalReferences:Z.length,references:Z},a=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(a),o=document.createElement("a");o.href=r,o.download="references-".concat(t||"all","-").concat((new Date).toISOString().split("T")[0],".json"),o.click(),URL.revokeObjectURL(r)})(),te(!1)},children:"\ud83d\udcbe JSON (backup)"}),(0,He.jsx)("button",{onClick:()=>{(()=>{const e=Z.map(e=>{const t="ref".concat(e.id),n=e.authors||"Unknown",a=e.title||"Untitled",r=e.journal||"",o=e.year||"",i=e.doi||"",l=e.pmid||"";return"@article{".concat(t,",\n  author = {").concat(n,"},\n  title = {").concat(a,"},\n  journal = {").concat(r,"},\n  year = {").concat(o,"},\n  doi = {").concat(i,"},\n  pmid = {").concat(l,"}\n}")}).join("\n\n"),n=new Blob([e],{type:"text/plain;charset=utf-8;"}),a=URL.createObjectURL(n),r=document.createElement("a");r.href=a,r.download="references-".concat(t||"all","-").concat((new Date).toISOString().split("T")[0],".bib"),r.click(),URL.revokeObjectURL(a)})(),te(!1)},children:"\ud83d\udcda BibTeX (citation)"})]})]})]}),v&&(0,He.jsxs)("div",{className:"add-ref-form",children:[(0,He.jsxs)("div",{className:"ref-form-header",children:[(0,He.jsx)("h3",{children:"Add Reference"}),(0,He.jsx)("button",{className:"close-btn",onClick:()=>{y(!1),H()},children:"\xd7"})]}),(0,He.jsxs)("div",{className:"pmid-lookup",children:[(0,He.jsx)("label",{children:"Lookup by PMID:"}),(0,He.jsxs)("div",{className:"pmid-input-row",children:[(0,He.jsx)("input",{type:"text",placeholder:"Enter PMID (e.g., 12345678)",value:B.pmid,onChange:e=>G(Je(Je({},B),{},{pmid:e.target.value}))}),(0,He.jsx)("button",{onClick:()=>(async e=>{if(e.trim()){C(!0),I({message:"Fetching from PubMed...",type:"info"});try{const t=await fetch("https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=pubmed&id=".concat(e,"&retmode=json")),n=await t.json();if(n.result&&n.result[e]){const t=n.result[e],a=t.authors?t.authors.map(e=>e.name).join(", "):"",r=t.pubdate?t.pubdate.split(" ")[0]:"";G(n=>{var o;return Je(Je({},n),{},{pmid:e,title:t.title||"",authors:a,journal:t.source||t.fulljournalname||"",year:r,volume:t.volume||"",pages:t.pages||"",doi:(null===(o=t.elocationid)||void 0===o?void 0:o.replace("doi: ",""))||""})});const o=await fetch("https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&id=".concat(e,"&rettype=abstract&retmode=text")),i=(await o.text()).match(/Abstract\n([\s\S]*?)(?=\n\n|$)/i);i&&G(e=>Je(Je({},e),{},{abstract:i[1].trim()})),I({message:"Article found!",type:"success"})}else I({message:"PMID not found",type:"error"})}catch(t){console.error("PubMed fetch error:",t),I({message:"Failed to fetch from PubMed",type:"error"})}C(!1),setTimeout(()=>I({message:"",type:""}),3e3)}})(B.pmid),disabled:N||!B.pmid.trim(),children:N?"Fetching...":"Fetch"})]})]}),(0,He.jsxs)("div",{className:"bulk-pmid-section",children:[(0,He.jsx)("label",{children:"Bulk Import (PMIDs & DOIs):"}),(0,He.jsx)("textarea",{className:"bulk-pmid-input",placeholder:"Enter PMIDs and/or DOIs (comma, space, or newline separated)\nExamples: 12345678, 10.1000/xyz123, 23456789",value:D,onChange:e=>T(e.target.value),rows:3,disabled:A.importing}),(0,He.jsxs)("div",{className:"bulk-import-actions",children:[(0,He.jsx)("button",{className:"btn-bulk-import",onClick:async()=>{if(!D.trim())return I({message:"Enter PMIDs or DOIs to import",type:"error"}),void setTimeout(()=>I({message:"",type:""}),3e3);const e=new Set(g.map(e=>e.pmid).filter(Boolean)),t=new Set(g.map(e=>e.doi).filter(Boolean));P({current:0,total:1,importing:!0}),I({message:"Fetching references...",type:"info"});try{const n=await ar(D),a=n.success.filter(n=>(!n.pmid||!e.has(n.pmid))&&(!n.doi||!t.has(n.doi))).map(e=>Je(Je({},e),{},{notes:"",tags:[],attachments:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()})),r=n.success.length-a.length;a.length>0&&q([...a,...g]),P({current:0,total:0,importing:!1}),T("");let o="";a.length>0&&(o="Imported ".concat(a.length," reference").concat(1!==a.length?"s":"")),r>0&&(o+=o?" (".concat(r," duplicate").concat(1!==r?"s":""," skipped)"):"".concat(r," duplicate").concat(1!==r?"s":""," skipped")),n.failed.length>0&&(o+=o?", ".concat(n.failed.length," failed"):"".concat(n.failed.length," failed"));const i=n.failed.length>0?"warning":a.length>0?"success":"info";I({message:o||"No new references to import",type:i}),setTimeout(()=>I({message:"",type:""}),4e3)}catch(n){console.error("Bulk import error:",n),P({current:0,total:0,importing:!1}),I({message:"Import failed: "+n.message,type:"error"}),setTimeout(()=>I({message:"",type:""}),4e3)}},disabled:A.importing||!D.trim(),children:A.importing?"Importing ".concat(A.current,"/").concat(A.total,"..."):"Import All"}),A.importing&&(0,He.jsx)("div",{className:"bulk-progress-bar",children:(0,He.jsx)("div",{className:"bulk-progress-fill",style:{width:"".concat(A.current/A.total*100,"%")}})})]})]}),(0,He.jsx)("div",{className:"ref-form-divider",children:(0,He.jsx)("span",{children:"or enter manually"})}),(0,He.jsxs)("div",{className:"ref-form-fields",children:[(0,He.jsxs)("div",{className:"ref-form-row",children:[(0,He.jsx)("label",{children:"Title *"}),(0,He.jsx)("input",{type:"text",value:B.title,onChange:e=>G(Je(Je({},B),{},{title:e.target.value})),placeholder:"Article title"})]}),(0,He.jsxs)("div",{className:"ref-form-row",children:[(0,He.jsx)("label",{children:"Authors"}),(0,He.jsx)("input",{type:"text",value:B.authors,onChange:e=>G(Je(Je({},B),{},{authors:e.target.value})),placeholder:"Smith J, Doe A, ..."})]}),(0,He.jsxs)("div",{className:"ref-form-row-split",children:[(0,He.jsxs)("div",{className:"ref-form-row",children:[(0,He.jsx)("label",{children:"Journal"}),(0,He.jsx)("input",{type:"text",value:B.journal,onChange:e=>G(Je(Je({},B),{},{journal:e.target.value})),placeholder:"Journal name"})]}),(0,He.jsxs)("div",{className:"ref-form-row",children:[(0,He.jsx)("label",{children:"Year"}),(0,He.jsx)("input",{type:"text",value:B.year,onChange:e=>G(Je(Je({},B),{},{year:e.target.value})),placeholder:"2024"})]})]}),(0,He.jsxs)("div",{className:"ref-form-row-split",children:[(0,He.jsxs)("div",{className:"ref-form-row",children:[(0,He.jsx)("label",{children:"Volume"}),(0,He.jsx)("input",{type:"text",value:B.volume,onChange:e=>G(Je(Je({},B),{},{volume:e.target.value})),placeholder:"12"})]}),(0,He.jsxs)("div",{className:"ref-form-row",children:[(0,He.jsx)("label",{children:"Pages"}),(0,He.jsx)("input",{type:"text",value:B.pages,onChange:e=>G(Je(Je({},B),{},{pages:e.target.value})),placeholder:"123-456"})]})]}),(0,He.jsxs)("div",{className:"ref-form-row",children:[(0,He.jsx)("label",{children:"DOI"}),(0,He.jsx)("input",{type:"text",value:B.doi,onChange:e=>G(Je(Je({},B),{},{doi:e.target.value})),placeholder:"10.1000/xyz123"})]}),(0,He.jsxs)("div",{className:"ref-form-row",children:[(0,He.jsx)("label",{children:"Abstract"}),(0,He.jsx)("textarea",{value:B.abstract,onChange:e=>G(Je(Je({},B),{},{abstract:e.target.value})),placeholder:"Article abstract...",rows:4})]}),(0,He.jsxs)("div",{className:"ref-form-row",children:[(0,He.jsx)("label",{children:"Notes"}),(0,He.jsx)(ua,{value:B.notes,onChange:e=>G(Je(Je({},B),{},{notes:e})),placeholder:"Your notes about this reference... (type @ for commands)",rows:3})]}),(0,He.jsxs)("div",{className:"ref-form-row",children:[(0,He.jsx)("label",{children:"Tags"}),(0,He.jsxs)("div",{className:"ref-tags-input",children:[(0,He.jsx)("input",{type:"text",value:W,onChange:e=>V(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),Q()),placeholder:"Add tag..."}),(0,He.jsx)("button",{onClick:Q,children:"+"})]}),B.tags.length>0&&(0,He.jsx)("div",{className:"ref-tags-list",children:B.tags.map(e=>(0,He.jsxs)("span",{className:"ref-tag",children:[e,(0,He.jsx)("button",{onClick:()=>G(Je(Je({},B),{},{tags:B.tags.filter(t=>t!==e)})),children:"x"})]},e))})]})]}),(0,He.jsxs)("div",{className:"ref-form-actions",children:[(0,He.jsx)("button",{className:"btn-cancel",onClick:()=>{y(!1),H()},children:"Cancel"}),(0,He.jsx)("button",{className:"btn-submit",onClick:()=>{if(!B.title.trim())return I({message:"Title is required",type:"error"}),void setTimeout(()=>I({message:"",type:""}),3e3);const e=Je(Je({id:"ref-".concat(Date.now())},B),{},{createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});q([e,...g]),H(),y(!1)},children:"Add Reference"})]})]}),(0,He.jsx)("div",{className:"references-list",children:0===Z.length?(0,He.jsxs)("div",{className:"references-empty",children:[(0,He.jsx)("p",{children:"No references yet."}),(0,He.jsx)("p",{className:"hint",children:"Add references by PMID or enter them manually."})]}):Z.map((e,a)=>{var r,o,i;return(0,He.jsxs)("div",{className:"reference-item ".concat((null===w||void 0===w?void 0:w.id)===e.id?"expanded":""),children:[(0,He.jsxs)("div",{className:"reference-main",onClick:()=>S((null===w||void 0===w?void 0:w.id)===e.id?null:e),children:[(0,He.jsxs)("div",{className:"reference-citation",children:[(0,He.jsxs)("span",{className:"reference-number",children:[a+1,"."]}),(0,He.jsx)("p",{className:"citation-text",children:$(e)})]}),(0,He.jsxs)("div",{className:"reference-badges",children:[e.pmid&&(0,He.jsx)("span",{className:"ref-badge pmid",children:"PMID"}),e.doi&&(0,He.jsx)("span",{className:"ref-badge doi",children:"DOI"}),null===(r=e.tags)||void 0===r?void 0:r.map(e=>(0,He.jsx)("span",{className:"ref-badge tag",children:e},e))]})]}),(null===w||void 0===w?void 0:w.id)===e.id&&(0,He.jsxs)("div",{className:"reference-expanded",children:[(0,He.jsxs)("div",{className:"reference-links",children:[e.pmid&&(0,He.jsx)("a",{href:(i=e.pmid,"https://pubmed.ncbi.nlm.nih.gov/".concat(i,"/")),target:"_blank",rel:"noopener noreferrer",className:"ref-link pubmed",children:"PubMed"}),(0,He.jsx)("a",{href:Y(e),target:"_blank",rel:"noopener noreferrer",className:"ref-link scholar",children:"Google Scholar"}),e.doi&&(0,He.jsxs)("a",{href:(o=e.doi,"https://doi.org/".concat(o)),target:"_blank",rel:"noopener noreferrer",className:"ref-link doi",children:["DOI: ",e.doi]})]}),e.abstract&&(0,He.jsxs)("div",{className:"reference-abstract",children:[(0,He.jsx)("h4",{children:"Abstract"}),(0,He.jsx)("p",{children:e.abstract})]}),(0,He.jsxs)("div",{className:"reference-ai-summary",children:[(0,He.jsx)("h4",{children:"AI Summary"}),e.aiSummary?(0,He.jsxs)("div",{className:"ai-summary-content",children:[(0,He.jsx)("p",{className:"ai-summary-text",children:e.aiSummary.summary}),e.aiSummary.keyFindings&&e.aiSummary.keyFindings.length>0&&(0,He.jsxs)("div",{className:"ai-key-findings",children:[(0,He.jsx)("strong",{children:"Key Findings:"}),(0,He.jsx)("ul",{children:e.aiSummary.keyFindings.map((e,t)=>(0,He.jsx)("li",{children:e},t))})]}),(0,He.jsxs)("div",{className:"ai-summary-meta",children:[(0,He.jsxs)("span",{children:["Generated ",new Date(e.aiSummary.generatedAt).toLocaleDateString(),e.aiSummary.provider&&" with ".concat(Vt[e.aiSummary.provider]||e.aiSummary.provider)]}),(0,He.jsxs)("div",{className:"regenerate-group",children:[(0,He.jsx)("select",{className:"provider-select-small",value:F,onChange:e=>U(e.target.value),disabled:O===e.id,children:Object.values(Wt).filter(e=>{var t;return null===(t=qt[e])||void 0===t?void 0:t.summarization}).map(e=>(0,He.jsx)("option",{value:e,disabled:!c(e),children:Vt[e]},e))}),(0,He.jsx)("button",{className:"btn-regenerate",onClick:()=>J(e.id,F),disabled:O===e.id||!c(F),children:O===e.id?"Regenerating...":"Regenerate"})]})]})]}):(0,He.jsx)("div",{className:"ai-summary-empty",children:e.abstract?(0,He.jsxs)("div",{className:"generate-summary-group",children:[(0,He.jsx)("select",{className:"provider-select-small",value:F,onChange:e=>U(e.target.value),disabled:O===e.id,children:Object.values(Wt).filter(e=>{var t;return null===(t=qt[e])||void 0===t?void 0:t.summarization}).map(e=>(0,He.jsx)("option",{value:e,disabled:!c(e),children:Vt[e]},e))}),(0,He.jsx)("button",{className:"btn-summarize",onClick:()=>J(e.id,F),disabled:O===e.id||!c(F),children:O===e.id?"Generating...":"Generate Summary"})]}):(0,He.jsx)("p",{className:"no-abstract-hint",children:"Add an abstract to enable AI summarization"})})]}),(0,He.jsxs)("div",{className:"reference-notes",children:[(0,He.jsx)("h4",{children:"Notes"}),(0,He.jsx)(ua,{value:e.notes||"",onChange:t=>K(e.id,{notes:t}),placeholder:"Add your notes... (type @ for commands)",rows:3})]}),(0,He.jsxs)("div",{className:"reference-attachments",children:[(0,He.jsx)("h4",{children:"Attachments"}),(0,He.jsx)(Wa,{attachments:e.attachments||[],onUpdate:t=>K(e.id,{attachments:t}),acceptedTypes:["application/pdf","image/*","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],maxFiles:5})]}),(0,He.jsxs)("div",{className:"reference-actions",children:[(0,He.jsx)("button",{className:"btn-action copy",onClick:()=>{navigator.clipboard.writeText("".concat(a+1,". ").concat($(e))),I({message:"Citation copied!",type:"success"}),setTimeout(()=>I({message:"",type:""}),2e3)},children:"Copy Citation"}),(0,He.jsx)("button",{className:"btn-action danger",onClick:()=>(e=>{const a=g.find(t=>t.id===e);if(!a)return;m(Rn.REFERENCE,a,{projectId:t,projectTitle:n});const r=g.filter(t=>t.id!==e);q(r),(null===w||void 0===w?void 0:w.id)===e&&S(null),h('"'.concat(a.title||"Reference",'" moved to trash'))})(e.id),children:"Delete"})]})]})]},e.id)})}),(0,He.jsxs)("div",{className:"references-count",children:[Z.length," reference",1!==Z.length?"s":"","all"!==k&&' tagged "'.concat(k,'"')]})]})},gr="research-dashboard-research-notes";const fr=function(e){let{projectId:t,projectTitle:n}=e;const{isSignedIn:a,createDoc:r,syncToDoc:o,importFromDoc:i}=lt(),s=St(),{moveToTrash:c}=Fn(),{showSuccess:d}=vt(),[u,p]=(0,l.useState)("background"),[m,h]=(0,l.useState)({background:"",backgroundGoogleDocId:null,backgroundGoogleDocUrl:null,specificAims:[],miscNotes:[]}),[g,f]=(0,l.useState)(null),[v,y]=(0,l.useState)(""),[b,x]=(0,l.useState)([]),[k,j]=(0,l.useState)({message:"",type:""});(0,l.useEffect)(()=>{const e=localStorage.getItem(gr);if(e)try{const n=JSON.parse(e);n[t]&&h(n[t])}catch(Fr){console.error("Failed to load research notes:",Fr)}},[t]);const w=(0,l.useCallback)(e=>{const n=localStorage.getItem(gr);let a={};if(n)try{a=JSON.parse(n)}catch(Fr){a={}}a[t]=e,localStorage.setItem(gr,JSON.stringify(a)),h(e),s()},[t,s]),S=(e,t,n)=>{const a=m.specificAims.map(a=>a.id===e?Je(Je({},a),{},{[t]:n}):a);w(Je(Je({},m),{},{specificAims:a}))},N=(e,t)=>{const n=m.miscNotes.map(n=>n.id===e?Je(Je(Je({},n),t),{},{updatedAt:(new Date).toISOString()}):n);w(Je(Je({},m),{},{miscNotes:n}))},C=[{id:"general",label:"General",color:"#888"},{id:"idea",label:"Ideas",color:"#f1c40f"},{id:"question",label:"Questions",color:"#3498db"},{id:"reference",label:"References",color:"#9b59b6"},{id:"meeting",label:"Meeting Notes",color:"#27ae60"},{id:"todo",label:"To-Do",color:"#e74c3c"}],E=[{id:"planned",label:"Planned",color:"#888"},{id:"in-progress",label:"In Progress",color:"#3498db"},{id:"completed",label:"Completed",color:"#27ae60"}];return(0,He.jsxs)("div",{className:"research-notes",children:[(0,He.jsx)("div",{className:"google-status-indicator",children:a?(0,He.jsx)("span",{className:"google-status-text connected",children:"Google Connected"}):(0,He.jsx)("span",{className:"google-status-text",children:"Sign in via navbar for Google Docs"})}),k.message&&(0,He.jsxs)("div",{className:"sync-status-bar ".concat(k.type),children:[k.message,(0,He.jsx)("button",{onClick:()=>j({message:"",type:""}),children:"x"})]}),(0,He.jsxs)("div",{className:"notes-tabs",children:[(0,He.jsx)("button",{className:"notes-tab ".concat("background"===u?"active":""),onClick:()=>p("background"),children:"Research Background"}),(0,He.jsxs)("button",{className:"notes-tab ".concat("aims"===u?"active":""),onClick:()=>p("aims"),children:["Specific Aims (",m.specificAims.length,")"]}),(0,He.jsxs)("button",{className:"notes-tab ".concat("misc"===u?"active":""),onClick:()=>p("misc"),children:["Miscellaneous Notes (",m.miscNotes.length,")"]}),(0,He.jsx)("button",{className:"notes-tab ".concat("literature"===u?"active":""),onClick:()=>p("literature"),children:"\ud83d\udcda Literature"})]}),(0,He.jsxs)("div",{className:"notes-content",children:["background"===u&&(0,He.jsxs)("div",{className:"background-section",children:[(0,He.jsxs)("div",{className:"section-header",children:[(0,He.jsxs)("h3",{children:["Research Background",m.backgroundGoogleDocId&&(0,He.jsx)("span",{className:"google-doc-indicator",title:"Linked to Google Doc",children:"\ud83d\udcc4"})]}),(0,He.jsxs)("div",{className:"section-actions",children:["background"!==g&&(0,He.jsx)("button",{className:"edit-btn",onClick:()=>{f("background"),y(m.background),x(m.backgroundAttachments||[])},children:"Edit"}),a&&m.background&&(m.backgroundGoogleDocId?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("a",{href:m.backgroundGoogleDocUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-google-action",children:"Open Doc"}),(0,He.jsx)("button",{className:"btn-google-action",onClick:async()=>{if(!m.backgroundGoogleDocId)return;const e="Research Background\nProject: ".concat(n,"\n\n---\n\n").concat(m.background||"No background content yet.","\n\n---\nLast Updated: ").concat((new Date).toLocaleString());await o(m.backgroundGoogleDocId,e)},children:"Push"}),(0,He.jsx)("button",{className:"btn-google-action",onClick:async()=>{if(!m.backgroundGoogleDocId)return;j({message:"Importing from Google Doc...",type:"info"});const e=await i(m.backgroundGoogleDocId);if(e){let t=e.content;const n=t.indexOf("---"),a=t.lastIndexOf("---");-1!==n&&-1!==a&&n!==a&&(t=t.substring(n+3,a).trim()),w(Je(Je({},m),{},{background:t})),j({message:"Imported from Google Doc!",type:"success"})}else j({message:"Failed to import",type:"error"});setTimeout(()=>j({message:"",type:""}),3e3)},children:"Pull"})]}):(0,He.jsx)("button",{className:"btn-google-action primary",onClick:async()=>{const e="[Research Background] ".concat(n),t="Research Background\nProject: ".concat(n,"\n\n---\n\n").concat(m.background||"No background content yet.","\n\n---\nLast Updated: ").concat((new Date).toLocaleString()),a=await r(e,t);a&&(w(Je(Je({},m),{},{backgroundGoogleDocId:a.docId,backgroundGoogleDocUrl:a.docUrl})),window.open(a.docUrl,"_blank"))},children:"Create Doc"}))]})]}),"background"===g?(0,He.jsxs)("div",{className:"background-editor",children:[(0,He.jsx)(ya,{value:v,onChange:e=>y(e.target.value),attachments:b,onAttachmentsChange:x,variant:"citable",projectId:t,projectName:n,placeholder:"Enter research background, context, and significance...\r Include:\r\n- Scientific context and rationale\r\n- Current state of knowledge\r\n- Gap in existing research\r\n- Significance and innovation\r\n- Preliminary data (if any)\r Type @cite: or [@ to insert citations. Drag files to upload.",rows:15}),(0,He.jsxs)("div",{className:"editor-actions",children:[(0,He.jsx)("button",{className:"btn-cancel",onClick:()=>{f(null),y(""),x([])},children:"Cancel"}),(0,He.jsx)("button",{className:"btn-submit",onClick:()=>{w(Je(Je({},m),{},{background:v,backgroundAttachments:b})),f(null),y(""),x([])},children:"Save"})]})]}):(0,He.jsx)("div",{className:"background-display",children:m.background?(0,He.jsx)("div",{className:"background-text",children:m.background}):(0,He.jsxs)("div",{className:"empty-state",children:[(0,He.jsx)("p",{children:"No research background added yet."}),(0,He.jsx)("p",{className:"hint",children:"Add context, rationale, and significance for your research project."})]})})]}),"aims"===u&&(0,He.jsxs)("div",{className:"aims-section",children:[(0,He.jsxs)("div",{className:"section-header",children:[(0,He.jsx)("h3",{children:"Specific Aims"}),(0,He.jsx)("button",{className:"add-btn",onClick:()=>{const e={id:Date.now(),title:"",content:"",status:"planned",googleDocId:null,googleDocUrl:null};w(Je(Je({},m),{},{specificAims:[...m.specificAims,e]})),f("aim-".concat(e.id)),y(e)},children:"+ Add Aim"})]}),0===m.specificAims.length?(0,He.jsxs)("div",{className:"empty-state",children:[(0,He.jsx)("p",{children:"No specific aims defined yet."}),(0,He.jsx)("p",{className:"hint",children:"Define clear, measurable objectives for your research project."})]}):(0,He.jsx)("div",{className:"aims-list",children:m.specificAims.map((e,l)=>(0,He.jsxs)("div",{className:"aim-card",children:[(0,He.jsxs)("div",{className:"aim-header",children:[(0,He.jsxs)("span",{className:"aim-number",children:["Aim ",l+1,e.googleDocId&&(0,He.jsx)("span",{className:"google-doc-indicator",title:"Linked to Google Doc",children:"\ud83d\udcc4"})]}),(0,He.jsxs)("div",{className:"aim-header-actions",children:[(0,He.jsx)("select",{className:"aim-status ".concat(e.status),value:e.status,onChange:t=>S(e.id,"status",t.target.value),children:E.map(e=>(0,He.jsx)("option",{value:e.id,children:e.label},e.id))}),a&&(e.googleDocId?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("a",{href:e.googleDocUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-google-action small",title:"Open Doc",children:"\ud83d\udcc4"}),(0,He.jsx)("button",{className:"btn-google-action small",onClick:()=>(async(e,t)=>{if(!e.googleDocId)return;const a="Specific Aim ".concat(t+1,": ").concat(e.title||"Untitled","\nProject: ").concat(n,"\nStatus: ").concat(e.status,"\n\n---\n\n").concat(e.content||e.description||"No details yet.","\n\n---\nLast Updated: ").concat((new Date).toLocaleString());await o(e.googleDocId,a)})(e,l),title:"Push to Doc",children:"\u2b06"}),(0,He.jsx)("button",{className:"btn-google-action small",onClick:()=>(async e=>{if(!e.googleDocId)return;j({message:"Importing from Google Doc...",type:"info"});const t=await i(e.googleDocId);if(t){let n=t.content;const a=n.indexOf("---"),r=n.lastIndexOf("---");if(-1!==a&&-1!==r&&a!==r){const t=n.substring(a+3,r),o=t.match(/DESCRIPTION:\n([\s\S]*?)(?=\n[A-Z]+:|$)/),i=t.match(/RATIONALE:\n([\s\S]*?)(?=\n[A-Z]+:|$)/),l=t.match(/HYPOTHESIS:\n([\s\S]*?)(?=\n[A-Z]+:|$)/),s=t.match(/EXPERIMENTAL APPROACH:\n([\s\S]*?)(?=\n[A-Z]+:|$)/),c=t.match(/EXPECTED OUTCOMES:\n([\s\S]*?)(?=\n[A-Z]+:|$)/);o&&S(e.id,"description",o[1].trim()),i&&S(e.id,"rationale",i[1].trim()),l&&S(e.id,"hypothesis",l[1].trim()),s&&S(e.id,"approach",s[1].trim()),c&&S(e.id,"expectedOutcomes",c[1].trim())}j({message:"Imported from Google Doc!",type:"success"})}else j({message:"Failed to import",type:"error"});setTimeout(()=>j({message:"",type:""}),3e3)})(e),title:"Pull from Doc",children:"\u2b07"})]}):(0,He.jsx)("button",{className:"btn-google-action small primary",onClick:()=>(async(e,t)=>{const a="[Specific Aim ".concat(t+1,"] ").concat(e.title||"Untitled"," - ").concat(n),o="Specific Aim ".concat(t+1,": ").concat(e.title||"Untitled","\nProject: ").concat(n,"\nStatus: ").concat(e.status,"\n\n---\n\n").concat(e.content||e.description||"No details yet.","\n\n---\nLast Updated: ").concat((new Date).toLocaleString()),i=await r(a,o);i&&(S(e.id,"googleDocId",i.docId),S(e.id,"googleDocUrl",i.docUrl),window.open(i.docUrl,"_blank"))})(e,l),title:"Create Doc",children:"\ud83d\udcdd"})),(0,He.jsx)("button",{className:"delete-aim-btn",onClick:()=>(e=>{const a=m.specificAims.find(t=>t.id===e);if(!a)return;c(Rn.NOTE,Je(Je({},a),{},{noteType:"specificAim"}),{projectId:t,projectTitle:n});const r=m.specificAims.filter(t=>t.id!==e);w(Je(Je({},m),{},{specificAims:r})),d('"'.concat(a.title||"Specific Aim",'" moved to trash'))})(e.id),children:"x"})]})]}),(0,He.jsxs)("div",{className:"aim-field",children:[(0,He.jsx)("label",{children:"Title"}),(0,He.jsx)("input",{type:"text",value:e.title,onChange:t=>S(e.id,"title",t.target.value),placeholder:"Brief title for this aim..."})]}),(0,He.jsxs)("div",{className:"aim-field",children:[(0,He.jsx)("label",{children:"Details"}),(0,He.jsx)(ya,{value:e.content||e.description||"",onChange:t=>S(e.id,"content",t.target.value),attachments:e.attachments||[],onAttachmentsChange:t=>S(e.id,"attachments",t),variant:"citable",projectId:t,projectName:n,placeholder:"Describe your specific aim including hypothesis, approach, and expected outcomes... (Type @cite: to add citations, drag files to upload)",rows:8})]})]},e.id))})]}),"misc"===u&&(0,He.jsxs)("div",{className:"misc-section",children:[(0,He.jsxs)("div",{className:"section-header",children:[(0,He.jsx)("h3",{children:"Miscellaneous Notes"}),(0,He.jsx)("button",{className:"add-btn",onClick:()=>{const e={id:Date.now(),title:"New Note",content:"",category:"general",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),googleDocId:null,googleDocUrl:null};w(Je(Je({},m),{},{miscNotes:[...m.miscNotes,e]})),f("note-".concat(e.id))},children:"+ Add Note"})]}),0===m.miscNotes.length?(0,He.jsxs)("div",{className:"empty-state",children:[(0,He.jsx)("p",{children:"No notes added yet."}),(0,He.jsx)("p",{className:"hint",children:"Add ideas, questions, meeting notes, or any other relevant information."})]}):(0,He.jsx)("div",{className:"notes-grid",children:m.miscNotes.map(e=>{var l;return(0,He.jsxs)("div",{className:"note-card",children:[(0,He.jsxs)("div",{className:"note-header",children:[(0,He.jsx)("select",{className:"note-category",value:e.category,onChange:t=>N(e.id,{category:t.target.value}),style:{borderColor:null===(l=C.find(t=>t.id===e.category))||void 0===l?void 0:l.color},children:C.map(e=>(0,He.jsx)("option",{value:e.id,children:e.label},e.id))}),(0,He.jsxs)("div",{className:"note-header-actions",children:[e.googleDocId&&(0,He.jsx)("span",{className:"google-doc-indicator",title:"Linked to Google Doc",children:"\ud83d\udcc4"}),(0,He.jsx)("button",{className:"delete-note-btn",onClick:()=>(e=>{const a=m.miscNotes.find(t=>t.id===e);if(!a)return;c(Rn.NOTE,Je(Je({},a),{},{noteType:"miscNote"}),{projectId:t,projectTitle:n});const r=m.miscNotes.filter(t=>t.id!==e);w(Je(Je({},m),{},{miscNotes:r})),d('"'.concat(a.title||"Note",'" moved to trash'))})(e.id),children:"x"})]})]}),(0,He.jsx)("input",{type:"text",className:"note-title",value:e.title,onChange:t=>N(e.id,{title:t.target.value}),placeholder:"Note title..."}),(0,He.jsx)(ya,{className:"note-content",value:e.content,onChange:t=>N(e.id,{content:t.target.value}),attachments:e.attachments||[],onAttachmentsChange:t=>N(e.id,{attachments:t}),variant:"citable",projectId:t,projectName:n,placeholder:"Write your note here... (Type @cite: to add citations, drag files to upload)",rows:4}),(0,He.jsxs)("div",{className:"note-footer",children:[(0,He.jsxs)("span",{className:"note-date",children:["Updated: ",new Date(e.updatedAt).toLocaleDateString()]}),a&&(0,He.jsx)("div",{className:"note-google-actions",children:e.googleDocId?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("a",{href:e.googleDocUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-google-action small",title:"Open Doc",children:"\ud83d\udcc4"}),(0,He.jsx)("button",{className:"btn-google-action small",onClick:()=>(async e=>{var t;if(!e.googleDocId)return;const a="Note: ".concat(e.title,"\nProject: ").concat(n,"\nCategory: ").concat((null===(t=C.find(t=>t.id===e.category))||void 0===t?void 0:t.label)||e.category,"\n\n---\n\n").concat(e.content||"No content yet.","\n\n---\nCreated: ").concat(new Date(e.createdAt).toLocaleString(),"\nLast Updated: ").concat((new Date).toLocaleString());await o(e.googleDocId,a)})(e),title:"Push to Doc",children:"\u2b06"}),(0,He.jsx)("button",{className:"btn-google-action small",onClick:()=>(async e=>{if(!e.googleDocId)return;j({message:"Importing from Google Doc...",type:"info"});const t=await i(e.googleDocId);if(t){let n=t.content;const a=n.indexOf("---"),r=n.lastIndexOf("---");-1!==a&&-1!==r&&a!==r&&(n=n.substring(a+3,r).trim()),N(e.id,{content:n}),j({message:"Imported from Google Doc!",type:"success"})}else j({message:"Failed to import",type:"error"});setTimeout(()=>j({message:"",type:""}),3e3)})(e),title:"Pull from Doc",children:"\u2b07"})]}):(0,He.jsx)("button",{className:"btn-google-action small primary",onClick:()=>(async e=>{var t;const a="[Note] ".concat(e.title," - ").concat(n),o="Note: ".concat(e.title,"\nProject: ").concat(n,"\nCategory: ").concat((null===(t=C.find(t=>t.id===e.category))||void 0===t?void 0:t.label)||e.category,"\n\n---\n\n").concat(e.content||"No content yet.","\n\n---\nCreated: ").concat(new Date(e.createdAt).toLocaleString(),"\nLast Updated: ").concat((new Date).toLocaleString()),i=await r(a,o);i&&(N(e.id,{googleDocId:i.docId,googleDocUrl:i.docUrl}),window.open(i.docUrl,"_blank"))})(e),title:"Create Doc",children:"\ud83d\udcdd"})})]})]},e.id)})})]}),"literature"===u&&(0,He.jsx)(hr,{projectId:t,projectTitle:n})]})]})},vr="research-dashboard-lab-notebook";const yr=function(e){let{projectId:t,projectTitle:n}=e;const{isSignedIn:a,createDoc:r,syncToDoc:o,importFromDoc:i,createSheet:s,syncToSheet:c,importFromSheet:d}=lt(),u=St(),{moveToTrash:p}=Fn(),{showSuccess:m}=vt(),[h,g]=(0,l.useState)([]),[f,v]=(0,l.useState)(!1),[y,b]=(0,l.useState)({title:"",content:"",tags:[n]}),[x,k]=(0,l.useState)(""),[j,w]=(0,l.useState)(""),[S,N]=(0,l.useState)(null),[C,E]=(0,l.useState)({message:"",type:""}),I=e=>{var a;if(e.projectId===t)return!0;const r=n.toLowerCase(),o=t.toLowerCase();return null===(a=e.tags)||void 0===a?void 0:a.some(e=>{const t=e.toLowerCase();return t===r||t===o||r.includes(t)||t.includes(r)})};(0,l.useEffect)(()=>{const e=localStorage.getItem(vr);if(e)try{const t=JSON.parse(e).filter(I);g(t)}catch(Fr){console.error("Failed to load notebook entries:",Fr)}},[t,n]);const D=(0,l.useCallback)(e=>{try{const t=localStorage.getItem(vr);let n=t?JSON.parse(t):[];const a=new Set(e.map(e=>e.id));n=n.filter(e=>!I(e)||a.has(e.id));const r=new Set(n.map(e=>e.id)),o=e.filter(e=>!r.has(e.id));n=n.map(t=>e.find(e=>e.id===t.id)||t),n=[...o,...n],localStorage.setItem(vr,JSON.stringify(n)),g(e),u()}catch(Fr){console.error("Failed to save notebook entries:",Fr)}},[u]),T=e=>new Date(e).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),A=e=>{const t=new Date(e),n=new Date,a=new Date(n);return a.setDate(a.getDate()-1),t.toDateString()===n.toDateString()?"Today":t.toDateString()===a.toDateString()?"Yesterday":t.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},P=(e,t)=>{const n=h.map(n=>n.id===e?Je(Je(Je({},n),t),{},{updatedAt:(new Date).toISOString()}):n);D(n),(null===S||void 0===S?void 0:S.id)===e&&N(Je(Je({},S),t))},O=()=>{x.trim()&&!y.tags.includes(x.trim())&&(b(Je(Je({},y),{},{tags:[...y.tags,x.trim()]})),k(""))},L=h.filter(e=>!j||e.title.toLowerCase().includes(j.toLowerCase())||e.content.toLowerCase().includes(j.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(j.toLowerCase()))).reduce((e,t)=>{const n=new Date(t.createdAt).toDateString();return e[n]||(e[n]=[]),e[n].push(t),e},{});return(0,He.jsxs)("div",{className:"project-lab-notebook",children:[(0,He.jsx)("div",{className:"google-status-indicator",children:a?(0,He.jsx)("span",{className:"google-status-text connected",children:"Google Connected"}):(0,He.jsx)("span",{className:"google-status-text",children:"Sign in via navbar for Google Docs/Sheets"})}),C.message&&(0,He.jsxs)("div",{className:"sync-status-bar ".concat(C.type),children:[C.message,(0,He.jsx)("button",{onClick:()=>E({message:"",type:""}),children:"x"})]}),(0,He.jsxs)("div",{className:"notebook-toolbar inline",children:[(0,He.jsx)("button",{className:"new-entry-btn",onClick:()=>v(!0),children:"+ New Entry"}),(0,He.jsx)("input",{type:"text",className:"notebook-search",placeholder:"Search entries...",value:j,onChange:e=>w(e.target.value)})]}),f&&(0,He.jsxs)("div",{className:"new-entry-form inline",children:[(0,He.jsx)("input",{type:"text",className:"entry-title-input",placeholder:"Entry title...",value:y.title,onChange:e=>b(Je(Je({},y),{},{title:e.target.value})),autoFocus:!0}),(0,He.jsx)(ua,{className:"entry-content-input",placeholder:"Write your lab notes here... (type @ for commands)",value:y.content,onChange:e=>b(Je(Je({},y),{},{content:e})),rows:6,projectName:n}),(0,He.jsx)("div",{className:"entry-meta-row",children:(0,He.jsxs)("div",{className:"entry-tags-input",children:[(0,He.jsx)("input",{type:"text",placeholder:"Add tag...",value:x,onChange:e=>k(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),O())}),(0,He.jsx)("button",{onClick:O,children:"+"})]})}),y.tags.length>0&&(0,He.jsx)("div",{className:"entry-tags",children:y.tags.map(e=>(0,He.jsxs)("span",{className:"entry-tag",children:[e,(0,He.jsx)("button",{onClick:()=>b(Je(Je({},y),{},{tags:y.tags.filter(t=>t!==e)})),children:"x"})]},e))}),(0,He.jsxs)("div",{className:"entry-form-actions",children:[(0,He.jsx)("button",{className:"btn-cancel",onClick:()=>{v(!1),b({title:"",content:"",tags:[n]})},children:"Cancel"}),(0,He.jsx)("button",{className:"btn-submit",onClick:()=>{if(!y.title.trim()&&!y.content.trim())return;const e={id:"entry-".concat(Date.now()),title:y.title.trim()||"Untitled Entry",content:y.content,projectId:t,tags:y.tags,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),googleDocId:null,googleDocUrl:null,googleSheetId:null,googleSheetUrl:null};D([e,...h]),b({title:"",content:"",tags:[n]}),v(!1)},children:"Save Entry"})]})]}),(0,He.jsx)("div",{className:"notebook-entries inline",children:0===Object.keys(L).length?(0,He.jsxs)("div",{className:"notebook-empty",children:[(0,He.jsx)("p",{children:"No notebook entries for this project yet."}),(0,He.jsx)("p",{className:"hint",children:'Start documenting your research by clicking "+ New Entry"'})]}):Object.entries(L).map(e=>{let[l,u]=e;return(0,He.jsxs)("div",{className:"notebook-day-group",children:[(0,He.jsx)("h3",{className:"day-header",children:A(u[0].createdAt)}),u.map(e=>(0,He.jsxs)("div",{className:"notebook-entry ".concat((null===S||void 0===S?void 0:S.id)===e.id?"selected":""),children:[(0,He.jsxs)("div",{className:"entry-main",onClick:()=>N((null===S||void 0===S?void 0:S.id)===e.id?null:e),children:[(0,He.jsxs)("div",{className:"entry-header",children:[(0,He.jsx)("span",{className:"entry-time",children:new Date(e.createdAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}),e.googleDocId&&(0,He.jsx)("span",{className:"google-doc-badge",title:"Linked to Google Doc",children:"G"}),e.googleSheetId&&(0,He.jsx)("span",{className:"google-sheet-badge",title:"Linked to Google Sheet",children:"S"})]}),(0,He.jsx)("h4",{className:"entry-title",children:e.title}),(0,He.jsxs)("p",{className:"entry-preview",children:[e.content.slice(0,150),e.content.length>150&&"..."]}),e.tags.length>0&&(0,He.jsx)("div",{className:"entry-tags-display",children:e.tags.map(e=>(0,He.jsx)("span",{className:"entry-tag-badge",children:e},e))})]}),(null===S||void 0===S?void 0:S.id)===e.id&&(0,He.jsxs)("div",{className:"entry-expanded",children:[(0,He.jsx)("div",{className:"entry-full-content",children:(0,He.jsx)(ua,{value:e.content,onChange:t=>P(e.id,{content:t}),rows:10,projectName:n})}),(0,He.jsxs)("div",{className:"entry-actions",children:[a&&(0,He.jsxs)(He.Fragment,{children:[(0,He.jsxs)("div",{className:"google-actions-row",children:[(0,He.jsx)("span",{className:"google-action-label",children:"Docs:"}),e.googleDocId?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("a",{href:e.googleDocUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-action small",children:"Open"}),(0,He.jsx)("button",{className:"btn-action small",onClick:()=>(async e=>{if(!e.googleDocId)return;E({message:"Syncing to Google Doc...",type:"info"});const t="Lab Notebook Entry\n\nTitle: ".concat(e.title,"\nDate: ").concat(T(e.createdAt),"\nLast Updated: ").concat(T(e.updatedAt),"\nProject: ").concat(n,"\nTags: ").concat(e.tags.join(", ")||"None","\n\n---\n\n").concat(e.content),a=await o(e.googleDocId,t);E(a?{message:"Synced to Google Doc!",type:"success"}:{message:"Failed to sync",type:"error"}),setTimeout(()=>E({message:"",type:""}),3e3)})(e),title:"Push to Google Doc",children:"\u2b06"}),(0,He.jsx)("button",{className:"btn-action small",onClick:()=>(async e=>{if(!e.googleDocId)return;E({message:"Importing from Google Doc...",type:"info"});const t=await i(e.googleDocId);if(t){let n=t.content;const a=n.indexOf("---");-1!==a&&(n=n.substring(a+3).trim()),P(e.id,{content:n}),E({message:"Imported from Google Doc!",type:"success"})}else E({message:"Failed to import",type:"error"});setTimeout(()=>E({message:"",type:""}),3e3)})(e),title:"Pull from Google Doc",children:"\u2b07"})]}):(0,He.jsx)("button",{className:"btn-action small primary",onClick:()=>(async e=>{if(!a)return E({message:"Please sign in to Google first",type:"error"}),void setTimeout(()=>E({message:"",type:""}),3e3);E({message:"Creating Google Doc...",type:"info"});const t="Lab Notebook Entry\n\nTitle: ".concat(e.title,"\nDate: ").concat(T(e.createdAt),"\nProject: ").concat(n,"\nTags: ").concat(e.tags.join(", ")||"None","\n\n---\n\n").concat(e.content),o=await r("[Lab Notebook] ".concat(e.title),t);o?(P(e.id,{googleDocId:o.docId,googleDocUrl:o.docUrl}),E({message:"Google Doc created!",type:"success"}),window.open(o.docUrl,"_blank")):E({message:"Failed to create Google Doc",type:"error"}),setTimeout(()=>E({message:"",type:""}),3e3)})(e),children:"+ Create"})]}),(0,He.jsxs)("div",{className:"google-actions-row",children:[(0,He.jsx)("span",{className:"google-action-label",children:"Sheets:"}),e.googleSheetId?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("a",{href:e.googleSheetUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-action small",children:"Open"}),(0,He.jsx)("button",{className:"btn-action small",onClick:()=>(async e=>{if(!e.googleSheetId)return;E({message:"Syncing to Google Sheet...",type:"info"});const t=[["Title",e.title],["Date",T(e.createdAt)],["Project",n],["Tags",e.tags.join(", ")||"None"],["Content",e.content],["Last Updated",T(e.updatedAt)]],a=await c(e.googleSheetId,["Field","Value"],t);E(a?{message:"Synced to Google Sheet!",type:"success"}:{message:"Failed to sync",type:"error"}),setTimeout(()=>E({message:"",type:""}),3e3)})(e),title:"Push to Google Sheet",children:"\u2b06"}),(0,He.jsx)("button",{className:"btn-action small",onClick:()=>(async e=>{if(!e.googleSheetId)return;E({message:"Importing from Google Sheet...",type:"info"});const t=await d(e.googleSheetId);if(t&&t.data){const n={};t.data.forEach(e=>{var t;const a=null===(t=e[0])||void 0===t?void 0:t.toLowerCase(),r=e[1]||"";"content"===a&&(n.content=r),"tags"===a&&(n.tags=r.split(",").map(e=>e.trim()).filter(Boolean))}),Object.keys(n).length>0&&P(e.id,n),E({message:"Imported from Google Sheet!",type:"success"})}else E({message:"Failed to import",type:"error"});setTimeout(()=>E({message:"",type:""}),3e3)})(e),title:"Pull from Google Sheet",children:"\u2b07"})]}):(0,He.jsx)("button",{className:"btn-action small primary",onClick:()=>(async e=>{if(!a)return E({message:"Please sign in to Google first",type:"error"}),void setTimeout(()=>E({message:"",type:""}),3e3);E({message:"Creating Google Sheet...",type:"info"});const t=[["Title",e.title],["Date",T(e.createdAt)],["Project",n],["Tags",e.tags.join(", ")||"None"],["Content",e.content],["Last Updated",T(e.updatedAt)]],r=await s("[Lab Notebook] ".concat(e.title),["Field","Value"],t);r?(P(e.id,{googleSheetId:r.spreadsheetId,googleSheetUrl:r.sheetUrl}),E({message:"Google Sheet created!",type:"success"}),window.open(r.sheetUrl,"_blank")):E({message:"Failed to create Google Sheet",type:"error"}),setTimeout(()=>E({message:"",type:""}),3e3)})(e),children:"+ Create"})]})]}),(0,He.jsx)("button",{className:"btn-action danger",onClick:()=>(e=>{const a=h.find(t=>t.id===e);if(!a)return;p(Rn.NOTEBOOK_ENTRY,a,{projectId:t,projectTitle:n});const r=h.filter(t=>t.id!==e);D(r),(null===S||void 0===S?void 0:S.id)===e&&N(null),m('"'.concat(a.title||"Notebook entry",'" moved to trash'))})(e.id),children:"Delete"})]}),(0,He.jsxs)("div",{className:"entry-meta-info",children:[(0,He.jsxs)("span",{children:["Created: ",T(e.createdAt)]}),e.updatedAt!==e.createdAt&&(0,He.jsxs)("span",{children:["Updated: ",T(e.updatedAt)]})]})]})]},e.id))]},l)})})]})},br="research-dashboard-recurring-tasks",xr=[{id:"daily",label:"Daily",days:1},{id:"weekly",label:"Weekly",days:7},{id:"biweekly",label:"Bi-weekly",days:14},{id:"monthly",label:"Monthly",days:30}],kr=[{id:0,label:"Sunday"},{id:1,label:"Monday"},{id:2,label:"Tuesday"},{id:3,label:"Wednesday"},{id:4,label:"Thursday"},{id:5,label:"Friday"},{id:6,label:"Saturday"}];const jr=function(e){let{projectId:t,projectTitle:n,onCreateTask:a,isOpen:r,onClose:o}=e;const i=St(),[s,c]=(0,l.useState)([]),[d,u]=(0,l.useState)(!1),[p,m]=(0,l.useState)({title:"",frequency:"weekly",dayOfWeek:1,priority:"medium",column:"backlog",enabled:!0});(0,l.useEffect)(()=>{const e=localStorage.getItem(br);if(e)try{const n=JSON.parse(e);c(n[t]||[])}catch(Fr){console.error("Failed to load recurring tasks:",Fr)}},[t]);const h=(0,l.useCallback)(e=>{const n=localStorage.getItem(br);let a={};if(n)try{a=JSON.parse(n)}catch(Fr){a={}}a[t]=e,localStorage.setItem(br,JSON.stringify(a)),c(e),i()},[t,i]);return(0,l.useEffect)(()=>{s.length>0&&(()=>{const e=new Date,t=e.getDay(),n=e.toDateString();s.forEach(r=>{if(!r.enabled)return;let o=!1;if("daily"===r.frequency)o=r.lastCreated!==n;else if("weekly"===r.frequency||"biweekly"===r.frequency){if(r.dayOfWeek===t&&r.lastCreated!==n)if("weekly"===r.frequency)o=!0;else{const t=r.lastCreated?new Date(r.lastCreated):null;(!t||e-t>=11232e5)&&(o=!0)}}else"monthly"===r.frequency&&e.getDate()===r.dayOfMonth&&r.lastCreated!==n&&(o=!0);if(o){a(r.column,r.title,r.priority);const e=s.map(e=>e.id===r.id?Je(Je({},e),{},{lastCreated:n}):e);h(e)}})})()},[s,a]),r?(0,He.jsx)("div",{className:"modal-overlay",onClick:o,children:(0,He.jsxs)("div",{className:"recurring-modal-content",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"recurring-modal-header",children:[(0,He.jsx)("h2",{children:"Recurring Tasks"}),(0,He.jsx)("p",{className:"modal-subtitle",children:n}),(0,He.jsx)("button",{className:"modal-close",onClick:o,children:"\xd7"})]}),(0,He.jsxs)("div",{className:"recurring-modal-body",children:[d?(0,He.jsxs)("div",{className:"add-recurring-form",children:[(0,He.jsx)("h3",{children:"Create Recurring Task"}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Task Title"}),(0,He.jsx)("input",{type:"text",value:p.title,onChange:e=>m(Je(Je({},p),{},{title:e.target.value})),placeholder:"e.g., Weekly lab meeting"})]}),(0,He.jsxs)("div",{className:"form-row",children:[(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Frequency"}),(0,He.jsx)("select",{value:p.frequency,onChange:e=>m(Je(Je({},p),{},{frequency:e.target.value})),children:xr.map(e=>(0,He.jsx)("option",{value:e.id,children:e.label},e.id))})]}),("weekly"===p.frequency||"biweekly"===p.frequency)&&(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Day of Week"}),(0,He.jsx)("select",{value:p.dayOfWeek,onChange:e=>m(Je(Je({},p),{},{dayOfWeek:parseInt(e.target.value)})),children:kr.map(e=>(0,He.jsx)("option",{value:e.id,children:e.label},e.id))})]}),"monthly"===p.frequency&&(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Day of Month"}),(0,He.jsx)("select",{value:p.dayOfMonth||1,onChange:e=>m(Je(Je({},p),{},{dayOfMonth:parseInt(e.target.value)})),children:Array.from({length:28},(e,t)=>(0,He.jsx)("option",{value:t+1,children:t+1},t+1))})]})]}),(0,He.jsxs)("div",{className:"form-row",children:[(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Priority"}),(0,He.jsxs)("select",{value:p.priority,onChange:e=>m(Je(Je({},p),{},{priority:e.target.value})),children:[(0,He.jsx)("option",{value:"high",children:"High"}),(0,He.jsx)("option",{value:"medium",children:"Medium"}),(0,He.jsx)("option",{value:"low",children:"Low"})]})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Add to Column"}),(0,He.jsxs)("select",{value:p.column,onChange:e=>m(Je(Je({},p),{},{column:e.target.value})),children:[(0,He.jsx)("option",{value:"backlog",children:"Backlog"}),(0,He.jsx)("option",{value:"inProgress",children:"In Progress"}),(0,He.jsx)("option",{value:"review",children:"Review"})]})]})]}),(0,He.jsxs)("div",{className:"form-actions",children:[(0,He.jsx)("button",{className:"btn-cancel",onClick:()=>u(!1),children:"Cancel"}),(0,He.jsx)("button",{className:"btn-submit",onClick:()=>{if(!p.title.trim())return;const e=Je(Je({id:"recurring-".concat(Date.now())},p),{},{lastCreated:null,createdAt:(new Date).toISOString()});h([...s,e]),m({title:"",frequency:"weekly",dayOfWeek:1,priority:"medium",column:"backlog",enabled:!0}),u(!1)},children:"Create Recurring Task"})]})]}):(0,He.jsx)("button",{className:"add-recurring-btn",onClick:()=>u(!0),children:"+ Add Recurring Task"}),(0,He.jsx)("div",{className:"recurring-tasks-list",children:0===s.length?(0,He.jsxs)("div",{className:"empty-recurring",children:[(0,He.jsx)("p",{children:"No recurring tasks set up yet."}),(0,He.jsx)("p",{className:"hint",children:"Create recurring tasks for regular activities like lab meetings, data backups, or weekly reviews."})]}):s.map(e=>{var t;return(0,He.jsx)("div",{className:"recurring-task-item ".concat(e.enabled?"":"disabled"),children:(0,He.jsxs)("div",{className:"recurring-task-main",children:[(0,He.jsxs)("div",{className:"recurring-task-info",children:[(0,He.jsx)("h4",{children:e.title}),(0,He.jsxs)("div",{className:"recurring-meta",children:[(0,He.jsx)("span",{className:"frequency-badge",children:e.frequency}),("weekly"===e.frequency||"biweekly"===e.frequency)&&(0,He.jsx)("span",{className:"day-badge",children:null===(t=kr.find(t=>t.id===e.dayOfWeek))||void 0===t?void 0:t.label}),(0,He.jsx)("span",{className:"priority-badge ".concat(e.priority),children:e.priority})]}),e.lastCreated&&(0,He.jsxs)("p",{className:"last-created",children:["Last created: ",e.lastCreated]})]}),(0,He.jsxs)("div",{className:"recurring-task-actions",children:[(0,He.jsx)("button",{className:"trigger-btn",onClick:()=>(e=>{a(e.column,e.title,e.priority);const t=s.map(t=>t.id===e.id?Je(Je({},t),{},{lastCreated:(new Date).toDateString()}):t);h(t)})(e),title:"Create task now",children:"\u25b6"}),(0,He.jsx)("button",{className:"toggle-btn ".concat(e.enabled?"enabled":""),onClick:()=>(e=>{const t=s.map(t=>t.id===e?Je(Je({},t),{},{enabled:!t.enabled}):t);h(t)})(e.id),title:e.enabled?"Disable":"Enable",children:e.enabled?"\u2713":"\u25cb"}),(0,He.jsx)("button",{className:"delete-btn",onClick:()=>(e=>{const t=s.filter(t=>t.id!==e);h(t)})(e.id),title:"Delete",children:"\xd7"})]})]})},e.id)})})]})]})}):null},wr="research-dashboard-task-templates",Sr=[{id:"new-experiment",name:"New Experiment",description:"Standard workflow for starting a new experiment",icon:"\ud83e\uddea",tasks:[{title:"Define hypothesis and objectives",column:"backlog",priority:"high"},{title:"Literature review",column:"backlog",priority:"high"},{title:"Design experimental protocol",column:"backlog",priority:"high"},{title:"Prepare materials and reagents",column:"backlog",priority:"medium"},{title:"Set up controls",column:"backlog",priority:"medium"},{title:"Run pilot experiment",column:"backlog",priority:"medium"},{title:"Collect data",column:"backlog",priority:"medium"},{title:"Analyze results",column:"backlog",priority:"medium"},{title:"Document findings",column:"backlog",priority:"low"}]},{id:"paper-submission",name:"Paper Submission",description:"Checklist for submitting a research paper",icon:"\ud83d\udcdd",tasks:[{title:"Complete first draft",column:"backlog",priority:"high"},{title:"Internal review with co-authors",column:"backlog",priority:"high"},{title:"Address co-author feedback",column:"backlog",priority:"high"},{title:"Format figures and tables",column:"backlog",priority:"medium"},{title:"Write abstract and keywords",column:"backlog",priority:"medium"},{title:"Prepare supplementary materials",column:"backlog",priority:"medium"},{title:"Select target journal",column:"backlog",priority:"medium"},{title:"Format according to journal guidelines",column:"backlog",priority:"medium"},{title:"Write cover letter",column:"backlog",priority:"low"},{title:"Submit manuscript",column:"backlog",priority:"high"},{title:"Address reviewer comments",column:"backlog",priority:"high"}]},{id:"grant-application",name:"Grant Application",description:"Tasks for preparing a grant proposal",icon:"\ud83d\udcb0",tasks:[{title:"Identify funding opportunity",column:"backlog",priority:"high"},{title:"Review grant requirements",column:"backlog",priority:"high"},{title:"Draft specific aims",column:"backlog",priority:"high"},{title:"Write research strategy",column:"backlog",priority:"high"},{title:"Prepare budget",column:"backlog",priority:"medium"},{title:"Gather supporting documents",column:"backlog",priority:"medium"},{title:"Get letters of support",column:"backlog",priority:"medium"},{title:"Internal review",column:"backlog",priority:"medium"},{title:"Final revisions",column:"backlog",priority:"high"},{title:"Submit application",column:"backlog",priority:"high"}]},{id:"data-analysis",name:"Data Analysis Pipeline",description:"Standard data analysis workflow",icon:"\ud83d\udcca",tasks:[{title:"Data collection and organization",column:"backlog",priority:"high"},{title:"Data cleaning and preprocessing",column:"backlog",priority:"high"},{title:"Exploratory data analysis",column:"backlog",priority:"medium"},{title:"Statistical analysis",column:"backlog",priority:"high"},{title:"Create visualizations",column:"backlog",priority:"medium"},{title:"Interpret results",column:"backlog",priority:"high"},{title:"Document methodology",column:"backlog",priority:"medium"},{title:"Peer review of analysis",column:"backlog",priority:"low"}]},{id:"literature-review",name:"Literature Review",description:"Systematic literature review process",icon:"\ud83d\udcda",tasks:[{title:"Define research question",column:"backlog",priority:"high"},{title:"Identify databases and keywords",column:"backlog",priority:"high"},{title:"Conduct systematic search",column:"backlog",priority:"high"},{title:"Screen titles and abstracts",column:"backlog",priority:"medium"},{title:"Full-text review",column:"backlog",priority:"medium"},{title:"Extract key findings",column:"backlog",priority:"medium"},{title:"Synthesize findings",column:"backlog",priority:"high"},{title:"Write review summary",column:"backlog",priority:"medium"}]},{id:"weekly-review",name:"Weekly Review",description:"Weekly research progress review",icon:"\ud83d\udcc5",tasks:[{title:"Review completed tasks",column:"backlog",priority:"medium"},{title:"Update project status",column:"backlog",priority:"medium"},{title:"Plan next week priorities",column:"backlog",priority:"high"},{title:"Update lab notebook",column:"backlog",priority:"medium"},{title:"Prepare for lab meeting",column:"backlog",priority:"medium"}]}];const Nr=function(e){let{projectId:t,onApplyTemplate:n,isOpen:a,onClose:r}=e;const o=St(),[i,s]=(0,l.useState)([]),[c,d]=(0,l.useState)([]),[u,p]=(0,l.useState)(!1),[m,h]=(0,l.useState)(null),[g,f]=(0,l.useState)({name:"",description:"",icon:"\ud83d\udccb",tasks:[]}),[v,y]=(0,l.useState)("");(0,l.useEffect)(()=>{s(Sr);const e=localStorage.getItem(wr);if(e)try{d(JSON.parse(e))}catch(Fr){console.error("Failed to load custom templates:",Fr)}},[]);const b=(0,l.useCallback)(e=>{localStorage.setItem(wr,JSON.stringify(e)),d(e),o()},[o]),x=()=>{v.trim()&&(f(Je(Je({},g),{},{tasks:[...g.tasks,{title:v.trim(),column:"backlog",priority:"medium"}]})),y(""))};if(!a)return null;const k=[...i,...c];return(0,He.jsx)("div",{className:"modal-overlay",onClick:r,children:(0,He.jsxs)("div",{className:"templates-modal-content",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"templates-modal-header",children:[(0,He.jsx)("h2",{children:"Task Templates"}),(0,He.jsx)("p",{className:"modal-subtitle",children:"Quick-start your project with pre-built task sets"}),(0,He.jsx)("button",{className:"modal-close",onClick:r,children:"\xd7"})]}),(0,He.jsxs)("div",{className:"templates-modal-body",children:[u?(0,He.jsxs)("div",{className:"create-template-form",children:[(0,He.jsx)("h3",{children:"Create Custom Template"}),(0,He.jsx)("div",{className:"form-row",children:(0,He.jsxs)("div",{className:"form-group icon-selector",children:[(0,He.jsx)("label",{children:"Icon"}),(0,He.jsx)("div",{className:"icon-options",children:["\ud83d\udccb","\ud83e\uddea","\ud83d\udcdd","\ud83d\udcb0","\ud83d\udcca","\ud83d\udcda","\ud83d\udd2c","\ud83e\uddec","\ud83d\udc8a","\ud83e\udda0","\ud83e\uddeb","\ud83d\udcc5","\ud83c\udfaf","\u26a1"].map(e=>(0,He.jsx)("button",{className:"icon-option ".concat(g.icon===e?"selected":""),onClick:()=>f(Je(Je({},g),{},{icon:e})),children:e},e))})]})}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Template Name"}),(0,He.jsx)("input",{type:"text",value:g.name,onChange:e=>f(Je(Je({},g),{},{name:e.target.value})),placeholder:"e.g., Cell Culture Protocol"})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsx)("label",{children:"Description"}),(0,He.jsx)("input",{type:"text",value:g.description,onChange:e=>f(Je(Je({},g),{},{description:e.target.value})),placeholder:"Brief description of the template"})]}),(0,He.jsxs)("div",{className:"form-group",children:[(0,He.jsxs)("label",{children:["Tasks (",g.tasks.length,")"]}),(0,He.jsx)("div",{className:"template-tasks-list",children:g.tasks.map((e,t)=>(0,He.jsxs)("div",{className:"template-task-item",children:[(0,He.jsx)("span",{children:e.title}),(0,He.jsx)("button",{onClick:()=>(e=>{f(Je(Je({},g),{},{tasks:g.tasks.filter((t,n)=>n!==e)}))})(t),children:"\xd7"})]},t))}),(0,He.jsxs)("div",{className:"add-template-task",children:[(0,He.jsx)("input",{type:"text",value:v,onChange:e=>y(e.target.value),placeholder:"Add task to template...",onKeyPress:e=>"Enter"===e.key&&x()}),(0,He.jsx)("button",{onClick:x,children:"Add"})]})]}),(0,He.jsxs)("div",{className:"form-actions",children:[(0,He.jsx)("button",{className:"btn-cancel",onClick:()=>p(!1),children:"Cancel"}),(0,He.jsx)("button",{className:"btn-submit",onClick:()=>{if(!g.name.trim()||0===g.tasks.length)return;const e=Je(Je({id:"custom-".concat(Date.now())},g),{},{isCustom:!0});b([...c,e]),f({name:"",description:"",icon:"\ud83d\udccb",tasks:[]}),p(!1)},disabled:!g.name.trim()||0===g.tasks.length,children:"Save Template"})]})]}):(0,He.jsx)("button",{className:"create-template-btn",onClick:()=>p(!0),children:"+ Create Custom Template"}),(0,He.jsx)("div",{className:"templates-grid",children:k.map(e=>(0,He.jsxs)("div",{className:"template-card ".concat((null===m||void 0===m?void 0:m.id)===e.id?"selected":""),onClick:()=>h((null===m||void 0===m?void 0:m.id)===e.id?null:e),children:[(0,He.jsxs)("div",{className:"template-card-header",children:[(0,He.jsx)("span",{className:"template-icon",children:e.icon}),e.isCustom&&(0,He.jsx)("button",{className:"delete-template-btn",onClick:t=>{t.stopPropagation(),(e=>{if(window.confirm("Delete this custom template?")){const t=c.filter(t=>t.id!==e);b(t)}})(e.id)},children:"\xd7"})]}),(0,He.jsx)("h4",{children:e.name}),(0,He.jsx)("p",{className:"template-description",children:e.description}),(0,He.jsxs)("span",{className:"template-task-count",children:[e.tasks.length," tasks"]}),(null===m||void 0===m?void 0:m.id)===e.id&&(0,He.jsxs)("div",{className:"template-preview",children:[(0,He.jsx)("h5",{children:"Tasks:"}),(0,He.jsxs)("ul",{children:[e.tasks.slice(0,5).map((e,t)=>(0,He.jsx)("li",{children:e.title},t)),e.tasks.length>5&&(0,He.jsxs)("li",{className:"more-tasks",children:["+",e.tasks.length-5," more..."]})]}),(0,He.jsx)("button",{className:"apply-template-btn",onClick:t=>{t.stopPropagation(),(e=>{window.confirm('Apply "'.concat(e.name,'" template? This will create ').concat(e.tasks.length," tasks."))&&(e.tasks.forEach(e=>{n(e.column,e.title,e.priority)}),r())})(e)},children:"Apply Template"})]})]},e.id))})]})]})})},Cr="research-dashboard-custom-projects",Er="research-dashboard-tasks",Ir="research-dashboard-project-overrides";const Dr=function(){var e,t;const{projectId:n}=function(){let{matches:e}=l.useContext(ae),t=e[e.length-1];return t?t.params:{}}(),{logActivity:a,isProjectArchived:r}=et(),o=St(),{moveToTrash:i}=Fn(),{showSuccess:s}=vt(),[c,d]=(0,l.useState)(null),[u,p]=(0,l.useState)({}),[m,h]=(0,l.useState)(!1),[g,f]=(0,l.useState)(!1),[v,y]=(0,l.useState)("kanban"),[b,x]=(0,l.useState)(!1),[k,j]=(0,l.useState)(!1),[w,S]=(0,l.useState)(!1),[N,C]=(0,l.useState)(null),[E,I]=(0,l.useState)(0),[D,T]=(0,l.useState)(0);if((0,l.useEffect)(()=>{let e=(t=n,Cn.find(e=>e.id===t));var t;if(e){const t=localStorage.getItem(Ir);if(t)try{const a=JSON.parse(t);a[n]&&(e=Je(Je({},e),a[n]))}catch(Fr){console.error("Failed to load project overrides:",Fr)}d(e),h(!1);const a=localStorage.getItem(Er);if(a)try{const t=JSON.parse(a);t[n]?p(t[n]):p(e.tasks)}catch(Fr){p(e.tasks)}else p(e.tasks);f(!0)}else{const t=localStorage.getItem(Cr);if(t)try{e=JSON.parse(t).find(e=>e.id===n),e&&(d(e),p(e.tasks),h(!0),f(!0))}catch(Fr){console.error("Failed to load custom projects:",Fr)}}},[n]),(0,l.useEffect)(()=>{if(g&&c)if(m){const e=localStorage.getItem(Cr);if(e)try{const t=JSON.parse(e).map(e=>e.id===n?Je(Je({},e),{},{tasks:u}):e);localStorage.setItem(Cr,JSON.stringify(t)),o()}catch(Fr){console.error("Failed to save tasks:",Fr)}}else{const e=localStorage.getItem(Er);let t={};if(e)try{t=JSON.parse(e)}catch(Fr){t={}}t[n]=u,localStorage.setItem(Er,JSON.stringify(t)),o()}},[u,m,c,n,g,o]),(0,l.useEffect)(()=>{if(!c)return;const e=localStorage.getItem("research-dashboard-lab-notebook");if(e)try{const t=JSON.parse(e),a=c.title.toLowerCase(),r=n.toLowerCase(),o=t.filter(e=>{var t;return e.projectId===n||(null===(t=e.tags)||void 0===t?void 0:t.some(e=>{const t=e.toLowerCase();return t===a||t===r||a.includes(t)||t.includes(a)}))});I(o.length)}catch(Fr){I(0)}const t=localStorage.getItem("research-dashboard-literature");if(t)try{const e=JSON.parse(t)[n]||[];T(e.length)}catch(Fr){T(0)}},[c,n,v]),!c)return(0,He.jsxs)("div",{className:"project-page not-found",children:[(0,He.jsx)("h1",{children:"Project Not Found"}),(0,He.jsx)(Le,{to:"/",children:"\u2190 Back to Dashboard"})]});if(r(n))return(0,He.jsxs)("div",{className:"project-page not-found",children:[(0,He.jsx)("h1",{children:"Project Archived"}),(0,He.jsx)("p",{children:"This project has been archived and is not visible."}),(0,He.jsx)(Le,{to:"/",children:"\u2190 Back to Dashboard"})]});const A=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"medium";const o={id:"".concat(c.id,"-").concat(Date.now()),title:t,priority:r,description:"",labels:[],checklist:[],links:[]};p(t=>Je(Je({},t),{},{[e]:[...t[e],o]})),a("task_created",{taskId:o.id,taskTitle:t,projectId:n,projectTitle:c.title,column:e})},P=Object.values(u).flat().length,O=(null===(e=u.done)||void 0===e?void 0:e.length)||0,L=P>0?Math.round(O/P*100):0;return(0,He.jsxs)("div",{className:"project-page",style:{"--project-color":c.color},children:[(0,He.jsxs)("header",{className:"project-header",children:[(0,He.jsxs)("div",{className:"header-nav",children:[(0,He.jsx)(Le,{to:"/",className:"back-link",children:"\u2190 Dashboard"}),!w&&(0,He.jsx)("button",{className:"edit-project-btn",onClick:()=>{var e;C({title:c.title,subtitle:c.subtitle||"",description:c.description||"",hypothesis:c.hypothesis||"",approaches:(null===(e=c.approaches)||void 0===e?void 0:e.join(", "))||"",color:c.color||"#6366f1",icon:c.icon||"custom"}),S(!0)},title:"Edit project details",children:"\u270f\ufe0f Edit"})]}),w&&N?(0,He.jsxs)("div",{className:"project-edit-form",children:[(0,He.jsxs)("div",{className:"edit-form-row",children:[(0,He.jsx)("label",{children:"Project Title"}),(0,He.jsx)("input",{type:"text",value:N.title,onChange:e=>C(Je(Je({},N),{},{title:e.target.value})),placeholder:"Project title"})]}),(0,He.jsxs)("div",{className:"edit-form-row",children:[(0,He.jsx)("label",{children:"Subtitle/Badge"}),(0,He.jsx)("input",{type:"text",value:N.subtitle,onChange:e=>C(Je(Je({},N),{},{subtitle:e.target.value})),placeholder:"e.g., CAR-T Therapy, Drug Discovery"})]}),(0,He.jsxs)("div",{className:"edit-form-row",children:[(0,He.jsx)("label",{children:"Description"}),(0,He.jsx)("textarea",{value:N.description,onChange:e=>C(Je(Je({},N),{},{description:e.target.value})),placeholder:"Brief project description",rows:2})]}),(0,He.jsxs)("div",{className:"edit-form-row",children:[(0,He.jsx)("label",{children:"Hypothesis"}),(0,He.jsx)("textarea",{value:N.hypothesis,onChange:e=>C(Je(Je({},N),{},{hypothesis:e.target.value})),placeholder:"Main hypothesis or research question",rows:2})]}),(0,He.jsxs)("div",{className:"edit-form-row",children:[(0,He.jsx)("label",{children:"Approaches (comma-separated)"}),(0,He.jsx)("input",{type:"text",value:N.approaches,onChange:e=>C(Je(Je({},N),{},{approaches:e.target.value})),placeholder:"e.g., In vivo, CRISPR, Flow Cytometry"})]}),(0,He.jsxs)("div",{className:"edit-form-row",children:[(0,He.jsx)("label",{children:"Color"}),(0,He.jsx)("input",{type:"color",value:N.color,onChange:e=>C(Je(Je({},N),{},{color:e.target.value}))})]}),(0,He.jsxs)("div",{className:"edit-form-row",children:[(0,He.jsx)("label",{children:"Icon"}),(0,He.jsx)("div",{className:"icon-selector",children:Ma.map(e=>(0,He.jsx)("button",{type:"button",className:"icon-option ".concat(N.icon===e.id?"selected":""),onClick:()=>C(Je(Je({},N),{},{icon:e.id})),title:e.name,style:{color:N.color},children:Ra[e.id]},e.id))})]}),(0,He.jsxs)("div",{className:"edit-form-actions",children:[(0,He.jsx)("button",{className:"btn-cancel",onClick:()=>{S(!1),C(null)},children:"Cancel"}),(0,He.jsx)("button",{className:"btn-save",onClick:()=>{if(!N.title.trim())return;const e=Je(Je({},c),{},{title:N.title.trim(),subtitle:N.subtitle.trim(),description:N.description.trim(),hypothesis:N.hypothesis.trim(),approaches:N.approaches.split(",").map(e=>e.trim()).filter(e=>e),color:N.color,icon:N.icon});if(m){const t=localStorage.getItem(Cr);if(t)try{const a=JSON.parse(t).map(t=>t.id===n?Je(Je({},t),e):t);localStorage.setItem(Cr,JSON.stringify(a)),o()}catch(Fr){console.error("Failed to save project:",Fr)}}else{const t=localStorage.getItem(Ir);let a={};if(t)try{a=JSON.parse(t)}catch(Fr){console.error("Failed to parse overrides:",Fr)}a[n]={title:e.title,subtitle:e.subtitle,description:e.description,hypothesis:e.hypothesis,approaches:e.approaches,color:e.color,icon:e.icon},localStorage.setItem(Ir,JSON.stringify(a)),o()}d(e),S(!1),C(null),s("Project updated successfully"),a("edit","project",e.title)},children:"Save Changes"})]})]}):(0,He.jsxs)(He.Fragment,{children:[(0,He.jsxs)("div",{className:"header-main",children:[(0,He.jsxs)("div",{className:"header-info",children:[(0,He.jsxs)("div",{className:"header-icon-row",children:[(0,He.jsx)("div",{className:"project-header-icon",style:{color:c.color},children:Ra[c.icon]||Ra.custom}),(0,He.jsx)("div",{className:"project-badge",style:{backgroundColor:c.color},children:c.subtitle||"Research Project"})]}),(0,He.jsx)("h1",{children:c.title}),(0,He.jsx)("p",{className:"project-hypothesis",children:c.hypothesis||c.description})]}),(0,He.jsxs)("div",{className:"header-stats",children:[(0,He.jsxs)("div",{className:"header-stat",children:[(0,He.jsxs)("span",{className:"stat-value",children:[O,"/",P]}),(0,He.jsx)("span",{className:"stat-label",children:"Tasks Complete"})]}),(0,He.jsxs)("div",{className:"header-stat",children:[(0,He.jsxs)("span",{className:"stat-value",children:[L,"%"]}),(0,He.jsx)("span",{className:"stat-label",children:"Progress"})]}),(0,He.jsxs)("div",{className:"header-stat",children:[(0,He.jsx)("span",{className:"stat-value",children:E}),(0,He.jsx)("span",{className:"stat-label",children:"Notebook Entries"})]}),(0,He.jsxs)("div",{className:"header-stat",children:[(0,He.jsx)("span",{className:"stat-value",children:D}),(0,He.jsx)("span",{className:"stat-label",children:"Citations"})]})]})]}),(0,He.jsx)("div",{className:"approaches-bar",children:null===(t=c.approaches)||void 0===t?void 0:t.map((e,t)=>(0,He.jsx)("span",{className:"approach-chip",children:e},t))})]})]}),(0,He.jsxs)("div",{className:"project-tabs",children:[(0,He.jsxs)("div",{className:"tabs-left",children:[(0,He.jsx)("button",{className:"project-tab ".concat("kanban"===v?"active":""),onClick:()=>y("kanban"),children:"\ud83d\udccb Kanban Board"}),(0,He.jsx)("button",{className:"project-tab ".concat("protocols"===v?"active":""),onClick:()=>y("protocols"),children:"\ud83e\uddea Protocols & Results"}),(0,He.jsx)("button",{className:"project-tab ".concat("notes"===v?"active":""),onClick:()=>y("notes"),children:"\ud83d\udcd6 Research Notes"}),(0,He.jsx)("button",{className:"project-tab ".concat("notebook"===v?"active":""),onClick:()=>y("notebook"),children:"\ud83d\udcd3 Lab Notebook"})]}),(0,He.jsxs)("div",{className:"tabs-right",children:[(0,He.jsx)("button",{className:"tab-action-btn",onClick:()=>x(!0),title:"Recurring Tasks",children:"\ud83d\udd04 Recurring"}),(0,He.jsx)("button",{className:"tab-action-btn",onClick:()=>j(!0),title:"Task Templates",children:"\ud83d\udcd1 Templates"})]})]}),(0,He.jsxs)("main",{className:"project-main",children:["kanban"===v&&(0,He.jsx)($a,{tasks:u,projectColor:c.color,onTaskMove:function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;p(i=>{const l=Je({},i),s=l[t].findIndex(t=>t.id===e);if(-1===s)return i;const[d]=l[t].splice(s,1);return l[r]=null!==o&&o>=0?[...l[r].slice(0,o),d,...l[r].slice(o)]:[...l[r],d],a("task_moved",{taskId:e,taskTitle:d.title,projectId:n,projectTitle:c.title,fromColumn:t,toColumn:r}),l})},onAddTask:A,onDeleteTask:(e,t)=>{var r;const o=null===(r=u[t])||void 0===r?void 0:r.find(t=>t.id===e);o&&(i(Rn.TASK,Je(Je({},o),{},{column:t}),{projectId:n,projectTitle:c.title,column:t}),p(n=>Je(Je({},n),{},{[t]:n[t].filter(t=>t.id!==e)})),a("task_deleted",{taskId:e,taskTitle:o.title,projectId:n,projectTitle:c.title,column:t}),s('"'.concat(o.title,'" moved to trash')))},onUpdateTask:(e,t,r)=>{var o,i;p(n=>Je(Je({},n),{},{[t]:n[t].map(t=>t.id===e?Je(Je({},t),r):t)})),a("task_updated",{taskId:e,taskTitle:r.title||(null===(o=u[t])||void 0===o||null===(i=o.find(t=>t.id===e))||void 0===i?void 0:i.title),projectId:n,projectTitle:c.title,column:t})},onReorderTask:(e,t,n,a)=>{p(e=>{const r=Je({},e),o=[...r[t]],[i]=o.splice(n,1);return o.splice(a,0,i),r[t]=o,r})}}),"protocols"===v&&(0,He.jsx)(er,{projectId:n,projectTitle:c.title}),"notes"===v&&(0,He.jsx)(fr,{projectId:n,projectTitle:c.title}),"notebook"===v&&(0,He.jsx)(yr,{projectId:n,projectTitle:c.title})]}),(0,He.jsx)(jr,{projectId:n,projectTitle:c.title,onCreateTask:A,isOpen:b,onClose:()=>x(!1)}),(0,He.jsx)(Nr,{projectId:n,onApplyTemplate:A,isOpen:k,onClose:()=>j(!1)})]})};const Tr=function(){const{showSignInPrompt:e,gisLoaded:t,signIn:n,dismissPrompt:a}=lt();return e?(0,He.jsx)("div",{className:"google-prompt-overlay",children:(0,He.jsxs)("div",{className:"google-prompt-modal",children:[(0,He.jsx)("div",{className:"google-prompt-header",children:(0,He.jsx)("h2",{children:"Connect to Google"})}),(0,He.jsxs)("div",{className:"google-prompt-body",children:[(0,He.jsx)("div",{className:"google-prompt-icon",children:(0,He.jsx)("span",{className:"google-g-icon",children:"G"})}),(0,He.jsx)("p",{className:"google-prompt-message",children:"Sign in with Google to enable:"}),(0,He.jsxs)("ul",{className:"google-features-list",children:[(0,He.jsx)("li",{children:"Create and sync Google Docs from your notes"}),(0,He.jsx)("li",{children:"Export tasks to Google Calendar"}),(0,He.jsx)("li",{children:"Import content from Google Docs"}),(0,He.jsx)("li",{children:"Two-way sync between dashboard and Google"})]}),(0,He.jsxs)("div",{className:"google-prompt-actions",children:[(0,He.jsxs)("button",{className:"google-signin-btn-large",onClick:n,disabled:!t,children:[(0,He.jsx)("span",{className:"google-btn-icon",children:"G"}),t?"Sign in with Google":"Loading..."]}),(0,He.jsx)("button",{className:"google-skip-btn",onClick:a,children:"Skip for now"})]}),(0,He.jsx)("p",{className:"google-prompt-note",children:"You can always sign in later using the button in the navigation bar."})]})]})}):null},Ar="research-dashboard-lab-notebook";const Pr=function(){const e=St(),[t,n]=(0,l.useState)(!1),[a,r]=(0,l.useState)({title:"",content:"",tags:[]}),[o,i]=(0,l.useState)(""),[s,c]=(0,l.useState)(!1),d=()=>{if(!a.title.trim()&&!a.content.trim())return;const t={id:"entry-".concat(Date.now()),title:a.title.trim()||"Quick Note",content:a.content,projectId:null,tags:[...a.tags,"inbox"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),googleDocId:null,googleDocUrl:null,googleSheetId:null,googleSheetUrl:null,isQuickCapture:!0};try{const a=localStorage.getItem(Ar),o=a?JSON.parse(a):[];o.unshift(t),localStorage.setItem(Ar,JSON.stringify(o)),e(),c(!0),setTimeout(()=>c(!1),2e3),r({title:"",content:"",tags:[]}),n(!1)}catch(Fr){console.error("Failed to save quick capture:",Fr)}};return(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("button",{className:"quick-capture-fab ".concat(t?"active":""),onClick:()=>n(!t),title:"Quick Capture (Ctrl+Shift+N)",children:t?"\xd7":"+"}),s&&(0,He.jsx)("div",{className:"quick-capture-toast",children:"Captured! View in Lab Notebook"}),t&&(0,He.jsx)("div",{className:"quick-capture-overlay",onClick:()=>n(!1),children:(0,He.jsxs)("div",{className:"quick-capture-modal",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"quick-capture-header",children:[(0,He.jsx)("h3",{children:"Quick Capture"}),(0,He.jsx)("span",{className:"quick-capture-hint",children:"Ctrl+Enter to save"})]}),(0,He.jsxs)("div",{className:"quick-capture-body",children:[(0,He.jsx)("input",{type:"text",className:"quick-capture-title",placeholder:"Title (optional)",value:a.title,onChange:e=>r(Je(Je({},a),{},{title:e.target.value})),onKeyDown:e=>{"Enter"===e.key&&e.ctrlKey&&d()},autoFocus:!0}),(0,He.jsx)(ua,{className:"quick-capture-content",placeholder:"Capture your idea... (type @ for commands)",value:a.content,onChange:e=>r(Je(Je({},a),{},{content:e})),rows:4}),(0,He.jsxs)("div",{className:"quick-capture-tags",children:[a.tags.map(e=>(0,He.jsxs)("span",{className:"quick-tag",children:[e,(0,He.jsx)("button",{onClick:()=>{return t=e,void r(Je(Je({},a),{},{tags:a.tags.filter(e=>e!==t)}));var t},children:"\xd7"})]},e)),(0,He.jsx)("div",{className:"quick-tag-input",children:(0,He.jsx)("input",{type:"text",placeholder:"Add tag...",value:o,onChange:e=>i(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),o.trim()&&!a.tags.includes(o.trim())&&(r(Je(Je({},a),{},{tags:[...a.tags,o.trim()]})),i("")))}})})]}),(0,He.jsx)("p",{className:"quick-capture-note",children:"Saved to Lab Notebook inbox. Assign to a project later."})]}),(0,He.jsxs)("div",{className:"quick-capture-footer",children:[(0,He.jsx)("button",{className:"btn-cancel",onClick:()=>{n(!1),r({title:"",content:"",tags:[]})},children:"Cancel"}),(0,He.jsx)("button",{className:"btn-submit",onClick:d,disabled:!a.title.trim()&&!a.content.trim(),children:"Capture"})]})]})})]})};const Or=function(){const{claudeApiKey:e,openaiApiKey:t,geminiApiKey:n,setClaudeApiKey:a,setOpenaiApiKey:r,setGeminiApiKey:o,isSettingsOpen:i,closeSettings:s,validateClaudeKey:c,validateOpenaiKey:d,validateGeminiKey:u,summarizationProvider:p,embeddingsProvider:m,setSummarizationProvider:h,setEmbeddingsProvider:g,hasKeyForProvider:f}=Jt(),[v,y]=(0,l.useState)(""),[b,x]=(0,l.useState)(""),[k,j]=(0,l.useState)(""),[w,S]=(0,l.useState)(!1),[N,C]=(0,l.useState)(!1),[E,I]=(0,l.useState)(!1),[D,T]=(0,l.useState)(""),[A,P]=(0,l.useState)(""),[O,L]=(0,l.useState)(""),[R,M]=(0,l.useState)("");if((0,l.useEffect)(()=>{i&&(y(e||""),x(t||""),j(n||""),T(""),P(""),L(""),M(""))},[i,e,t,n]),(0,l.useEffect)(()=>{const e=e=>{"Escape"===e.key&&i&&s()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[i,s]),!i)return null;const F=e=>{"claude"===e?(y(""),a(""),T("")):"openai"===e?(x(""),r(""),P("")):"gemini"===e&&(j(""),o(""),L(""))},U=e=>e===Wt.CLAUDE?Boolean(v):e===Wt.OPENAI?Boolean(b):e===Wt.GEMINI&&Boolean(k);return(0,He.jsx)("div",{className:"api-settings-overlay",onClick:s,children:(0,He.jsxs)("div",{className:"api-settings-modal",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"api-settings-header",children:[(0,He.jsx)("h2",{children:"AI Settings"}),(0,He.jsx)("button",{className:"close-btn",onClick:s,children:"\xd7"})]}),(0,He.jsxs)("div",{className:"api-settings-content",children:[(0,He.jsx)("p",{className:"api-settings-intro",children:"Configure API keys and select preferred AI providers for different features."}),(0,He.jsxs)("div",{className:"settings-section",children:[(0,He.jsx)("h3",{children:"API Keys"}),(0,He.jsx)("p",{className:"section-description",children:"Enter API keys for the AI services you want to use. Keys are stored locally in your browser."}),(0,He.jsxs)("div",{className:"api-key-section",children:[(0,He.jsxs)("label",{htmlFor:"claude-key",children:[(0,He.jsx)("span",{className:"key-label",children:"Claude API Key"}),(0,He.jsx)("span",{className:"key-description",children:"Anthropic - Summarization only"})]}),(0,He.jsxs)("div",{className:"key-input-group",children:[(0,He.jsx)("input",{id:"claude-key",type:w?"text":"password",value:v,onChange:e=>{y(e.target.value),T("")},placeholder:"sk-ant-...",className:D?"error":""}),(0,He.jsx)("button",{type:"button",className:"toggle-visibility-btn",onClick:()=>S(!w),title:w?"Hide key":"Show key",children:w?"\ud83d\ude48":"\ud83d\udc41\ufe0f"}),v&&(0,He.jsx)("button",{type:"button",className:"clear-key-btn",onClick:()=>F("claude"),title:"Clear key",children:"\xd7"})]}),D&&(0,He.jsx)("span",{className:"key-error",children:D}),(0,He.jsx)("a",{href:"https://console.anthropic.com/settings/keys",target:"_blank",rel:"noopener noreferrer",className:"get-key-link",children:"Get a Claude API key"})]}),(0,He.jsxs)("div",{className:"api-key-section",children:[(0,He.jsxs)("label",{htmlFor:"openai-key",children:[(0,He.jsx)("span",{className:"key-label",children:"OpenAI API Key"}),(0,He.jsx)("span",{className:"key-description",children:"ChatGPT - Summarization & Embeddings"})]}),(0,He.jsxs)("div",{className:"key-input-group",children:[(0,He.jsx)("input",{id:"openai-key",type:N?"text":"password",value:b,onChange:e=>{x(e.target.value),P("")},placeholder:"sk-...",className:A?"error":""}),(0,He.jsx)("button",{type:"button",className:"toggle-visibility-btn",onClick:()=>C(!N),title:N?"Hide key":"Show key",children:N?"\ud83d\ude48":"\ud83d\udc41\ufe0f"}),b&&(0,He.jsx)("button",{type:"button",className:"clear-key-btn",onClick:()=>F("openai"),title:"Clear key",children:"\xd7"})]}),A&&(0,He.jsx)("span",{className:"key-error",children:A}),(0,He.jsx)("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"get-key-link",children:"Get an OpenAI API key"})]}),(0,He.jsxs)("div",{className:"api-key-section",children:[(0,He.jsxs)("label",{htmlFor:"gemini-key",children:[(0,He.jsx)("span",{className:"key-label",children:"Gemini API Key"}),(0,He.jsx)("span",{className:"key-description",children:"Google - Summarization & Embeddings"})]}),(0,He.jsxs)("div",{className:"key-input-group",children:[(0,He.jsx)("input",{id:"gemini-key",type:E?"text":"password",value:k,onChange:e=>{j(e.target.value),L("")},placeholder:"AI...",className:O?"error":""}),(0,He.jsx)("button",{type:"button",className:"toggle-visibility-btn",onClick:()=>I(!E),title:E?"Hide key":"Show key",children:E?"\ud83d\ude48":"\ud83d\udc41\ufe0f"}),k&&(0,He.jsx)("button",{type:"button",className:"clear-key-btn",onClick:()=>F("gemini"),title:"Clear key",children:"\xd7"})]}),O&&(0,He.jsx)("span",{className:"key-error",children:O}),(0,He.jsx)("a",{href:"https://aistudio.google.com/apikey",target:"_blank",rel:"noopener noreferrer",className:"get-key-link",children:"Get a Gemini API key"})]})]}),(0,He.jsxs)("div",{className:"settings-section",children:[(0,He.jsx)("h3",{children:"Default AI Providers"}),(0,He.jsx)("p",{className:"section-description",children:"Choose which AI provider to use for each feature. You can also change providers per-action."}),(0,He.jsxs)("div",{className:"provider-section",children:[(0,He.jsxs)("label",{htmlFor:"summarization-provider",children:[(0,He.jsx)("span",{className:"provider-label",children:"Paper Summarization"}),(0,He.jsx)("span",{className:"provider-description",children:"AI used to summarize research papers in Literature Manager"})]}),(0,He.jsx)("select",{id:"summarization-provider",value:p,onChange:e=>h(e.target.value),className:"provider-select",children:Object.values(Wt).filter(e=>{var t;return null===(t=qt[e])||void 0===t?void 0:t.summarization}).map(e=>(0,He.jsxs)("option",{value:e,disabled:!U(e),children:[Vt[e]," ",U(e)?"":"(No API key)"]},e))})]}),(0,He.jsxs)("div",{className:"provider-section",children:[(0,He.jsxs)("label",{htmlFor:"embeddings-provider",children:[(0,He.jsx)("span",{className:"provider-label",children:"Semantic Search"}),(0,He.jsx)("span",{className:"provider-description",children:"AI used for semantic search embeddings"})]}),(0,He.jsx)("select",{id:"embeddings-provider",value:m,onChange:e=>g(e.target.value),className:"provider-select",children:Object.values(Wt).filter(e=>{var t;return null===(t=qt[e])||void 0===t?void 0:t.embeddings}).map(e=>(0,He.jsxs)("option",{value:e,disabled:!U(e),children:[Vt[e]," ",U(e)?"":"(No API key)"]},e))}),(0,He.jsx)("span",{className:"provider-note",children:"Note: Claude does not support embeddings. Use OpenAI or Gemini for semantic search."})]})]}),R&&(0,He.jsx)("div",{className:"save-status success",children:R}),(0,He.jsxs)("div",{className:"api-settings-note",children:[(0,He.jsx)("strong",{children:"Security Note:"})," API keys are stored in your browser's local storage. They are never sent to our servers, only to their respective API providers."]})]}),(0,He.jsxs)("div",{className:"api-settings-footer",children:[(0,He.jsx)("button",{className:"cancel-btn",onClick:s,children:"Cancel"}),(0,He.jsx)("button",{className:"save-btn",onClick:()=>{let e=!1;if(v){const t=c(v);t.valid?T(""):(T(t.message),e=!0)}else T("");if(b){const t=d(b);t.valid?P(""):(P(t.message),e=!0)}else P("");if(k){const t=u(k);t.valid?L(""):(L(t.message),e=!0)}else L("");e||(a(v),r(b),o(k),M("Settings saved successfully!"),setTimeout(()=>{M(""),s()},1500))},children:"Save Settings"})]})]})})},Lr={[Rn.PROJECT]:{label:"Project",icon:"\ud83d\udcc1"},[Rn.TASK]:{label:"Task",icon:"\u2713"},[Rn.REFERENCE]:{label:"Reference",icon:"\ud83d\udcda"},[Rn.NOTEBOOK_ENTRY]:{label:"Notebook Entry",icon:"\ud83d\udcd3"},[Rn.PROTOCOL]:{label:"Protocol",icon:"\ud83d\udccb"},[Rn.RESULT]:{label:"Result",icon:"\ud83d\udcca"},[Rn.NOTE]:{label:"Note",icon:"\ud83d\udcdd"}};const Rr=function(e){let{onRestore:t}=e;const{trashedItems:n,isTrashOpen:a,closeTrash:r,restoreFromTrash:o,permanentlyDelete:i,emptyTrash:s,getDaysUntilExpiry:c}=Fn(),{showSuccess:d,showWarning:u}=vt(),[p,m]=(0,l.useState)("all"),[h,g]=(0,l.useState)("");if((0,l.useEffect)(()=>{const e=e=>{"Escape"===e.key&&a&&r()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a,r]),!a)return null;const f=n.filter(e=>{var t,n;const a="all"===p||e.type===p,r=!h||(null===(t=e.data.title)||void 0===t?void 0:t.toLowerCase().includes(h.toLowerCase()))||(null===(n=e.data.name)||void 0===n?void 0:n.toLowerCase().includes(h.toLowerCase()));return a&&r}),v=[...new Set(n.map(e=>e.type))];return(0,He.jsx)("div",{className:"trash-modal-overlay",onClick:r,children:(0,He.jsxs)("div",{className:"trash-modal",onClick:e=>e.stopPropagation(),children:[(0,He.jsxs)("div",{className:"trash-modal-header",children:[(0,He.jsx)("h2",{children:"Trash"}),(0,He.jsxs)("div",{className:"trash-header-actions",children:[n.length>0&&(0,He.jsx)("button",{className:"empty-trash-btn",onClick:()=>{window.confirm("Permanently delete all ".concat(n.length," items in trash? This cannot be undone."))&&(s(),u("Trash emptied"))},children:"Empty Trash"}),(0,He.jsx)("button",{className:"close-btn",onClick:r,children:"\xd7"})]})]}),(0,He.jsxs)("div",{className:"trash-modal-toolbar",children:[(0,He.jsx)("input",{type:"text",className:"trash-search",placeholder:"Search trash...",value:h,onChange:e=>g(e.target.value)}),(0,He.jsxs)("select",{className:"trash-filter",value:p,onChange:e=>m(e.target.value),children:[(0,He.jsx)("option",{value:"all",children:"All Types"}),v.map(e=>{var t;return(0,He.jsx)("option",{value:e,children:(null===(t=Lr[e])||void 0===t?void 0:t.label)||e},e)})]})]}),(0,He.jsx)("div",{className:"trash-modal-content",children:0===f.length?(0,He.jsx)("div",{className:"trash-empty",children:0===n.length?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("div",{className:"trash-empty-icon",children:"\ud83d\uddd1\ufe0f"}),(0,He.jsx)("p",{children:"Trash is empty"}),(0,He.jsxs)("p",{className:"trash-empty-hint",children:["Deleted items will appear here for ",30," days before being permanently removed."]})]}):(0,He.jsx)("p",{children:"No items match your search"})}):(0,He.jsx)("div",{className:"trash-items-list",children:f.map(e=>{const n=Lr[e.type]||{label:"Item",icon:"\ud83d\udcc4"},a=c(e.deletedAt);return(0,He.jsxs)("div",{className:"trash-item",children:[(0,He.jsx)("div",{className:"trash-item-icon",children:n.icon}),(0,He.jsxs)("div",{className:"trash-item-info",children:[(0,He.jsx)("span",{className:"trash-item-title",children:e.data.title||e.data.name||"Untitled"}),(0,He.jsxs)("span",{className:"trash-item-meta",children:[n.label,e.metadata.originalLocation&&"unknown"!==e.metadata.originalLocation&&(0,He.jsxs)(He.Fragment,{children:[" \u2022 from ",e.metadata.projectTitle||e.metadata.originalLocation]}),(0,He.jsxs)(He.Fragment,{children:[" \u2022 ",a," day",1!==a?"s":""," until deleted"]})]})]}),(0,He.jsxs)("div",{className:"trash-item-actions",children:[(0,He.jsx)("button",{className:"restore-btn",onClick:()=>(e=>{const n=o(e);n&&t&&(t(n),d("Restored: ".concat(n.data.title||n.data.name||"Item")))})(e.id),title:"Restore item",children:"Restore"}),(0,He.jsx)("button",{className:"delete-forever-btn",onClick:()=>{return t=e.id,void(window.confirm("Permanently delete this item? This cannot be undone.")&&(i(t),u("Item permanently deleted")));var t},title:"Delete permanently",children:"Delete"})]})]},e.id)})})}),(0,He.jsx)("div",{className:"trash-modal-footer",children:(0,He.jsxs)("span",{className:"trash-count",children:[f.length," item",1!==f.length?"s":"","all"!==p&&" (filtered from ".concat(n.length," total)")]})})]})})};const Mr=function(){return(0,l.useEffect)(()=>{(()=>{const e="kanlab-demo-initialized";if(localStorage.getItem(e))return;const t="research-dashboard-literature";localStorage.getItem(t)||localStorage.setItem(t,JSON.stringify(Ue));const n="research-dashboard-lab-notebook";localStorage.getItem(n)||localStorage.setItem(n,JSON.stringify(Ge));const a="research-dashboard-protocols";localStorage.getItem(a)||localStorage.setItem(a,JSON.stringify(_e));const r="research-dashboard-results";localStorage.getItem(r)||localStorage.setItem(r,JSON.stringify(ze));const o="research-dashboard-research-notes";localStorage.getItem(o)||localStorage.setItem(o,JSON.stringify(Be)),localStorage.setItem(e,"true")})()},[]),(0,He.jsx)(_n,{children:(0,He.jsx)(ht,{children:(0,He.jsx)(it,{children:(0,He.jsx)(wt,{children:(0,He.jsx)(Rt,{children:(0,He.jsx)(Ze,{children:(0,He.jsx)(Kt,{children:(0,He.jsx)(Pn,{children:(0,He.jsx)(_t,{children:(0,He.jsx)(Mn,{children:(0,He.jsx)(Ae,{children:(0,He.jsxs)("div",{className:"App",children:[(0,He.jsx)(Aa,{}),(0,He.jsxs)(Ne,{children:[(0,He.jsx)(we,{path:"/",element:(0,He.jsx)(za,{})}),(0,He.jsx)(we,{path:"/project/:projectId",element:(0,He.jsx)(Dr,{})})]}),(0,He.jsx)(Tr,{}),(0,He.jsx)(Pr,{}),(0,He.jsx)(Or,{}),(0,He.jsx)(Rr,{})]})})})})})})})})})})})})};c.createRoot(document.getElementById("root")).render((0,He.jsx)(l.StrictMode,{children:(0,He.jsx)(Mr,{})}))})();
//# sourceMappingURL=main.7c31990c.js.map